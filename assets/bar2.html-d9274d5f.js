import{_ as s,o as a,c as t,a as p}from"./app-a2b6e588.js";const o="/steven-blogs/assets/bar2_1-a470da42.png",n="data:image/png;base64,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",e="/steven-blogs/assets/bar2_3-f8ec10b2.png",c="data:image/png;base64,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",l={},u=p(`<h1 id="c-下实现动态系统托盘图标" tabindex="-1"><a class="header-anchor" href="#c-下实现动态系统托盘图标" aria-hidden="true">#</a> C#下实现动态系统托盘图标</h1><p>Visual C#是微软公司推出的下一代程序开发语言，是微软.Net框架中的的一个重要组成部分。微软的.Net平台堪称为新一代的互联网平台。对于技术开发人员来说，.Net平台的两大特性是非常卓越的，首先是其所提供的公共语言运行时,也就是公用语言运行平台,另一方面就是其庞大而全面的统一编程类。Visual C#就是通过调用这些类、对象来实现许多比较强大的功能。</p><p>本文通过向大家介绍一个.Net平台上用C#写的可以停放在任务栏上的图标程序（类似于Flashget、OICQ那种系统托盘图标）来和大家一起体验一下用C#编程的乐趣。</p><h2 id="一、概述" tabindex="-1"><a class="header-anchor" href="#一、概述" aria-hidden="true">#</a> 一、概述</h2><p>我这里所指的图标程序是类似于在Windows中经常接触的停放在任务栏上，在后台运行的病毒监视、媒体播放等程序。它们一般都具有单击显示或隐藏主界面，击右键弹出菜单，当鼠标停在图标上时显示提示信息的功能。</p><p>程序主要用到了一下几个类：</p><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>System.Windows.Fomrs.NotifyIcon类
System.Windows.Forms.ContextMenu类
System.Windows.Forms.MenuItem类
System.Windows.Forms.Label类
System.Windows.Forms.Timer类
</code></pre></div><h2 id="二、程序设计和运行的环境" tabindex="-1"><a class="header-anchor" href="#二、程序设计和运行的环境" aria-hidden="true">#</a> 二、程序设计和运行的环境</h2><p>微软公司视窗2000服务器版或视窗XP版<br> .Net FrameWrok SDK Beta 2版</p><h2 id="三、具体实现步骤" tabindex="-1"><a class="header-anchor" href="#三、具体实现步骤" aria-hidden="true">#</a> 三、具体实现步骤</h2><p>1.在Visual Studio下新建一个C#的工程，不妨命名为AnimateSystemTray。图示如下：</p><p><img src="`+o+'" alt="bar2_1"></p><p>2.现在我们来设计程序的主界面：</p><p>先将窗体的Text属性设置为&quot;动画系统图标示例&quot;，MaximiseBox、MinimiseBox、ShowInTaskbar属性均设置为False。再往窗体上添加Label控件、NotifyIcon控件、ContextMenu控件、Timer控件各一个。将Label控件的Text属性设置为&quot;请右击系统托盘图标&quot;；将NotifyIcon控件的Icon属性设置为一个图标文件：<img src="'+n+'" alt="bar2_2">，Text属性设置为&quot;这是个示例程序！&quot;,ContextMenu属性设置为&quot;contextMenu1&quot;；接下来开始编辑ContextMenu控件，图示如下：</p><p><img src="'+e+'" alt="bar2_3"></p><p>最后还要在导入两个图标<img src="'+n+'" alt="bar2_4">(Icon1.ico)， <img src="'+c+`" alt="bar2_5">(Icon2.ico)文件到该项目。</p><p>现在我们开始编写代码部分：</p><p>首先在我们的类中添加以下数据成员：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token class-name">Icon</span> m_Icon1<span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name">Icon</span> m_Icon2<span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> m_bFlag<span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> m_bShowWnd<span class="token punctuation">;</span>
</code></pre></div><p>修改Form1()函数为：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token function">Form1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//</span>
    <span class="token comment">// Required for Windows Form Designer support</span>
    <span class="token comment">//</span>
    <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//</span>
    <span class="token comment">// TODO: Add any constructor code after InitializeComponent call</span>
    <span class="token comment">//</span>
    m_bFlag<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
    m_bShowWnd<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span>
    <span class="token punctuation">{</span>
        m_Icon1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Icon</span><span class="token punctuation">(</span><span class="token string">&quot;Icon1.ico&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//导入图标文件</span>
        m_Icon2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Icon</span><span class="token punctuation">(</span><span class="token string">&quot;Icon2.ico&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">&quot;Error &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>Message<span class="token punctuation">,</span> <span class="token string">&quot;Animate Tray - Error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        menuItem2<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        menuItem3<span class="token punctuation">.</span>Enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>添加menuItem1、menuItem2、menuItem3、m_trayIcon的Click事件，消息处理函数如下：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">menuItem1_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    timer1<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打开计时器</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">menuItem2_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    timer1<span class="token punctuation">.</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//停止计时器</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">menuItem3_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Application<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//退出应用程序</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">m_trayIcon_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>m_bShowWnd <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token comment">//隐藏主界面</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        m_bShowWnd <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span><span class="token comment">//显示主界面</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        m_bShowWnd <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>最后还要添加timer1的<code>Tick()</code>函数：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">timer1_Tick</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> m_Icon1 <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> m_Icon2 <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token punctuation">)</span> <span class="token comment">//如果两个图标文件都被正确载入</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//只要timer1被启动，则在两个图标之间不断进行选择变换，实现动画效果</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> m_bFlag <span class="token operator">==</span> <span class="token boolean">true</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            m_trayIcon<span class="token punctuation">.</span>Icon <span class="token operator">=</span> m_Icon2<span class="token punctuation">;</span>
            m_bFlag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{</span>
            m_trayIcon<span class="token punctuation">.</span>Icon <span class="token operator">=</span> m_Icon1<span class="token punctuation">;</span>
            m_bFlag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>好了，按Ctrl＋F5试试效果吧！</p><p>运行程序，将显示一个主窗口，此时还可以看到在任务栏上面多了一个图标。当鼠标移到其上停留一下时，将显示一个简单的提示信息，点击该图标则将隐藏主窗口，单击右键，出来一个菜单，选&quot;动画图标开始&quot;和&quot;动画图标结束&quot;可以控制图标状态。</p><h2 id="四-总结" tabindex="-1"><a class="header-anchor" href="#四-总结" aria-hidden="true">#</a> 四．总结</h2><p>做完这个程序，我们不难发现用C#做一些运用程序效果是非常方便的。以前我在SDK、MFC下，用到了<code>Shell_NotifyIcon()</code>、<code>TrackPopMenu()</code>以及<code>DestroyMenu()</code>，还要自己添加消息处理函数，工作量是非常大的。现在微软为我们做好了这些工作，是不是很方便？快快加入C#的行列吧。</p>`,29),k=[u];function i(r,m){return a(),t("div",null,k)}const A=s(l,[["render",i],["__file","bar2.html.vue"]]);export{A as default};
