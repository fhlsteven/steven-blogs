import{_ as n,o as s,c as a,a as p}from"./app-a2b6e588.js";const t="/steven-blogs/assets/progmif2_1-5c5e2492.png",o="/steven-blogs/assets/progmif2_2-df65a7a9.png",e={},c=p(`<h1 id="如何重画windows控件" tabindex="-1"><a class="header-anchor" href="#如何重画windows控件" aria-hidden="true">#</a> 如何重画Windows控件</h1><blockquote><p>http://www.uncj.net/bbs/index.asp 2003-1-17 ;程序员大联盟</p></blockquote><h2 id="概述" tabindex="-1"><a class="header-anchor" href="#概述" aria-hidden="true">#</a> 概述</h2><p>当你在全新体验Windows XP令人赏心悦目的界面的时候，你一定在想&quot;如果我的程序界面也都能这么漂亮，那该多好啊&quot;。那就让我们来看看到底应该如何通过.NET类库来重画Windows标准控件。</p><p>本文通过两个例子来阐述如何通过程序编码来有效的改变Windows标准控件外观。</p><h2 id="平台需求" tabindex="-1"><a class="header-anchor" href="#平台需求" aria-hidden="true">#</a> 平台需求</h2><p>Visual Studio .NET<br> Visual C# .NET</p><h2 id="例1-改变控件属性" tabindex="-1"><a class="header-anchor" href="#例1-改变控件属性" aria-hidden="true">#</a> 例1：改变控件属性</h2><p>使用Visual Studio .NET来开发软件时，可以利用其强大的IDE环境来手工设定界面控件的属性。但是如果你要使你整个程序上的控件风格都是某种特定属性的话，那最好的方法就是自己重载控件类。</p><p>让我们从最简单的System.Windows.Forms.Button类开始尝试，按钮有如下的常用属性：</p><p>BackColor--按钮的背景颜色</p><p>Cursor--鼠标状态</p><p>Enabled--是否启用按钮</p><p>FlatStyle--按钮的扁平风格</p><p>Font--按钮上的字体</p><p>ForeColor--按钮的前景颜色</p><p>Height--按钮的高度</p><p>Image--按钮上的图片</p><p>Location--按钮上的位置</p><p>Text--按钮上的文字</p><p>Visible--按钮是否可见</p><p>Width--按钮的宽度</p><p>在下面的这个例子里面，我们得到一个蓝底白字的扁平按钮：</p><p>1、在Visual C# .NET中新建一个Windows Application项目，命名为OwnDrawButton1；</p><p>2、往项目中添加一个MyButton类，将其改为继承<code>System.Windows.Forms.Button</code>，并在构造函数中添加修改属性的代码；</p><p>就像这样：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyButton</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Button</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">MyButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//set the back color to blue</span>
        BackColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>Blue<span class="token punctuation">;</span>
        <span class="token comment">//set the appearance style to flat</span>
        FlatStyle <span class="token operator">=</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>FlatStyle<span class="token punctuation">.</span>Flat<span class="token punctuation">;</span>
        <span class="token comment">//use system default font</span>
        Font <span class="token operator">=</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Control<span class="token punctuation">.</span>DefaultFont<span class="token punctuation">;</span>
        <span class="token comment">//use white color to write text and draw the border</span>
        ForeColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>White<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>3、拖一个按钮到Form1上，右击鼠标，单击&quot;View Code&quot;，在代码中用&quot;MyButton&quot;替换掉&quot;System.Windows.Forms.Button&quot;；</p><p>4、编译执行。</p><p>现在，你就能在你的界面上看到自定义的控件了（如图1）。</p><p><img src="`+t+`" alt="img_1"><br> 图1 通过代码修改控件属性的按钮</p><h2 id="例2-重画简单控件" tabindex="-1"><a class="header-anchor" href="#例2-重画简单控件" aria-hidden="true">#</a> 例2：重画简单控件</h2><p>仅通过改变控件的属性值来自定义控件，在很多情况下是不能令人满意的。例如如果想把Windows XP里那种风格的按钮放到Windows 98/2000下，你就得自己来画那些按钮了。</p><p>在这种情况下，你可以通过重载OnPaint()等事件来重画按钮。你也可以通过EventHandler来让控件响应更多的事件，例如，我们可以给按钮添加鼠标悬停效果，给MouseEnter和MouseLeave分别加上EeventHandler，这样，你在事件响应函数里写的代码就会被调用。</p><p>下面是一个例子，这个例子编写了一个类似Windows XP中按钮风格的控件：</p><p>1、在Visual C# .NET中新建一个Windows Application项目，命名为OwnDrawButton2；</p><p>2、往项目中添加一个MyButton类，将其改为继承System.Windows.Forms.Button，在构造函数中添加修改属性的代码和事件响应关联代码，并编写各函数代码，如下所列：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Drawing</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Windows</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">OwnDrawButton2</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyButton</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Button</span></span>
    <span class="token punctuation">{</span>
        <span class="token comment">//state variable for mouse down</span>
        <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> mouseDown <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        <span class="token comment">//state variable for mouse hover</span>
        <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> mouseHover <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token function">MyButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//set the control UserPaint</span>
            <span class="token function">SetStyle</span><span class="token punctuation">(</span>ControlStyles<span class="token punctuation">.</span>UserPaint<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//EventHandler for MouseDown</span>
            MouseDown <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MouseEventHandler</span><span class="token punctuation">(</span>OnMouseDown<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//EventHandler for MouseUp</span>
            MouseUp <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MouseEventHandler</span><span class="token punctuation">(</span>OnMouseUp<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//EventHandler for MouseEnter</span>
            MouseEnter <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EventHandler</span><span class="token punctuation">(</span>OnMouseEnter<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//EventHandler for MouseLeave</span>
            MouseLeave <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EventHandler</span><span class="token punctuation">(</span>OnMouseLeave<span class="token punctuation">)</span><span class="token punctuation">;</span>

            Height <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span><span class="token comment">//Default Height</span>
            Width <span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">;</span><span class="token comment">//Default Width</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnPaint</span><span class="token punctuation">(</span><span class="token class-name">PaintEventArgs</span> pe<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//first, paint the control with parent form&#39;s background color</span>
            pe<span class="token punctuation">.</span>Graphics<span class="token punctuation">.</span><span class="token function">FillRectangle</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">SolidBrush</span><span class="token punctuation">(</span>Parent<span class="token punctuation">.</span>BackColor<span class="token punctuation">)</span><span class="token punctuation">,</span>
            pe<span class="token punctuation">.</span>ClipRectangle<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//if the button is disabled, draw the disable style</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>Enabled <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token function">DrawDisableButton</span><span class="token punctuation">(</span>pe<span class="token punctuation">.</span>Graphics<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mouseDown<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token comment">//when mouse down, draw the mouse down style</span>
                <span class="token function">DrawMouseDownButton</span><span class="token punctuation">(</span>pe<span class="token punctuation">.</span>Graphics<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mouseHover<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token comment">//when mouse hover, draw the mouse hover style</span>
                <span class="token function">DrawMouseHoverButton</span><span class="token punctuation">(</span>pe<span class="token punctuation">.</span>Graphics<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Focused<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token comment">//when mouse is focused but not mouse hover,</span>
                <span class="token comment">//draw the focus style</span>
                <span class="token function">DrawContainFocusButton</span><span class="token punctuation">(</span>pe<span class="token punctuation">.</span>Graphics<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span><span class="token comment">//else, draw the normal style</span>
            <span class="token punctuation">{</span>
                <span class="token function">DrawNormalButton</span><span class="token punctuation">(</span>pe<span class="token punctuation">.</span>Graphics<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token function">WriteText</span><span class="token punctuation">(</span>pe<span class="token punctuation">.</span>Graphics<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//write text</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnMouseDown</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">MouseEventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            mouseDown <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">//mouse is down now</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnMouseUp</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">MouseEventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            mouseDown <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">//mouse is up now</span>

            <span class="token comment">//call paint action</span>
            <span class="token class-name">PaintEventArgs</span> pe <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PaintEventArgs</span><span class="token punctuation">(</span><span class="token function">CreateGraphics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ClientRectangle<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">OnPaint</span><span class="token punctuation">(</span>pe<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnMouseEnter</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            mouseHover <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">//mouse hover on</span>

            <span class="token comment">//call paint action</span>
            <span class="token class-name">PaintEventArgs</span> pe <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PaintEventArgs</span><span class="token punctuation">(</span><span class="token function">CreateGraphics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ClientRectangle<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">OnPaint</span><span class="token punctuation">(</span>pe<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnMouseLeave</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            mouseHover <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">//mouse is not hover on</span>

            <span class="token comment">//call paint action</span>
            <span class="token class-name">PaintEventArgs</span> pe <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PaintEventArgs</span><span class="token punctuation">(</span><span class="token function">CreateGraphics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ClientRectangle<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token function">OnPaint</span><span class="token punctuation">(</span>pe<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DrawBorder</span><span class="token punctuation">(</span><span class="token class-name">Graphics</span> g<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> state<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">//draw normal style broder</span>
            <span class="token punctuation">{</span>
                <span class="token class-name">Pen</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Pen</span><span class="token punctuation">(</span>SystemColors<span class="token punctuation">.</span>ControlLightLight<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">//draw hover style border</span>
            <span class="token punctuation">{</span>
                <span class="token class-name">Pen</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Pen</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>Yellow<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token comment">//draw pressed style border</span>
            <span class="token punctuation">{</span>
                <span class="token class-name">Pen</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Pen</span><span class="token punctuation">(</span>SystemColors<span class="token punctuation">.</span>ControlDark<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token comment">//draw disabled style border</span>
            <span class="token punctuation">{</span>
                <span class="token class-name">Pen</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Pen</span><span class="token punctuation">(</span>SystemColors<span class="token punctuation">.</span>ControlLight<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token comment">//draw default style border</span>
            <span class="token punctuation">{</span>
                <span class="token class-name">Pen</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Pen</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span>SkyBlue<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token comment">//draw disable style border</span>
            <span class="token punctuation">{</span>
                <span class="token class-name">Pen</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Pen</span><span class="token punctuation">(</span>Color<span class="token punctuation">.</span><span class="token function">FromArgb</span><span class="token punctuation">(</span><span class="token number">161</span><span class="token punctuation">,</span> <span class="token number">161</span><span class="token punctuation">,</span> <span class="token number">146</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span><span class="token comment">//draw normal style border</span>
            <span class="token punctuation">{</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>Pens<span class="token punctuation">.</span>Black<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>Pens<span class="token punctuation">.</span>Black<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>Pens<span class="token punctuation">.</span>Black<span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>Pens<span class="token punctuation">.</span>Black<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>Pens<span class="token punctuation">.</span>Black<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>Pens<span class="token punctuation">.</span>Black<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>Pens<span class="token punctuation">.</span>Black<span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>Pens<span class="token punctuation">.</span>Black<span class="token punctuation">,</span> Width <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>
                Width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DrawNormalButton</span><span class="token punctuation">(</span><span class="token class-name">Graphics</span> g<span class="token punctuation">)</span><span class="token comment">//draw normal style button</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//draw normal style border</span>
            <span class="token function">DrawBorder</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//paint background</span>
            <span class="token function">PaintBack</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> SystemColors<span class="token punctuation">.</span>ControlLightLight<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DrawMouseHoverButton</span><span class="token punctuation">(</span><span class="token class-name">Graphics</span> g<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//draw mouse hover style border</span>
            <span class="token function">DrawBorder</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//paint background</span>
            <span class="token function">PaintBack</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> SystemColors<span class="token punctuation">.</span>ControlLightLight<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DrawMouseDownButton</span><span class="token punctuation">(</span><span class="token class-name">Graphics</span> g<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//draw mouse down style border</span>
            <span class="token function">DrawBorder</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//paint background</span>
            <span class="token function">PaintBack</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> SystemColors<span class="token punctuation">.</span>ControlLight<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DrawDisableButton</span><span class="token punctuation">(</span><span class="token class-name">Graphics</span> g<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//draw disable style border</span>
            <span class="token function">DrawBorder</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//paint background</span>
            <span class="token function">PaintBack</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> SystemColors<span class="token punctuation">.</span>ControlLight<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DrawContainFocusButton</span><span class="token punctuation">(</span><span class="token class-name">Graphics</span> g<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//draw contain focuse style border</span>
            <span class="token function">DrawBorder</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//paint background</span>
            <span class="token function">PaintBack</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> SystemColors<span class="token punctuation">.</span>ControlLightLight<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//paint background area of the button</span>
        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PaintBack</span><span class="token punctuation">(</span><span class="token class-name">Graphics</span> g<span class="token punctuation">,</span> <span class="token class-name">Color</span> c<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            g<span class="token punctuation">.</span><span class="token function">FillRectangle</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">SolidBrush</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
            Width <span class="token operator">-</span> <span class="token number">6</span><span class="token punctuation">,</span> Height <span class="token operator">-</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">WriteText</span><span class="token punctuation">(</span><span class="token class-name">Graphics</span> g<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//calculate the text position</span>
            <span class="token class-name"><span class="token keyword">int</span></span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token class-name">Size</span> s <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">MeasureString</span><span class="token punctuation">(</span>Text<span class="token punctuation">,</span> Font<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            x <span class="token operator">=</span> <span class="token punctuation">(</span>Width <span class="token operator">-</span> s<span class="token punctuation">.</span>Width<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
            y <span class="token operator">=</span> <span class="token punctuation">(</span>Height <span class="token operator">-</span> s<span class="token punctuation">.</span>Height<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>

            <span class="token comment">//draw text</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>Enabled<span class="token punctuation">)</span> <span class="token comment">//is enabled, draw black text</span>
                g<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>Text<span class="token punctuation">,</span> Font<span class="token punctuation">,</span> Brushes<span class="token punctuation">.</span>Black<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token comment">//not enabled, draw gray text</span>
                g<span class="token punctuation">.</span><span class="token function">DrawString</span><span class="token punctuation">(</span>Text<span class="token punctuation">,</span> Font<span class="token punctuation">,</span> Brushes<span class="token punctuation">.</span>Gray<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>3、在新控件的构造函数中添加：拖3个按钮到Form1上，将其中一个的&quot;Enable&quot;设为&quot;false&quot;，右击鼠标，单击&quot;View Code&quot;，在代码中用&quot;MyButton&quot;替换掉&quot;System.Windows.Forms.Button&quot;；</p><p>4、编译执行。</p><p>最终，我们就得到了如图2所示的按钮控件。它可以在任何版本的windows操作系统上都保持一个样子。</p><p><img src="`+o+`" alt="img_2"><br> 图2 一个类似于Windows XP样式的按钮控件</p><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>原作者：痕迹
来 源：本站
共有561位读者阅读过此文
</code></pre></div>`,43),u=[c];function l(k,i){return s(),a("div",null,u)}const m=n(e,[["render",l],["__file","progmif2.html.vue"]]);export{m as default};
