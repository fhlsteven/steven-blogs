import{_ as n,o as s,c as a,a as e}from"./app-d9da1b6d.js";const o={},p=e(`<h1 id="vba-入门课程" tabindex="-1"><a class="header-anchor" href="#vba-入门课程" aria-hidden="true">#</a> VBA 入门课程</h1><blockquote><p>KLYan 荣誉会员 2002-12-26 01:22 PM</p></blockquote><p>这是试写的VBA的课程 VBALesson1，希望各位给予意见，以便以后改进。</p><p>程序说明：</p><p>几种用VBA在单元格输入数据的方法：</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Sub</span> Writes<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">-</span> <span class="token number">2</span> 方法，最简单在 <span class="token string">&quot;[  ]&quot;</span> 中输入单元格名称。
   [A1] <span class="token operator">=</span> <span class="token number">100</span>  <span class="token comment">&#39;在 A1 单元格输入100。</span>
   [A2<span class="token punctuation">:</span>A4] <span class="token operator">=</span> <span class="token number">10</span>  <span class="token comment">&#39;在 A2:A4 单元格输入10。</span>
<span class="token operator">-</span><span class="token operator">-</span> <span class="token number">4</span> 方法，采用 Range<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span>， <span class="token string">&quot; &quot;</span> 中输入单元格名称。
   Range<span class="token punctuation">(</span><span class="token string">&quot;B1&quot;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">200</span>  <span class="token comment">&#39;在 B1 单元格输入200。</span>
   Range<span class="token punctuation">(</span><span class="token string">&quot;C1:C3&quot;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">300</span>  <span class="token comment">&#39;在 C1:C3 单元格输入300。</span>
<span class="token operator">-</span><span class="token operator">-</span> <span class="token number">6</span> 方法，采用 Cells<span class="token punctuation">(</span>Row<span class="token punctuation">,</span>Column<span class="token punctuation">)</span>，Row是单元格行数，Column是单元格栏数。
   Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">400</span>  <span class="token comment">&#39;在 D1 单元格输入400。</span>
   Range<span class="token punctuation">(</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Cells<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">50</span>  <span class="token comment">&#39;在 E1:E 5单元格输入50。</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>你点选任何单元格，按 Selection 按钮，則则所点选的单元格均会被输入文字 &quot;Test&quot;。</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Sub</span> Selection1<span class="token punctuation">(</span><span class="token punctuation">)</span>
    Selection<span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token string">&quot;Test&quot;</span>  <span class="token comment">&#39;在任何你点选的单元格输入文字 &quot;Test&quot;。</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>&quot;观看本程序的方法：粗体文字为程序，其它字体均为说明文字。按快捷键 Alt+F11即可看到程序。&quot;</p><p>请各位发表读后建言，以便改进。</p><p><strong>VBALesson2 程序说明</strong>：</p><p>几种如何把别的工作表 Sheet4 数据，读到这个工作表的方法：在被读取的单元格前加上工作表名称 Sheet4。</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Sub</span> Writes<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">-</span><span class="token operator">-</span> <span class="token number">2</span> 方法，最简单在被读取的  <span class="token string">&quot;[  ]&quot;</span> 前加上被读取的工作表名称 Sheet4。
   [A1] <span class="token operator">=</span> Sheet4<span class="token punctuation">.</span>[A1]  <span class="token comment">&#39;把Sheet4 A1 单元格的数据，读到 A1单元格。</span>
   [A2<span class="token punctuation">:</span>A4] <span class="token operator">=</span> Sheet4<span class="token punctuation">.</span>[B1]  <span class="token comment">&#39;&#39;把 Shee4 工作表单元格 B1 数据，读到 A2:A4 单元格。</span>
<span class="token operator">-</span><span class="token operator">-</span> <span class="token number">4</span> 方法，在被读取的工作表 Range<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span>的 Range 前加上被读取的工作表名称Sheet4。
   Range<span class="token punctuation">(</span><span class="token string">&quot;B1&quot;</span><span class="token punctuation">)</span> <span class="token operator">=</span> Sheet4<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;B1&quot;</span><span class="token punctuation">)</span>  <span class="token comment">&#39;&#39;把 Shee4工作表单元格 B1 数据，读到  B1 单元格。</span>
   Range<span class="token punctuation">(</span><span class="token string">&quot;C1:C3&quot;</span><span class="token punctuation">)</span> <span class="token operator">=</span> Sheet4<span class="token punctuation">.</span>Range<span class="token punctuation">(</span><span class="token string">&quot;C1&quot;</span><span class="token punctuation">)</span>  <span class="token comment">&#39;把 Shee4 工作表单元格 C1 数据，读到 C1:C3 单元格。</span>
<span class="token operator">-</span><span class="token operator">-</span> <span class="token number">6</span> 方法，在被读取的工作表 Cells<span class="token punctuation">(</span>Row<span class="token punctuation">,</span>Column<span class="token punctuation">)</span>，Cells 前加上被读取工作表名称 Sheet4。
  Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">=</span> Sheet4<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>  <span class="token comment">&#39;把 Shee4 工作表单元格 D1 数据，读到 D1 单元格。</span>
   Range<span class="token punctuation">(</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Cells<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> Sheet4<span class="token punctuation">.</span>Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment">&#39;把 Shee4 工作表单元格 E1 数据，读到 E1:E 5单元格。</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>你点选任何单元格，按 Selection 按钮，则所点选的单元格均会被输入 Shee4 工作表单元格 F1 数据。</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Public</span> <span class="token keyword">Sub</span> Selection1<span class="token punctuation">(</span><span class="token punctuation">)</span>
   Selection<span class="token punctuation">.</span>Value <span class="token operator">=</span> Sheet4<span class="token punctuation">.</span>[F1]  <span class="token comment">&#39;把 Shee4 工作表单元格 F1 数据，读到任何你点选的单元格。</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p><strong>VBALesson3 程序说明</strong>：</p><p>如何利用 Worksheet_SelectionChange 输入数据的方法。</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_SelectionChange<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">)</span>
  Target <span class="token operator">=</span> <span class="token number">100</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>Target 指的是你鼠标所选的单元格，Worksheet_SelectionChange() 事件的参数。<br> 可以是一个也可以是好几个单元格。<br> Range 是 Excel 特有的变量形态，叫范围。<br> Target As Rang 是把 Target 这个参数设定为 Range 变量形态。<br> Target = 100 是把你点选的单元格输入数字100。</p><p><strong>VBALesson4 程序说明</strong>：</p><p>如何利用 Worksheet_SelectionChange 在限定的单元格输入数据的方法。</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_SelectionChange<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">)</span>
   <span class="token keyword">If</span> Target<span class="token punctuation">.</span>Row <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">And</span> Target<span class="token punctuation">.</span>Column <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">Then</span>
      Target <span class="token operator">=</span> <span class="token number">100</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p><code>If ... Then ... End If</code> 这是我们学的这一个逻辑判断语句。<br><code>Target.Row &gt;= 2</code>，指的是鼠标选定的单元格的行大于或等于 2。<br><code>Target.Column = 2</code> ，指的是鼠标选定的单元格的栏等于 2。<br> If <code>Target.Row &gt;= 2 And Target.Column = 2 Then</code> 指的是只有在Target.Row &gt;= 2及Target.Column = 2二个条件成立时。<br> 就是 (Target.Row &gt;= 2) 为True及(Target.Column = 2)为True时，才执行下面的程序 Target=100，<br> 也就是 B 栏第二行及以下行用鼠标被点选时，才会被输入100，其它单元格则不被输入数据。</p><p><strong>VBALesson5 程序说明</strong>：</p><p>比较 Worksheet_SelectionChange() 与用按钮 CommandButton1_Click() 来执行程序二者的方法与写法有何不同。</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code>Worksheet_SelectionChange<span class="token punctuation">(</span><span class="token punctuation">)</span>事件
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_SelectionChange<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">)</span>
   <span class="token keyword">If</span> Target<span class="token punctuation">.</span>Row <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">And</span> Target<span class="token punctuation">.</span>Column <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">Then</span>
      Target <span class="token operator">=</span> <span class="token number">100</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>按鈕 CommandButton1_Click()</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> CommandButton1_Click<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">If</span> ActiveCell<span class="token punctuation">.</span>Row <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">And</span> ActiveCell<span class="token punctuation">.</span>Column <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">3</span> <span class="token keyword">Then</span>
    ActiveCell <span class="token operator">=</span> <span class="token number">100</span>
  <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>二者执行方法最大的地方，在于 Worksheet_SelectionChange() 是自动的，你不用了解他是怎么完成工作的。<br> 按钮 CommandButton1_Click() 是人工的，比 SelectionChange()多一道手续，就是要去按那接钮，程序才会执行。<br> SelectionChange() 有一个参数 Target 可用；CommandButton1_Click ()没有。<br> 所以我们要用 ActiveCell 内定函数来取代Target，ActiveCell 与 Target最大的不同点他只能指定一个单元格。<br> 就是你选取多个单元格也只有最上面的单元格会加上数据；用 Selection 取代 ActiveCell， 用法就跟 Target 一样了。</p><p><strong>VBALesson 6 程序说明</strong>：</p><p>完整的 If...Then ┅ End 逻辑判断式。</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_SelectionChange<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">)</span>
   <span class="token keyword">If</span>  Target<span class="token punctuation">.</span>Row <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">And</span> Target<span class="token punctuation">.</span>Column <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">Then</span>
      Target <span class="token operator">=</span> <span class="token number">200</span>
   <span class="token keyword">ElseIf</span>  Target<span class="token punctuation">.</span>Row <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">And</span> Target<span class="token punctuation">.</span>Column <span class="token operator">=</span> <span class="token number">3</span> <span class="token keyword">Then</span>
      Target <span class="token operator">=</span> <span class="token number">300</span>
   <span class="token keyword">ElseIf</span>  Target<span class="token punctuation">.</span>Row <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">And</span> Target<span class="token punctuation">.</span>Column <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">Then</span>
      Target <span class="token operator">=</span> <span class="token number">400</span>
  <span class="token keyword">Else</span>
      Target <span class="token operator">=</span> <span class="token number">500</span>
  <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>这是个完整的 If 逻辑判断式，意思是说，假如 If 後的判断式条件成立的话，就执行第二条程序，否则假如 ElseIf 後的判断式条件成立的话，就执行第四条程序，否则假如另一个 ElseIf 後的判断式条件成立的话，就执行第六条程序。<br> Else 的意思是说，假如以上条件都不成立的话，就执行第八条程序。<br> 他的执行方式是假如 IF 的条件成立的话，就不执行其它ElseIf 及Else 的逻辑判断式，假如 If 後的条件不成立的话才会执行 ElseIf 或 Else 逻辑判断式。第二个 ElseIf後的条件因为与 IF 後的条件一样，所以这个判断式後面的 Target=400 将是永远无法执行到的程序。</p><p><strong>VBALesson 7 程序说明</strong>∶我们为什麽要用变数。</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_SelectionChange<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">)</span>
<span class="token keyword">Dim</span>  i <span class="token punctuation">,</span>  j  <span class="token keyword">As</span> <span class="token keyword">Integer</span>
<span class="token keyword">Dim</span>  k  <span class="token keyword">As</span> Range
i  <span class="token operator">=</span>  Target<span class="token punctuation">.</span>Row
j  <span class="token operator">=</span>  Target<span class="token punctuation">.</span>Column
<span class="token keyword">Set</span>  k  <span class="token operator">=</span>  Target
   <span class="token keyword">If</span>  i  <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">And</span>  j  <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">Then</span>
      k  <span class="token operator">=</span>  <span class="token number">200</span>
   <span class="token keyword">ElseIf</span>  i <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">2</span>  <span class="token keyword">And</span>  j <span class="token operator">=</span> <span class="token number">3</span>  <span class="token keyword">Then</span>
      k  <span class="token operator">=</span>  <span class="token number">300</span>
   <span class="token keyword">ElseIf</span>  i <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">2</span>  <span class="token keyword">And</span>  j <span class="token operator">=</span> <span class="token number">4</span>  <span class="token keyword">Then</span>
      k  <span class="token operator">=</span>  <span class="token number">400</span>
   <span class="token keyword">Else</span>
      k  <span class="token operator">=</span>  <span class="token number">500</span>
   <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>跟VBALesson 6比较，程序是不是明朗多了，在前课重复的用 Target.Row，Target.Column及Target来写程序是不是有一点烦。用变量的第一个好处大家马上感觉得出来，就是可以简化程序。 使用变量前，你得先宣告变量。宣告变量的方法是在 &quot;Dim &quot; 后面写上变量 &quot; i &quot; As 后面接上变量的形态 &quot;Integer&quot;。<br><code>Dim i , j As Integer</code> 就是宣告 i 与 j 为整数变量，这是同时宣告二个变量 i 与 j 所以要在二个变量间加个 &quot; , &quot;号。<br><code>Dim k As Range</code> 是宣告 k 为范围资料形态，Range这是 Excel 特有的资料形态。<br><code>i = Target.Row</code>是把当前单元格的行数，指定给变量 i。<br><code>j = Target.Column</code> 是把当前单元格的栏数，指定给变量 j。<br><code>Set k = Target</code> 是把当前的单元格，指定给变量 k。<br> 用像 i 与 j 这样简单的变量，在程序的前面你可能还记得 i 或 j 代表着什厶。程序写长了，你可能忘记 i 或 j 代表着什厶。所以最好的方法是用比较有意义的代号，来为变量命名如 iRow 或 iCol 来取代 i 及 j 。</p><p><strong>VBALesson 8 程序说明</strong>∶体会一下Worksheet_Change()事件。</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_Change<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">)</span>
<span class="token keyword">Dim</span> iRow<span class="token punctuation">,</span> iCol <span class="token keyword">As</span> <span class="token keyword">Integer</span>
iRow <span class="token operator">=</span> Target<span class="token punctuation">.</span>Row
iCol <span class="token operator">=</span> Target<span class="token punctuation">.</span>Column
   <span class="token keyword">If</span> iRow <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">And</span> iCol <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">And</span> Target <span class="token operator">&lt;</span><span class="token operator">&gt;</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Then</span>
      Application<span class="token punctuation">.</span>EnableEvents <span class="token operator">=</span> <span class="token boolean">False</span>
      Cells<span class="token punctuation">(</span>iRow<span class="token punctuation">,</span> iCol <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> Cells<span class="token punctuation">(</span>iRow<span class="token punctuation">,</span> iCol<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span>
      Application<span class="token punctuation">.</span>EnableEvents <span class="token operator">=</span> <span class="token boolean">True</span>
   <span class="token keyword">ElseIf</span> iRow <span class="token operator">&gt;</span><span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">And</span> iCol <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">And</span> Target <span class="token operator">=</span> <span class="token string">&quot;&quot;</span> <span class="token keyword">Then</span>
      Cells<span class="token punctuation">(</span>iRow<span class="token punctuation">,</span> iCol <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
   <span class="token keyword">Else</span>
      Cells<span class="token punctuation">(</span>iRow<span class="token punctuation">,</span> iCol <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
   <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>前几个教程都是用Worksheet_SelectionChange 事件来举例子，大家应该能体会他是怎厶一回事了吧。<br> 这个教程就是要让你来体会什厶是Worksheet_Chang()事件。因为这二个事件在VBA都是非常有用的，所以一定要了解。<br> 简单的说，前者是你鼠标移动到那个单元格，就触发那个事件的执行。後者是要等到你点选的单元格，数有了改变才会触发事件的执行。二者执行的时机一前一後。<br> Target &lt;&gt; &quot;&quot; 是代表限定当前的单元格要是有数的，才会执行以下三行的程序。<br><code>Cells(iRow, iCol + 1) = Cells(iRow, iCol) * 2</code>，是你在 B 栏输入数时，C 栏将可得到 B 栏二倍的数。<br> Target = &quot;&quot; 是限定当前的单元格要是没有数的，才会执行以下一行的程序。<br><code>Cells(iRow, iCol + 1) = &quot;&quot;</code>，是把 C 栏的数清成空格。<br> Application.EnableEvents = False与Application.EnableEvents = True，这是个成双的程序，当你用了前者记得在执行其他程序後要写上後面的程序。它的目的在抑制事件连锁执行。简单的说就是，在 B 字段所触发的事件，不愿在其它单元格再触发另一个Worksheet_Change()事件。</p><p>1、那两个按钮是怎麽做出来的？<br> 检视—工具列—绘图—快取图案—基本图案—按钮形 (第3栏第4行) 。<br> 按钮形图案—按右键—快取图案格式—色彩和线条---填满—色彩—蓝绿色—线条--色彩—蓝绿色。<br> 2、那两个按钮是怎麽和程序连接起来的？<br> 按钮形图案—按右键—快取图案格式—宏—“Writes” 。</p><p><strong>VBALesson 9 程序说明</strong>∶体会一下Worksheet_Change()事件连锁反应。</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_Change<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">)</span>
<span class="token keyword">Dim</span> iRow <span class="token keyword">As</span> <span class="token keyword">Integer</span>
iRow <span class="token operator">=</span> Target<span class="token punctuation">.</span>Row
     Application<span class="token punctuation">.</span>EnableEvents <span class="token operator">=</span> <span class="token boolean">False</span>
     Cells<span class="token punctuation">(</span>iRow<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> Cells<span class="token punctuation">(</span>iRow<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> Cells<span class="token punctuation">(</span>iRow<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
     Application<span class="token punctuation">.</span>EnableEvents <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
   
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_Change<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">)</span>
<span class="token keyword">Dim</span> iRow <span class="token keyword">As</span> <span class="token keyword">Integer</span>
iRow <span class="token operator">=</span> Target<span class="token punctuation">.</span>Row
     <span class="token comment">&#39;Application.EnableEvents = False</span>
     Cells<span class="token punctuation">(</span>iRow<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> Cells<span class="token punctuation">(</span>iRow<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> Cells<span class="token punctuation">(</span>iRow<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
     <span class="token comment">&#39;Application.EnableEvents = True</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>这个程序的目的是要在 B2 输入新的数时，C2 会将 B2 输入的新数加上 C2 原有的数呈现在 C2 上。<br> 照上面有加上 <code>Application.EnableEvents = False</code> 程序执行当然没问题。<br> 现在你在 <code>Application.EnableEvents = False</code> 与 <code>Application.EnableEvents = True</code> 前加上「 &#39;」看看。<br> 程序前加上「 &#39;」的目的是要使「 &#39;」之后的文字变成说明文字，程序执行时是会跳过说明文字，不执行说明文字的内容。<br> 程序前加上「 &#39;」符号后，文字会变成绿色。<br> 执行第二个程序时，你将发现 C2 不会按你所要求的，呈现结果。<br> 这就是所谓的事件连锁反应。</p><p><strong>VBALesson 10 程序说明</strong>∶体会一下Worksheet_Activate()事件。</p><p>这个程序的目的是要大家体会一下 Worksheet_Activate() 事件的意义与用法，大家暂且不用去了解事件的程序代码。<br> 我们在 &quot;出毛登记表&quot;工作表 K栏打勾选取我们要的数 。<br> 当打开 &quot;发毛单&quot; 工作表时， &quot;出毛登记表&quot; 工作表 K栏有打勾的那一行数 自动就复制至 &quot;发毛单&quot; 工作表。<br> 这样的做法可省去我们做一个按钮，用人工的方法将数 复制至 &quot;发毛单&quot; 工作表。但有个後遗症，那就是每次打开 &quot;发毛单&quot; 工作表时Excel一定会执行这个程序，增加Excel 的工作量。</p><p><strong>VBALesson 11 程序说明</strong>∶体会一下Worksheet_Deactivate() 与 Worksheet_BeforeDoubleClick()事件。</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_BeforeDoubleClick<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">,</span> Cancel <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">)</span>
  Cancel <span class="token operator">=</span> <span class="token boolean">True</span>
  Sheet3<span class="token punctuation">.</span>Visible <span class="token operator">=</span> xlSheetVeryHidden
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>这个程序的目的是要大家体会一下 Worksheet_Deactivate() 与 Worksheet_BeforeDoubleClick() 事件的意义与用法，大家暂且不用去了解事件的程序代码。<br> 与 VBALesson 10 教程 Sheet3 的 Worksheet_Activate() 相同的程序，写在 Sheet1 的 Worksheet_Deactivate()事件上。一样可达成我们在 VBALesson10 所要达成的目的。<br> 那我们应把程序写在 Sheet3 的 Worksheet_Activate() 事件上，或是写在 Sheet1 的 Worksheet_Deactivate() 事件上呢？依这功能需求当然还是写在 Sheet3 的 Worksheet_Activate() 事件上比较　合。<br> 因为假如你从 &quot;出毛登记表 &quot;工作表切到 &quot;说明&quot; 工作表，也会触发Worksheet_Deactivate() 的执行，徒增 Excel 的工作量。<br> Worksheet_BeforeDoubleClick() 事件有二个参数，Target 以前介绍过了，另一个参数 Cancel 是做什厶用途的呢？<br> 原来我们在单元格 DoubleClick 时会变成编辑状态 。假如我们把 Cancel 设定成 True 时，则你连按鼠标二次时，单元格不会变成编辑状态。<br> 就像这个 Worksheet_BeforeDoubleClick() 事件，我们就是把单元格 DoubleClick变成编辑状态功能 Cancel 掉。并把 Sheet3 隐藏起来。<br> &quot;说明&quot;工作表 Worksheet_BeforeDoubleClick() 的 Cancel 参数是设定 True；&quot;出毛登记表&quot;工作表 Worksheet_BeforeDoubleClick() 的 Cancel 参数是设定 False，你用鼠标连按二次就可体会设定成 True 与 False 的不同。</p><p><strong>VBALesson 12 程序说明</strong>∶体会一下 Worksheet_BeforeRightClick () 事件。</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Worksheet_BeforeRightClick<span class="token punctuation">(</span><span class="token keyword">ByVal</span> Target <span class="token keyword">As</span> Range<span class="token punctuation">,</span> Cancel <span class="token keyword">As</span> <span class="token keyword">Boolean</span><span class="token punctuation">)</span>
  <span class="token keyword">If</span> <span class="token keyword">Not</span> Application<span class="token punctuation">.</span>Intersect<span class="token punctuation">(</span>Target<span class="token punctuation">,</span> Range<span class="token punctuation">(</span><span class="token string">&quot;D8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">Is</span> <span class="token boolean">Nothing</span> <span class="token keyword">Then</span>
     Cancel <span class="token operator">=</span> <span class="token boolean">True</span>
     MsgBox <span class="token punctuation">(</span><span class="token string">&quot;Target is Range D8  and Cancel is True !&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">Else</span>
     Cancel <span class="token operator">=</span> <span class="token boolean">False</span>
  <span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>这个程序的目的是要大家体会一下Worksheet_BeforeRightClick () 事件的意义与用法。<br> Worksheet_BeforeRightClick () 事件也有二个参数，Target 以前介绍过了，另一个参数 Cancel 是做什厶用途的呢？<br> 这个 Cancel 与前一个教程 Worksheet_BeforeDoubleClick () 的 Cancel 是有所不同的。<br> 这个 Cancel 假如设定成 True 的话，将屏闭掉鼠标右键的菜单。<br> 你可以在VBALesson 12工作表 的 D8 单元格 与 D12 单元格，按鼠标右键试看看有何不同。<br> 在 D12 按鼠标右键将呈现正常的右键菜单；在 D8 按鼠标右键将呈现一个对话框并且屏闭掉右键菜单。</p><p><strong>VBALesson 13 程序说明</strong>∶动脑时间。</p><p>Worksheet 的事件计有如下七种∶</p><p>1、Worksheet_Activate()<br> 2、Worksheet_BeforeDoubleClick()<br> 3、Worksheet_BeforeRightClick()<br> 4、Worksheet_Calculate()<br> 5、Worksheet_Change()<br> 6、Worksheet_FollowHyperlink()<br> 7、Worksheet_SelectionChange()</p><p>1、前面几个教程都是我给答案，这次希望大家给我答案。<br> 2、VBALesson 13 有个自动筛选的数，请大家告诉我如何去补捉自动筛选的事件。<br> 3、也就是当你去按那筛选的按钮，如何让那对话框弹出来。<br> 4、Worksheet 的事件计有如上七种，我在事件上均写上程序码。<br> 5、利用这七个事件中的一个，请你告诉我，你去按那筛选的按钮，将弹出那个对话框。<br> 6、提示你∶除非你在工作表动个手脚，否则是弹不出对话框的。</p><p>前五个给答案的人，我将每人给15 个水晶。<br> 请大家踊跃给答案</p>`,56),t=[p];function c(l,k){return s(),a("div",null,t)}const u=n(o,[["render",c],["__file","vba4.html.vue"]]);export{u as default};
