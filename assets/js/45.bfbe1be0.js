(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{453:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"实现运行时从字符串动态创建对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现运行时从字符串动态创建对象"}},[t._v("#")]),t._v(" 实现运行时从字符串动态创建对象")]),t._v(" "),s("p",[t._v("在运行时任意指定对象的创建类型，甚至是用表示类型的名字的字符串创建所需的对象，.net Framwork的反射机制给我们带来了解决问题的方法。这里，若只需要创建一般的对象，我们可以通过"),s("code",[t._v("System.Activator")]),t._v("来实现，而较复杂的我们可以通过获取构造方法来实现。")]),t._v(" "),s("p",[t._v("反射Reflection 是.net中重要机制，通过反射，可以在运行时获得.net中每一个类型（包括类、结构、委派、接口、枚举）的成员，包括方法、属性、事件以及构造函数等，还可以获得每个成员的名称、限定符和参数等，有了反射，就可以对每一个类型了如指掌。如果获得了构造函数的信息，就可以直接创建对象，即使这个对象的类型在编译的时候还不知道。")]),t._v(" "),s("div",{staticClass:"language-csharp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// <summary>")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// CreateNewControls 根据空间的名称，类型字符串，大小、位置去动态的生成一个控件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// </summary>")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/// <param name="targetControl"> 控件加载到的容器</param>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/// <param name="ctlName">生成的控件实例名称</param>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/// <param name="ctlType">生成的控件类型字符串如（TextBox、Button等）</param>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/// <param name="ctlSize">控件的大小</param>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/// <param name="ctlLocation">控件的位置</param>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/// <returns>生成的控件实例</returns>")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token return-type class-name"}},[t._v("Control")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CreateNewControls")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Control"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ControlCollection")]),t._v(" targetControl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")])]),t._v(" ctlName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Type")]),t._v(" ctlType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Drawing"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Size")]),t._v(" ctlSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Drawing"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Point")]),t._v(" ctlLocation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Control")]),t._v(" toCreate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    toCreate "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Control"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("System"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Activator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CreateInstance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ctlType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    toCreate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ctlName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    toCreate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Size "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ctlSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    toCreate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Location "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ctlLocation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    targetControl"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("toCreate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" toCreate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Size")]),t._v(" cbSize "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[t._v("Size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("160")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("40")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Point")]),t._v(" cbPoint "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constructor-invocation class-name"}},[t._v("Point")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("206")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Control")]),t._v(" c1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("CreateNewControls")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Controls"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"control1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"System.Windows.Forms.CheckBox, System.Windows.Forms, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("cbSize"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("cbPoint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nc1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" Check Box"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v(".netFramework 1.1上，")]),t._v(" "),s("p",[s("code",[t._v('Type.GetType("System.Windows.Forms.CheckBox, System.Windows.Forms,Version=1.0.5000.0,Culture=neutral,PublicKeyToken=b77a5c561934e089")')]),t._v("。")]),t._v(" "),s("p",[t._v("我们如何取得所用"),s("code",[t._v("Windows.Form")]),t._v("程序集的版本和强名称？")]),t._v(" "),s("p",[t._v("可以用"),s("code",[t._v("GetType(CheckBox).AssemblyQualifiedName")]),t._v("这样的语法，一旦得到了这些信息，我们就可以将这些信息用于其它任何控件，因为他们都来自于同一个版本"),s("code",[t._v("Windows.Forms")]),t._v("程序集。")])])}),[],!1,null,null,null);s.default=e.exports}}]);