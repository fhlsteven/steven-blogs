import{_ as n,o as s,c as a,a as t}from"./app-d9da1b6d.js";const p="/steven-blogs/assets/encdec6_1-b9716167.png",e="/steven-blogs/assets/encdec6_2-22f95a73.png",o="/steven-blogs/assets/encdec6_3-64c567f1.png",c="/steven-blogs/assets/encdec6_4-8f81e660.png",u="/steven-blogs/assets/encdec6_5-8f1114d5.png",l={},k=t('<h1 id="如何在-net中实现加密编程" tabindex="-1"><a class="header-anchor" href="#如何在-net中实现加密编程" aria-hidden="true">#</a> 如何在.NET中实现加密编程</h1><blockquote><p>作者：张悦 发文时间：2003.10.23</p></blockquote><p>很久以前就一直想写一个加密程序，但是一直感到太麻烦而没有动手，不过在前段时间学习.NET的过程中发现.NET的框架中封装了与加密有关的类。而且要在.NET中进行密码的编程也是很容易的。</p><p>当然在开始编程之前，我们先简单的说说加密。加密最找出现在公元前1900年，当时一个古来的抄写士兵首次使用了加密技术。其做法是将文字竖着写，然后将写好的纸横着撕成一条一条的。当传到接收人手中后，按照一个的顺序将这写纸条拼好，这就是最早的加密方式。</p><p>随着计算机的产生，IBM 的Horst Feistel博士发明了一种特殊的算发将它应用在了计算机中，后来这中算法被称为DES即数据加密标准。然后在这个标准中诞生了很多的加密算法，这就是加密的由来。</p><p>现在就对本文使用的加密技术来做个讲解。首先我们得知道的是密钥这个专用名词。密钥可以这样来理解：X+Y=Z。其中X是要被加密的数据，Y就是密钥，Z是加密后的数据。如果在这个加法中将Y去掉，那吗就成了X=Z。所以Y在这里就可以被看成一个变量，而密钥也正是一个变量，当这个变量发生变化后加密的数据也就更着发生变化了。不过在有的资料中会将它称为向量。</p><p>本文所采用的加密方法是被称为密钥散列值的方法。此方法是将要加密的数据和密钥进行组合产生新的加密了的数据。</p><p>在.NET中可以说加密所要使用的类全部都集中在System.Security.Cryptography框架中，他包含了多种加密算法，所以我们使用的加密方法也是在System.Security.Cryptography框夹中。</p><p>下面我门就来看看如何实现数据的加密。</p><p>首先在窗口中添加一个Button，3个Textbox，3个Label控件。将Button的Text属性设置为“确定”。将3个Label控件的Text属性设置分别设置为：文字，密钥，HMACSHA1。3个Textbox的属性保持默认。添加控件后的图如下：</p><p><img src="'+p+`" alt="img_1"></p><p>现在双击Button1在Button1_Click中输入下面的代码：</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Button1_Click<span class="token punctuation">(</span><span class="token keyword">ByVal</span> sender <span class="token keyword">As</span> System<span class="token punctuation">.</span><span class="token keyword">Object</span><span class="token punctuation">,</span>
 <span class="token keyword">ByVal</span> e <span class="token keyword">As</span> System<span class="token punctuation">.</span>EventArgs<span class="token punctuation">)</span> <span class="token keyword">Handles</span> Button1<span class="token punctuation">.</span>Click
        <span class="token keyword">Dim</span> txt1<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Byte</span>
        txt1 <span class="token operator">=</span> System<span class="token punctuation">.</span>Text<span class="token punctuation">.</span>ASCIIEncoding<span class="token punctuation">.</span>ASCII<span class="token punctuation">.</span>GetBytes<span class="token punctuation">(</span>TextBox1<span class="token punctuation">.</span>Text<span class="token punctuation">)</span>
       <span class="token comment">&#39;读取输入的文字，即要加密的文字。</span>
        <span class="token keyword">Dim</span> key<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Byte</span>
        key <span class="token operator">=</span> System<span class="token punctuation">.</span>Text<span class="token punctuation">.</span>ASCIIEncoding<span class="token punctuation">.</span>ASCII<span class="token punctuation">.</span>GetBytes<span class="token punctuation">(</span>TextBox2<span class="token punctuation">.</span>Text<span class="token punctuation">)</span>
       <span class="token comment">&#39;读取密钥</span>
        <span class="token comment">&#39;HMACSHA加密</span>
        <span class="token keyword">Dim</span> hma <span class="token keyword">As</span> <span class="token keyword">New</span> System<span class="token punctuation">.</span>Security<span class="token punctuation">.</span>Cryptography<span class="token punctuation">.</span>HMACSHA1<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
      <span class="token comment">&#39;声明加密类，既使用何种加密方法</span>
        <span class="token keyword">Dim</span> csstream <span class="token keyword">As</span> <span class="token keyword">New</span>  System<span class="token punctuation">.</span>Security<span class="token punctuation">.</span>Cryptography<span class="token punctuation">.</span>CryptoStreamSystem<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>Stream<span class="token punctuation">.</span>Null<span class="token punctuation">,</span> hma<span class="token punctuation">,</span>
       Security<span class="token punctuation">.</span>Cryptography<span class="token punctuation">.</span>CryptoStreamMode<span class="token punctuation">.</span>Write<span class="token punctuation">)</span>
     <span class="token comment">&#39;进行加密转换</span>
        csstream<span class="token punctuation">.</span>Write<span class="token punctuation">(</span>txt1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> txt1<span class="token punctuation">.</span>Length<span class="token punctuation">)</span>
      <span class="token comment">&#39;将加密后的数据保存在TXT1这个变量中，此时的txt1已经不是先前的要加密的文字，而是被刷新后的已经加密的数据。</span>
        csstream<span class="token punctuation">.</span>Close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        TextBox3<span class="token punctuation">.</span>Text <span class="token operator">=</span> System<span class="token punctuation">.</span>Text<span class="token punctuation">.</span>ASCIIEncoding<span class="token punctuation">.</span>ASCII<span class="token punctuation">.</span>GetString<span class="token punctuation">(</span>hma<span class="token punctuation">.</span>Hash<span class="token punctuation">)</span>
      <span class="token comment">&#39;显示加密的文字。</span>
    <span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>程序说明：在本代码中我们主要是使用HMACSHA1算法实现了密钥散列值的加密。从代码可以看出要在.NET中进行数据的加密其实并不难，关键是选择System.Security.Cryptography中具体算法。</p><p>总结：对于加密技术本文并没设计的太多，其原因是加密技术本身在大学中就是作为单独的一们学科，何况现在有很数专门的书在讨论加密算法，有兴趣的读者可以去看看。本文主要的意图是告诉大家，在.NET中已经将加密作为框架的一部分，我们可以根据自己的需要进行选择具体的加密算法。而且在.NET中使用加密编程并不会太难。</p><p>加密文字“这一次我绝不放手”，密钥“123”时运行的效果。如图</p><p><img src="`+e+'" alt="img_2"></p><p>加密文字“这一次我绝不放手”，密钥“223”时运行的效果。如图</p><p><img src="'+o+'" alt="img_3"></p><p>加密文字“爱你直到永远ZHANG RUI RUI”，密钥“223”时运行的效果。如图</p><p><img src="'+c+'" alt="img_4"></p><p>加密文字“爱你直到永远ZHANG RUI RUI”，密钥“123”时运行的效果。如图</p><p><img src="'+u+'" alt="img_5"></p><blockquote><p>(责任编辑：赵纪雷)</p></blockquote>',24),i=[k];function r(y,m){return s(),a("div",null,i)}const _=n(l,[["render",r],["__file","encdec6.html.vue"]]);export{_ as default};
