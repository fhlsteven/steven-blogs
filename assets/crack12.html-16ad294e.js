import{_ as n,o as s,c as a,a as p}from"./app-d9da1b6d.js";const t={},o=p(`<h1 id="tornado2ä¹‹licenceæš´åŠ›ç ´è§£" tabindex="-1"><a class="header-anchor" href="#tornado2ä¹‹licenceæš´åŠ›ç ´è§£" aria-hidden="true">#</a> Tornado2ä¹‹Licenceæš´åŠ›ç ´è§£</h1><blockquote><p>æ—¥æœŸï¼š2003å¹´6æœˆ8æ—¥ ä½œè€…ï¼š1212 äººæ°”ï¼š 280</p></blockquote><p>Tornado2æ˜¯VxWorkså¼€å‘è°ƒè¯•å·¥å…·,è¯•ç”¨æœŸä¸ºä¸€ä¸ªæœˆ.<br> è¶…è¿‡è¯•ç”¨æœŸéœ€è¦Licenceæ”¯æŒ,ä¸€ä¸ªLicenceéœ€è¦<code>$6000~$2000</code>.ä¹°äº†è½¯ä»¶,è¿˜è¦èŠ±é’±,çœŸæ˜¯<code>!@#$%^&amp;*</code>.</p><p>ç ´è§£å¦‚ä¸‹,å¸Œæœ›å¯¹å¤§å®¶æœ‰ç”¨. ğŸ˜ƒ</p><h2 id="_1-è·Ÿè¸ª" tabindex="-1"><a class="header-anchor" href="#_1-è·Ÿè¸ª" aria-hidden="true">#</a> 1.è·Ÿè¸ª</h2><p>Tornado2çš„Licenceç¨‹åºä¸»è¦è¿è¡Œåœ¨ ...\\host\\x86-win32\\bin\\tgtsvr.exe(...ä¸ºTornado2å®‰è£…ç›®å½•)</p><p>ç»è¿‡ç—›è‹¦çš„è·Ÿè¸ªè¿‡ç¨‹,å‘ç°008B5236å¤„ä¸ºåˆ¤æ–­é‰´æƒæ˜¯å¦æˆåŠŸ(è¯¥åœ°å€æ˜¯åœ¨NT4.0+SP5.0ä¸­,å¯èƒ½ç³»ç»Ÿä¸ä¸€æ ·,åœ°å€ä¼šä¸ä¸€æ ·).è·Ÿè¸ªè¿‡ç¨‹å°±ä¸å†™äº†å§.å¤§å®¶éƒ½æ˜¯é«˜æ‰‹,æˆ‘çš„è·Ÿè¸ªè¿‡ç¨‹å†™å‡ºæ¥,å¤§å®¶ä¼šç¬‘è¯çš„.</p><p>åœ¨è·Ÿè¸ªè¿‡ç¨‹ä¸­,æˆ‘çŠ¯äº†å¾ˆå¤šæ„šè ¢çš„é”™è¯¯,ç”šè‡³æ­»äº†å¾ˆå¤šæ¬¡.åæ¥å‘ç°éƒ½æ˜¯å¯ä»¥é¿å…çš„.</p><p>008B5236å‰æœ‰ä¸€ç³»åˆ—CALL,æ˜¯è¿›è¡Œè®¡ç®—çš„.æˆ‘æ›¾è·Ÿè¿›å»,ä½†å‘ç°æ˜¯å¯èƒ½ä¸€ä¸ªDLL.è¯¥å…¬å¸ç”¨ä¸€ä¸ªDLLè¿›è¡Œè¿ç®—,æˆ‘æ˜¯ä¸èƒ½é€šè¿‡ç®—æ³•ç ´è§£äº†,åªå¥½æš´åŠ›ç ´è§£.</p><p>å†™ç ´è§£ä»£ç å¯èƒ½å¯¹å¤§å®¶æœ‰ä¸€äº›ä½œç”¨,æˆ‘å°†è¯¦ç»†ä»‹ç».</p><h2 id="_2-ç ´è§£æ€è·¯" tabindex="-1"><a class="header-anchor" href="#_2-ç ´è§£æ€è·¯" aria-hidden="true">#</a> 2.ç ´è§£æ€è·¯</h2><p>è¯¥ç¨‹åºæ˜¯é€šè¿‡åŠ å£³çš„,å£³æ¯”è¾ƒå¥‡æ€ª,æˆ‘å­¤é™‹å¯¡é—»,æ²¡æœ‰è§è¿‡.<br> æˆ‘çš„æƒ³æ³•æ˜¯,æˆ‘ä¹Ÿå¯ä»¥åœ¨ç¨‹åºä¸­åŠ å¤–å£³,å…ˆè·å¾—æ§åˆ¶ä¿®æ”¹ä»£ç ,åœ¨åŸæ¥å£³ç»“æŸæ—¶,ä½œè·³è½¬åˆ°æˆ‘çš„ä¿®æ”¹ä»£ç .<br> åŸæ¥ç¨‹åºå…¥å£æ˜¯00426DF5,åŸæ¥å£³çš„ç»“æŸä½ç½®æ˜¯00426F33.</p><p>1)å°†ç¨‹åºçš„å…¥å£åœ°å€æ”¹ä¸º00400300</p><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>mov        ebx,426F33h
mov        dword ptr [ebx],0FD93C8E9h
add        ebx,4
mov        byte ptr [ebx],0FFh
jmp        00426DF5
//ä»¥ä¸Šä¸ºå°†00426F33æ”¹ä¸ºjmp 1111.
1111.ä¸ºè‡ªå·±ä»£ç åœ°å€
push        ebx
mov        ebx,426F33h
mov        dword ptr [ebx],535BD0FFh
add        ebx,4
mov        byte ptr [ebx],81h
//ä»¥ä¸Šä¸ºå°†00426F33æ”¹ä¸º
{
    00426F33 FF D0               call        eax
    00426F35 5B                  pop         ebx
    00426F36 53                  push        ebx
    00426F37 81 EB 2E 0D 00 00   sub         ebx,0D2Eh
}
mov        ebx,eax
add        ebx,0E10Ah
mov        dword ptr [ebx],7DEBC033h
//ä»¥ä¸Šå°†ç¨‹åºæ”¹æˆé‰´æƒæˆåŠŸ
{
    008B5236 33 C0                xor        eax, eax
    008B5238 EB 7D                jmp        008B52B5
}
sub        ebx, 0B7h//ebx=008B517F
mov        word ptr [ebx],xxxx
//ä»¥ä¸Šå°†ç¨‹åºæ”¹æˆ98ä¸‹è·³åˆ°NTä»£ç ä¸­æ‰§è¡Œ
{
    008B517F jmp 008B51C5
}
pop        ebx
jmp        00426F33
</code></pre></div><h2 id="å¤–å£³ç¨‹åºè¯¦ç»†è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#å¤–å£³ç¨‹åºè¯¦ç»†è¯´æ˜" aria-hidden="true">#</a> å¤–å£³ç¨‹åºè¯¦ç»†è¯´æ˜</h2><p>1)æ”¹å˜ç¨‹åºçš„å…¥å£åœ°å€åˆ°è‡ªå·±ä»£ç ,åœ¨è‡ªå·±ä»£ç åœ°æ–¹å†™è·³è½¬ä»£ç .è¯¥è·³è½¬ä»£ç å°†00426F33å¤„ç¨‹åºæ”¹æˆjmp xxxx.</p><p>åœ¨è¯¥é¡¹æ“ä½œä¸­,éœ€è¦å–ç¡¬ç›˜åºåˆ—å·,ä¸jmp xxxxçš„æœºå™¨ç åšxorè¿ç®—.<br> å–ç¡¬ç›˜åºåˆ—å·ä½¿ç”¨LoadLibrary,GetProcAddresså’ŒGetVolumeInformationA.<br> å…¶ä¸­LoadLibraryå’ŒGetProcAddressçš„å‡½æ•°åœ°å€éœ€è¦æŸ¥åŸæ¥ç¨‹åºåœ°å€.</p><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>LoadLibrary = 00426FD0
GetProcAddress = 00426FCA
CALL xxxx = E8 + åç§»(4ä½)
</code></pre></div><p>2)åœ¨ä¸Šé¢çš„jmp xxxxçš„xxxxåœ°æ–¹å¤„å†™ä»£ç ,æ”¹å˜ç¨‹åºçš„è¿è¡Œè·¯å¾„.</p><p>éœ€è¦æœ‰å¦‚ä¸‹å‡ ä¸ªå…·ä½“æ“ä½œ:</p><p>(1)å°†00426F33å¤„è¿˜åŸ<br> (2)æ”¹ç¨‹åºä¸º98ä¸‹ä¹Ÿåˆ°NTä»£ç ä¸­æ‰§è¡Œ<br> (3)è¯¥ç¨‹åºä¸ºé‰´æƒæˆåŠŸ</p><p>3)éœ€è¦çš„å›ºå®šæ•°æ®:</p><p>&#39;KERNEL32.DLL&#39;, 0 //13 BYTES,LoadLibraryAç”¨<code>&#39;GetVolumeInformationA&#39;, 0 //22 BYTES,GetProcAddress</code>ç”¨<code>&#39;C:\\&#39;, 0 //4 BYTES, GetVolumeInformationA</code>ç”¨ æ€»å…±<code>0x27 = 39ä¸ªBYTE</code>å› æ­¤æ•°æ®ä»<code>400300</code>å¼€å§‹,ä»£ç ä»<code>00400330</code>å¼€å§‹.</p><h3 id="å¤–å£³ç¨‹åºå®ç°" tabindex="-1"><a class="header-anchor" href="#å¤–å£³ç¨‹åºå®ç°" aria-hidden="true">#</a> å¤–å£³ç¨‹åºå®ç°</h3><p>1)å°†å‡ ä¸ªå›ºå®šæ•°æ®å†™è¿›æ–‡ä»¶ä¸­:</p><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>Raw Address = 0x300
00400300    &#39;KERNEL32.DLL&#39;, 0
0040030D    &#39;GetVolumeInformationA&#39;, 0
00400323    &#39;C:\\&#39;, 0
00400327    4 BYTE æ•°æ®
0040032B    0
</code></pre></div><p>2)å†™è·³è½¬ä»£ç ,å°†00426F33å¤„ç¨‹åºæ”¹æˆ</p><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>jmp xxxx, Raw Address = 0x330
00400330
00400330 55                  push        ebp
00400331 8B EC                mov        ebp,esp
00400333 83 EC 30            sub        esp,70h  ;å®é™…ä½¿ç”¨0x22 BYTE
00400336 68 00 03 40 00      push        400300h  ;&#39;KERNEL32.DLL&#39;
0040033B E8 90 6C 02 00      call        426FD0h;LoadLibraryA
00400341 68 0D 03 40 00      push        40030Dh  ;&#39;GetVolumeInformationA&#39;
00400346 50                  push        eax      ;hModule
00400347 E8 7F 6C 02 00      call        426FCAh;GetProcAddress
0040034B 6A 0A                push        0Ah      ;sizeof(lpFileSystemNameBuffer)
0040034D 8D 5D D8            lea        ebx,[ebp-28h]
00400350 53                  push        ebx
00400351 8D 5D D0            lea        ebx,[ebp-30h]
00400354 53                  push        ebx
00400355 8D 5D E4            lea        ebx,[ebp-1Ch]
00400358 53                  push        ebx
00400359 8D 5D E8            lea        ebx,[ebp-18h]
0040035C 53                  push        ebx
0040035D 6A 0C                push        0Ch
0040035F 8D 5D F0            lea        ebx,[ebp-10h]
00400362 53                  push        ebx
00400363 68 23 03 40 00      push        400323
00400368 FF D0                call        eax
0040036A 8B 45 E8            mov        eax,dword ptr [ebp-18h];VolumeSerialNumber
0040036D BB 27 03 40 00      mov        ebx,400327h
00400372 33 03                xor        eax,dword ptr [ebx]
00400374 BB 33 6F 42 00      mov        ebx,426F33h
00400379 89 03                mov        dword ptr [ebx],eax
0040037B 83 C3 04            add        ebx,4
0040037E C6 03 FF            mov        byte ptr [ebx],0FFh;åŸæ¥æ˜¯E9 54 94 FD FF jmp 0040038D
00400381 83 C4 70            add        esp,70h
00400384 8B E5                mov        esp,ebp
00400386 5D                  pop        ebp
00400387 E9 69 6A 02 00      jmp        00426DF5;è·³è½¬ä»£ç å®Œæˆ
0040038C
0040038C 53                  push        ebx
0040038D BB 33 6F 42 00      mov        ebx,426F33h
00400392 C7 03 FF D0 5B 53    mov        dword ptr [ebx],535BD0FFh
00400398 83 C3 04            add        ebx,4
0040039B C6 03 81            mov        byte ptr [ebx],81h
0040039E 8B D8                mov        ebx,eax
004003A0 81 C3 0A E1 00 00    add        ebx,0E10Ah
004003A6 C7 03 33 C0 EB 7D    mov        dword ptr [ebx],7DEBC033h
004003AC 81 EB B7 00 00 00    sub        ebx,0B7h
004003B2 66 C7 03 EB 44      mov        word ptr [ebx],44EBh
004003B7 5B                  pop        ebx
004003B8 E9 76 6B 02 00      jmp        00426F33
004003BD
</code></pre></div><h3 id="å®éªŒæ•°æ®" tabindex="-1"><a class="header-anchor" href="#å®éªŒæ•°æ®" aria-hidden="true">#</a> å®éªŒæ•°æ®</h3><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>VolumeSerialNumber = 0x283a1709
E9 54 94 FD ^ VolumeSerialNumber = 0xd5ae43e0
</code></pre></div><p>å…¶ä¸­çš„GetVolumeInformationAå’Œå˜åŒ–æ•°æ®,ä¸æ˜¯å¿…é¡»çš„.åœ¨å†™è¿™ä¸€æ®µä»£ç æ—¶,ä¸èƒ½å°†ä»–æ”¾åˆ°åŸæ¥çš„ä»£ç å—ä¸­,æˆ‘æ›¾ç»æ”¾è¿‡,ä½†ç¨‹åºè¿è¡Œæ­»äº†.å¯èƒ½æœ‰å…¶ä»–æ£€æŸ¥,ä½†ç¨‹åºæ­»çš„æ—¶å€™,å †æ ˆå·²ç»è¢«ç ´åäº†,æˆ‘æ— æ³•å®šä½,ä¸çŸ¥å“ªä½èƒ½æŒ‡ç‚¹?</p><h2 id="_3-cä»£ç " tabindex="-1"><a class="header-anchor" href="#_3-cä»£ç " aria-hidden="true">#</a> 3.Cä»£ç </h2><div class="language-c" data-ext="c"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;windows.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;shlobj.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;resource.h&quot;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">OPEN_ERROR</span>          <span class="token expression"><span class="token operator">-</span><span class="token number">1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">READ_ERROR</span>          <span class="token expression"><span class="token operator">-</span><span class="token number">2</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WRITE_ERROR</span>        <span class="token expression"><span class="token operator">-</span><span class="token number">3</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">FILE_ERROR</span>          <span class="token expression"><span class="token operator">-</span><span class="token number">4</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NO_KEY</span>              <span class="token expression"><span class="token operator">-</span><span class="token number">5</span></span></span>

<span class="token keyword">int</span> <span class="token function">WriteCrack</span><span class="token punctuation">(</span>HANDLE hFile<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    DWORD dwWrited<span class="token punctuation">;</span>
<span class="token comment">//1.å†™å…¥å£</span>
    <span class="token function">SetFilePointer</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> FILE_BEGIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
    DWORD dwEntry <span class="token operator">=</span> <span class="token number">0x330</span><span class="token punctuation">;</span>
    <span class="token function">WriteFile</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwEntry<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwWrited<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//2.å†™å›ºå®šæ•°æ®</span>
    LPTSTR tt <span class="token operator">=</span> <span class="token function">MAKEINTRESOURCE</span><span class="token punctuation">(</span>IDR_CRACKDATA1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    HRSRC hRsrc <span class="token operator">=</span> <span class="token function">FindResource</span><span class="token punctuation">(</span><span class="token function">GetModuleHandle</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">MAKEINTRESOURCE</span><span class="token punctuation">(</span>IDR_CRACKDATA1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;CRACKDATA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    HGLOBAL hGlobal <span class="token operator">=</span> <span class="token function">LoadResource</span><span class="token punctuation">(</span><span class="token function">GetModuleHandle</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hRsrc<span class="token punctuation">)</span><span class="token punctuation">;</span>
    LPVOID lpData <span class="token operator">=</span> <span class="token function">LockResource</span><span class="token punctuation">(</span>hGlobal<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">SetFilePointer</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> <span class="token number">0x300</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> FILE_BEGIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">WriteFile</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> lpData<span class="token punctuation">,</span> <span class="token number">0xc0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwWrited<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//3.å†™å˜åŒ–æ•°æ®</span>
    DWORD dwChangeData <span class="token operator">=</span> <span class="token number">0xfd9454e9</span><span class="token punctuation">;</span><span class="token comment">//E9 54 94 FD</span>
    BYTE lpRootPathName<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;c:\\\\&quot;</span><span class="token punctuation">;</span> <span class="token comment">//å–Cç›˜çš„åºåˆ—å·</span>
    BYTE lpVolumeNameBuffer<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//ç£ç›˜å·æ ‡</span>
    DWORD nVolumeNameSize <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
    DWORD VolumeSerialNumber<span class="token punctuation">;</span><span class="token comment">//ç£ç›˜åºåˆ—å·</span>
    DWORD MaximumComponentLength<span class="token punctuation">;</span>
    BYTE lpFileSystemNameBuffer<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    DWORD nFileSystemNameSize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>
    DWORD FileSystemFlags<span class="token punctuation">;</span>
    <span class="token function">GetVolumeInformation</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>lpRootPathName<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>lpVolumeNameBuffer<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> nVolumeNameSize<span class="token punctuation">,</span>
        <span class="token operator">&amp;</span>VolumeSerialNumber<span class="token punctuation">,</span> <span class="token operator">&amp;</span>MaximumComponentLength<span class="token punctuation">,</span>
        <span class="token operator">&amp;</span>FileSystemFlags<span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>lpFileSystemNameBuffer<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> nFileSystemNameSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
    dwChangeData <span class="token operator">^=</span> VolumeSerialNumber<span class="token punctuation">;</span>
    <span class="token function">SetFilePointer</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> <span class="token number">0x327</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> FILE_BEGIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">WriteFile</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwChangeData<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwWrited<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">WriteCrackData</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> szFileName<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    HANDLE hFile <span class="token operator">=</span> <span class="token function">CreateFile</span><span class="token punctuation">(</span>szFileName<span class="token punctuation">,</span> GENERIC_READ <span class="token operator">|</span> GENERIC_WRITE<span class="token punctuation">,</span> FILE_SHARE_READ<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
        OPEN_EXISTING<span class="token punctuation">,</span> FILE_ATTRIBUTE_NORMAL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>hFile <span class="token operator">==</span> INVALID_HANDLE_VALUE<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">&quot;Please quit TornadoII program!\\r\\n&quot;</span>
            <span class="token string">&quot;Ensure not any program lock TornadoII resource!&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Warnning&quot;</span><span class="token punctuation">,</span> MB_OK <span class="token operator">|</span> MB_ICONHAND<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> OPEN_ERROR<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">//è¯»æ•°æ®,åˆ¤æ–­è¯¥æ–‡ä»¶æ˜¯å¦å¯å†™</span>
    <span class="token function">SetFilePointer</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> FILE_BEGIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
    DWORD dwEntry<span class="token punctuation">;</span>
    DWORD dwReaded<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">ReadFile</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwEntry<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwReaded<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">&quot;Please quit TornadoII program!\\r\\n&quot;</span>
            <span class="token string">&quot;Ensure not any program lock TornadoII resource!&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Warnning&quot;</span><span class="token punctuation">,</span> MB_OK <span class="token operator">|</span> MB_ICONHAND<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> READ_ERROR<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>dwEntry <span class="token operator">!=</span> <span class="token number">0x330</span><span class="token punctuation">)</span><span class="token comment">//è‡ªå·±å†™çš„å…¥å£</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>dwEntry <span class="token operator">!=</span> <span class="token number">0x26df5</span><span class="token punctuation">)</span><span class="token comment">//åŸæœ¬çš„ç¨‹åºå…¥å£</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">&quot;TornadoII maybe infected by virus!\\r\\nRun the patch maybe destroy TornadoII!\\r\\n&quot;</span>
                <span class="token string">&quot;If you want continue,press OK,CANCEL to quit!\\r\\nDo you want continue?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Warnning&quot;</span><span class="token punctuation">,</span> MB_OKCANCEL <span class="token operator">|</span> MB_ICONHAND<span class="token punctuation">)</span>
                <span class="token operator">==</span> IDCANCEL<span class="token punctuation">)</span>
                <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> FILE_ERROR<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">WriteCrack</span><span class="token punctuation">(</span>hFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">WriteBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    HKEY hKey<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">RegOpenKey</span><span class="token punctuation">(</span>HKEY_CURRENT_USER<span class="token punctuation">,</span> <span class="token string">&quot;TNT TornadoII Patch1&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>hKey<span class="token punctuation">)</span>
        <span class="token operator">!=</span> ERROR_SUCCESS<span class="token punctuation">)</span>
        <span class="token keyword">return</span> NO_KEY<span class="token punctuation">;</span>

    <span class="token keyword">char</span> szFileName<span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>szFileName<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">long</span> length <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span> 
    DWORD FileAttribute <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    BYTE FileTime<span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
    <span class="token function">memset</span><span class="token punctuation">(</span>FileTime<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>BYTE<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    DWORD dwLength<span class="token punctuation">;</span> 

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">RegQueryValue</span><span class="token punctuation">(</span>hKey<span class="token punctuation">,</span> <span class="token string">&quot;Path&quot;</span><span class="token punctuation">,</span> szFileName<span class="token punctuation">,</span> <span class="token operator">&amp;</span>length<span class="token punctuation">)</span> 
        <span class="token operator">!=</span> ERROR_SUCCESS<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span> 
        <span class="token function">RegCloseKey</span><span class="token punctuation">(</span>hKey<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token keyword">return</span> NO_KEY<span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> 
    dwLength <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> 
    DWORD type<span class="token punctuation">;</span> 
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">RegQueryValueEx</span><span class="token punctuation">(</span>hKey<span class="token punctuation">,</span> <span class="token string">&quot;Attribute&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>type<span class="token punctuation">,</span> <span class="token punctuation">(</span>BYTE<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>FileAttribute<span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwLength<span class="token punctuation">)</span> 
        <span class="token operator">!=</span> ERROR_SUCCESS<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span> 
        <span class="token function">RegCloseKey</span><span class="token punctuation">(</span>hKey<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token keyword">return</span> NO_KEY<span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> 
    dwLength <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span> 
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">RegQueryValueEx</span><span class="token punctuation">(</span>hKey<span class="token punctuation">,</span> <span class="token string">&quot;Time&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>type<span class="token punctuation">,</span> FileTime<span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwLength<span class="token punctuation">)</span> 
        <span class="token operator">!=</span> ERROR_SUCCESS<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span> 
        <span class="token function">RegCloseKey</span><span class="token punctuation">(</span>hKey<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token keyword">return</span> NO_KEY<span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> 
    FILETIME<span class="token operator">*</span> temp <span class="token operator">=</span> <span class="token punctuation">(</span>FILETIME<span class="token operator">*</span><span class="token punctuation">)</span>FileTime<span class="token punctuation">;</span> 
    FILETIME CreateTime<span class="token punctuation">;</span> 
    CreateTime <span class="token operator">=</span> <span class="token operator">*</span>temp<span class="token punctuation">;</span> 
    temp <span class="token operator">++</span><span class="token punctuation">;</span> 
    FILETIME LastAccessTime<span class="token punctuation">;</span> 
    LastAccessTime <span class="token operator">=</span> <span class="token operator">*</span>temp<span class="token punctuation">;</span> 
    temp <span class="token operator">++</span><span class="token punctuation">;</span> 
    FILETIME LastWriteTime<span class="token punctuation">;</span> 
    LastWriteTime <span class="token operator">=</span> <span class="token operator">*</span>temp<span class="token punctuation">;</span> 

    HANDLE hFile <span class="token operator">=</span> <span class="token function">CreateFile</span><span class="token punctuation">(</span>szFileName<span class="token punctuation">,</span> GENERIC_READ <span class="token operator">|</span> GENERIC_WRITE<span class="token punctuation">,</span> FILE_SHARE_READ<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> 
        OPEN_EXISTING<span class="token punctuation">,</span> FILE_ATTRIBUTE_NORMAL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">if</span><span class="token punctuation">(</span>hFile <span class="token operator">==</span> INVALID_HANDLE_VALUE<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span> 
        <span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">&quot;Please quit TornadoII program!\\r\\n&quot;</span> 
            <span class="token string">&quot;Ensure not any program lock TornadoII resource!&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Warnning&quot;</span><span class="token punctuation">,</span> MB_OK <span class="token operator">|</span> MB_ICONHAND<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token keyword">return</span> OPEN_ERROR<span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> 
<span class="token comment">//è¯»æ•°æ®,åˆ¤æ–­è¯¥æ–‡ä»¶æ˜¯å¦å¯å†™</span>
    <span class="token function">SetFilePointer</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> FILE_BEGIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
    DWORD dwEntry<span class="token punctuation">;</span>
    DWORD dwReaded<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">ReadFile</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwEntry<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwReaded<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token operator">==</span> FALSE<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">&quot;Please quit TornadoII program!\\r\\n&quot;</span>
            <span class="token string">&quot;Ensure not any program lock TornadoII resource!&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Warnning&quot;</span><span class="token punctuation">,</span> MB_OK <span class="token operator">|</span> MB_ICONHAND<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> READ_ERROR<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>dwEntry <span class="token operator">!=</span> <span class="token number">0x330</span><span class="token punctuation">)</span><span class="token comment">//è‡ªå·±å†™çš„å…¥å£</span>
    <span class="token punctuation">{</span>
        <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> FILE_ERROR<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    DWORD dwWrited<span class="token punctuation">;</span>
<span class="token comment">//1.å†™å…¥å£</span>
    <span class="token function">SetFilePointer</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> FILE_BEGIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
    dwEntry <span class="token operator">=</span> <span class="token number">0x26df5</span><span class="token punctuation">;</span>
    <span class="token function">WriteFile</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwEntry<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwWrited<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//2.æ•°æ®</span>
    BYTE buffer<span class="token punctuation">[</span><span class="token number">0xc0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>BYTE<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0xc0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">SetFilePointer</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> <span class="token number">0x300</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> FILE_BEGIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">WriteFile</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> buffer<span class="token punctuation">,</span> <span class="token number">0xc0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>dwWrited<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">SetFileTime</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> <span class="token operator">&amp;</span>CreateTime<span class="token punctuation">,</span> <span class="token operator">&amp;</span>LastAccessTime<span class="token punctuation">,</span> <span class="token operator">&amp;</span>LastWriteTime<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hFile<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">RegDeleteKey</span><span class="token punctuation">(</span>hKey<span class="token punctuation">,</span> <span class="token string">&quot;Path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">RegCloseKey</span><span class="token punctuation">(</span>hKey<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">RegDeleteKey</span><span class="token punctuation">(</span>HKEY_CURRENT_USER<span class="token punctuation">,</span> <span class="token string">&quot;TNT TornadoII Patch1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">SetFileAttributes</span><span class="token punctuation">(</span>szFileName<span class="token punctuation">,</span> FileAttribute<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    
    <span class="token keyword">return</span> TRUE<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>

<span class="token keyword">int</span> WINAPI <span class="token function">WinMain</span><span class="token punctuation">(</span>HINSTANCE hInstance<span class="token punctuation">,</span> HINSTANCE hPrev<span class="token punctuation">,</span> LPSTR lpCmdLine<span class="token punctuation">,</span> <span class="token keyword">int</span> nShowCmd<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">WriteBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> TRUE<span class="token punctuation">)</span>
        <span class="token keyword">return</span> TRUE<span class="token punctuation">;</span>
    BROWSEINFO  bi<span class="token punctuation">;</span>
    ITEMIDLIST<span class="token operator">*</span> pidl<span class="token punctuation">;</span>
    <span class="token keyword">char</span>        path<span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bi<span class="token punctuation">.</span>hwndOwner <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    bi<span class="token punctuation">.</span>pidlRoot <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    bi<span class="token punctuation">.</span>pszDisplayName <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    bi<span class="token punctuation">.</span>lpszTitle <span class="token operator">=</span> <span class="token string">&quot;Please choose the path of TornadoII installed&quot;</span><span class="token punctuation">;</span>
    bi<span class="token punctuation">.</span>ulFlags <span class="token operator">=</span> BIF_BROWSEINCLUDEFILES<span class="token punctuation">;</span>
    bi<span class="token punctuation">.</span>lpfn <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    bi<span class="token punctuation">.</span>lParam <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    bi<span class="token punctuation">.</span>iImage <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    pidl <span class="token operator">=</span> <span class="token function">SHBrowseForFolder</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>bi<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">SHGetPathFromIDList</span><span class="token punctuation">(</span>pidl<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">char</span>        szFileName<span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
    <span class="token keyword">int</span>        length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span> 

    <span class="token keyword">if</span><span class="token punctuation">(</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> 
        <span class="token keyword">return</span> FALSE<span class="token punctuation">;</span> 

    <span class="token keyword">int</span>        temp<span class="token punctuation">;</span> 
    <span class="token keyword">char</span><span class="token operator">*</span>      szName <span class="token operator">=</span> <span class="token string">&quot;\\\\host\\\\x86-win32\\\\bin\\\\tgtsvr.exe&quot;</span><span class="token punctuation">;</span> 
    <span class="token function">memset</span><span class="token punctuation">(</span>szFileName<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>szFileName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">memcpy</span><span class="token punctuation">(</span>szFileName<span class="token punctuation">,</span> path<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    temp <span class="token operator">=</span> length<span class="token punctuation">;</span> 
    length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>szName<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>szFileName<span class="token punctuation">[</span>temp<span class="token punctuation">]</span><span class="token punctuation">,</span> szName<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span> 

    HANDLE hFile <span class="token operator">=</span> <span class="token function">CreateFile</span><span class="token punctuation">(</span>szFileName<span class="token punctuation">,</span> GENERIC_READ<span class="token punctuation">,</span> FILE_SHARE_READ<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> 
        OPEN_EXISTING<span class="token punctuation">,</span> FILE_ATTRIBUTE_NORMAL<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">if</span><span class="token punctuation">(</span>hFile <span class="token operator">==</span> INVALID_HANDLE_VALUE<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span> 
        <span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">&quot;Please quit TornadoII program!\\r\\n&quot;</span> 
            <span class="token string">&quot;Ensure not any program lock TornadoII resource!&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Warnning&quot;</span><span class="token punctuation">,</span> MB_OK <span class="token operator">|</span> MB_ICONHAND<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token keyword">return</span> FALSE<span class="token punctuation">;</span> 
    <span class="token punctuation">}</span> 

    BY_HANDLE_FILE_INFORMATION FileInfo<span class="token punctuation">;</span> 
    <span class="token function">GetFileInformationByHandle</span><span class="token punctuation">(</span>hFile<span class="token punctuation">,</span> <span class="token operator">&amp;</span>FileInfo<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">CloseHandle</span><span class="token punctuation">(</span>hFile<span class="token punctuation">)</span><span class="token punctuation">;</span> 

    DWORD FileAttribute <span class="token operator">=</span> FileInfo<span class="token punctuation">.</span>dwFileAttributes<span class="token punctuation">;</span> 
    BYTE FileTime<span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
    <span class="token function">memset</span><span class="token punctuation">(</span>FileTime<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>BYTE<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>FileTime<span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>FileInfo<span class="token punctuation">.</span>ftCreationTime<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>FILETIME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    length <span class="token operator">+=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>FILETIME<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>FileTime<span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>FileInfo<span class="token punctuation">.</span>ftLastAccessTime<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>FILETIME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    length <span class="token operator">+=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>FILETIME<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>FileTime<span class="token punctuation">[</span>length<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>FileInfo<span class="token punctuation">.</span>ftLastWriteTime<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>FILETIME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    length <span class="token operator">+=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>FILETIME<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    DWORD newAttribute <span class="token operator">=</span> FileAttribute <span class="token operator">&amp;</span> <span class="token number">0xfffffffe</span><span class="token punctuation">;</span> 
    <span class="token function">SetFileAttributes</span><span class="token punctuation">(</span>szFileName<span class="token punctuation">,</span> newAttribute<span class="token punctuation">)</span><span class="token punctuation">;</span> 


    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">WriteCrackData</span><span class="token punctuation">(</span>szFileName<span class="token punctuation">)</span> <span class="token operator">==</span> TRUE<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span> 
        HKEY hKey<span class="token punctuation">;</span> 
        <span class="token function">RegCreateKey</span><span class="token punctuation">(</span>HKEY_CURRENT_USER<span class="token punctuation">,</span> <span class="token string">&quot;TNT TornadoII Patch1&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>hKey<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token function">RegSetValue</span><span class="token punctuation">(</span>hKey<span class="token punctuation">,</span> <span class="token string">&quot;Path&quot;</span><span class="token punctuation">,</span> 
            REG_SZ<span class="token punctuation">,</span> szFileName<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>szFileName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token function">RegSetValueEx</span><span class="token punctuation">(</span>hKey<span class="token punctuation">,</span> <span class="token string">&quot;Attribute&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> REG_DWORD<span class="token punctuation">,</span> <span class="token punctuation">(</span>BYTE<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>FileAttribute<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token function">RegSetValueEx</span><span class="token punctuation">(</span>hKey<span class="token punctuation">,</span> <span class="token string">&quot;Time&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> REG_BINARY<span class="token punctuation">,</span> FileTime<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">MessageBox</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">&quot;TornadoII Patch1 is OK!\\r\\nYou can run me again when registered,\\r\\n&quot;</span> 
            <span class="token string">&quot;or press yes when you registed.\\r\\nHave you run TornadoII to register?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;OK!&quot;</span><span class="token punctuation">,</span> MB_YESNO<span class="token punctuation">)</span> <span class="token operator">==</span> IDYES<span class="token punctuation">)</span> 
        <span class="token punctuation">{</span> 
            <span class="token function">WriteBack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span> 

    <span class="token keyword">return</span> TRUE<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre></div><p>å…¶ä¸­çš„IDR_CRACKDATA1ä¸º:</p><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>00000000 4B 45 52 4E 45 4C 33 32 2E 44 4C 4C 00 47 65 74    //KERNEL32.DLL Ge
00000010 56 6F 6C 75 6D 65 49 6E 66 6F 72 6D 61 74 69 6F    //VolumeInformati
00000020 6E 41 00 43 3A 5C 00 00 00 00 00 00 00 00 00 00    //nA C:\\
00000030 55 8B EC 83 EC 30 68 00 03 40 00 E8 90 6C 02 00
00000040 68 0D 03 40 00 50 E8 7F 6C 02 00 6A 0A 8D 5D D8
00000050 53 8D 5D D0 53 8D 5D E4 53 8D 5D E8 53 6A 0C 8D
00000060 5D F0 53 68 23 03 40 00 FF D0 8B 45 E8 BB 27 03
00000070 40 00 33 03 BB 33 6F 42 00 89 03 83 C3 04 C6 03
00000080 FF 83 C4 70 8B E5 5D E9 69 6A 02 00 53 BB 33 6F
00000090 42 00 C7 03 FF D0 5B 53 83 C3 04 C6 03 81 8B D8
000000a0 81 C3 0A E1 00 00 C7 03 33 C0 EB 7D 81 EB B7 00
000000b0 00 00 66 C7 03 EB 44 5B E9 76 6B 02 00 00 00 00
</code></pre></div><h2 id="åè®°" tabindex="-1"><a class="header-anchor" href="#åè®°" aria-hidden="true">#</a> åè®°</h2><p>ä»Šå¹´7æœˆåº•ç ´è§£è¯¥è½¯ä»¶,åŸæ¥æƒ³ä¹°ç»™xxå…¬å¸.ä¸è¿‡åæ¥å¤±è´¥äº†.è¿™ä¹Ÿæ˜¯åŠ GeVolumeInformatinAçš„åŸå› .</p><p>å‰ä¸¤å¤©çœ‹åˆ°è´µè®ºå›ä¸Šä¸€ç¯‡æ–‡ç« ,æ·±æœ‰æ„Ÿè§¦.ç ´è§£åº”è¯¥æ˜¯ä¸€ä¸ªä¸šä½™çˆ±å¥½å§,å¸Œæœ›èƒ½å’Œå¤§å®¶äº¤ä¸ªæœ‹å‹.</p><p>è¿è¡Œè¯¥Patchç¨‹åºæ³¨æ„:</p><p>1.ä¿è¯æ‚¨å·²ç»å®‰è£…å¥½TornadoII,ä¸”TornadoIIçš„åº”ç”¨ç¨‹åºæ²¡æœ‰è¿è¡Œ.<br> 2.è¿è¡Œç¨‹åºpatch.<br> 3.é€‰æ‹©TornadoIIçš„å®‰è£…è·¯å¾„.<br> 4.å°†å‡ºç°å¦‚å›¾patch1OK.jpgæ‰€ç¤º,æ­¤æ—¶patch1å·²ç»æˆåŠŸ,è¿™æ—¶patch.exeå¯ä»¥æŒ‰å¦å…³é—­,æˆ–è€…ä¸å…³é—­,ç›´æ¥è¿è¡ŒTornadoIIè¿›è¡Œæ³¨å†Œ.<br> æ³¨æ„:ç°åœ¨ä¸€å®šä¸èƒ½é©¬ä¸ŠæŒ‰&quot;æ˜¯&quot;æŒ‰é’®.å¦‚æœæ‚¨æŒ‰ä¸‹,é‚£ä¹ˆåªå¥½ä»ç¬¬äºŒæ­¥é‡æ–°æ¥.<br> 5.æ³¨å†ŒTornadoIIå°†å‡ºç°å¦‚register.jpgæ‰€ç¤º,æ­¤æ—¶æ‚¨å¯ä»¥è¾“å…¥ä»»æ„çš„26ä¸ªæ•°å­—æˆ–å­—æ¯,å¯ä»¥æ•°å­—å’Œå­—æ¯æ··åˆ.æ³¨å†ŒæˆåŠŸå,å°†TornadoIIçš„åº”ç”¨ç¨‹åºé€€å‡º.<br> 6.å¦‚æœåˆšæ‰æ‚¨æ²¡æœ‰å…³é—­patch.exe,ç°åœ¨ç›´æ¥æŒ‰patch1OK.jpgæ‰€ç¤ºçš„&quot;æ˜¯&quot;æŒ‰é’®,TornadoIIå°†å®Œå…¨ç ´è§£.å¦‚æœæ‚¨åˆšæ‰å°†patch.exeæ¨å‡ºäº†, ç°åœ¨éœ€è¦é‡æ–°è¿è¡Œä»–.è¿™ä¸€æ­¥æˆåŠŸçš„æ ‡å¿—æ˜¯patch2OK.jpgæ‰€ç¤º.</p><p>æ³¨æ„:å¦‚æœæ‚¨çš„æ“ä½œç³»ç»Ÿæ˜¯98/95,åœ¨ç¬¬5æ­¥æ—¶å°†å‡ºç°å¦‚98.jpgæ‰€ç¤º(98.jpgä¸èƒ½è´´ä¸Šæ¥,è§è°…), æ­¤æ—¶å®é™…å·²ç»æ³¨å†ŒæˆåŠŸ.æ‚¨éœ€è¦å…³é—­TornadoIIçš„æ³¨å†Œç¨‹åº,æŒ‰ç…§ç¬¬å…­æ­¥çš„æŒ‡ç¤ºåš.å¦‚æœæ‚¨çš„æ“ä½œç³»ç»Ÿæ˜¯98/95,è€Œä¸”å·²ç»è¿‡æœŸäº†,è¯¥Patchæ— èƒ½ä¸ºåŠ›.åªå¥½é‡è£…ç³»ç»Ÿå’ŒTIIäº†.ğŸ˜¦</p><p>å“ˆå“ˆï¼Œè¿™ä¸ªæ˜‚è´µçš„å•†ä¸šè½¯ä»¶çš„ä¿æŠ¤è¯´ç©¿äº†å®åœ¨æ˜¯ä¸å€¼å¾—ä¸€æï¼</p><p>å®ƒæ˜¯ç”¨CrypkeyåŠ å£³çš„ï¼ˆwww.crypkey.com)ï¼Œè€ŒCrypkey Instantçš„é€šç”¨æ³¨å†Œæœºæ—©è¢«Duelist/COREå†™å‡ºæ¥äº†ï¼Œåœ¨Keygen Studioä¸Šå¯ä»¥å¾—åˆ°ï¼Œç”¨çš„RSAç®—æ³•ã€‚<br> è‡³äºè„±å£³ï¼Œæ›´æ˜¯ç®€å•å¾—ä¸å¾—äº†ï¼Œå†™ä¸ªProcDumpçš„scriptè‡ªåŠ¨æŠŠtgtsvr.exeè„±å£³å³å¯ï¼ˆå£³è°ƒç”¨cryp*.dllåˆ¤æ–­æ—¶é—´ï¼‰ï¼Œå¾—åˆ°çš„exeçš„import tableæœªåšä»»ä½•æ‰‹è„šï¼Œå¯ä»¥åœ¨å„ç§ç‰ˆæœ¬çš„32-bit windowsä¸Šè¿è¡Œï¼</p><p>æ‰€æœ‰ç”¨CrypkeyåŠ å£³çš„å¤§è½¯ä»¶å¦‚æ³•ç‚®åˆ¶ï¼</p><p>blowfish</p>`,45),e=[o];function c(u,l){return s(),a("div",null,e)}const i=n(t,[["render",c],["__file","crack12.html.vue"]]);export{i as default};
