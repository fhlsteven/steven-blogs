import{_ as n,o as s,c as a,a as t}from"./app-d9da1b6d.js";const p={},o=t(`<h1 id="å¦‚ä½•é€šè¿‡éœ€è¦ç”¨æˆ·è®¤è¯çš„smtpæœåŠ¡å™¨å‘é€email" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•é€šè¿‡éœ€è¦ç”¨æˆ·è®¤è¯çš„smtpæœåŠ¡å™¨å‘é€email" aria-hidden="true">#</a> å¦‚ä½•é€šè¿‡éœ€è¦ç”¨æˆ·è®¤è¯çš„SMTPæœåŠ¡å™¨å‘é€Email</h1><p>åœ¨c#ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬å¯ä»¥ä½¿ç”¨System.Web.Mailä¸‹çš„MailMessageæ¥å‘é€Email:</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>Mail</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SendMail</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token class-name">MailMessage</span> Msg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MailMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Msg<span class="token punctuation">.</span>To      <span class="token operator">=</span> <span class="token string">&quot;xxx@xxx.com&quot;</span><span class="token punctuation">;</span>
  Msg<span class="token punctuation">.</span>Subject <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
  Msg<span class="token punctuation">.</span>Body    <span class="token operator">=</span> <span class="token string">&quot;Testing Email&quot;</span><span class="token punctuation">;</span>
  Msg<span class="token punctuation">.</span>From<span class="token operator">=</span><span class="token string">&quot;xxx@xxx.com&quot;</span><span class="token punctuation">;</span>
  SmtpMail<span class="token punctuation">.</span>SmtpServer<span class="token operator">=</span><span class="token string">&quot;smtp.netease.com&quot;</span><span class="token punctuation">;</span> <span class="token comment">//&lt;&lt;===æ³¨æ„è¿™ä¸ªåœ°å€</span>
  SmtpMail<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>Msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä½†äº‹å®ä¸Šä¸Šé¢çš„ä»£ç æ— æ³•æ­£å¸¸å·¥ä½œï¼ŒåŸå› åœ¨äºsmtp.netease.comè¦æ±‚ç”¨æˆ·è®¤è¯ï¼Œè€Œä¸€å¼€å§‹æˆ‘å‘ç°SmtpMailåªèƒ½ä½¿ç”¨å…è®¸åŒ¿åç”¨æˆ·çš„smtpæœåŠ¡å™¨ï¼ˆæƒ³æƒ³ç°åœ¨è¿˜æœ‰æ”¯æŒåŒ¿åè®¿é—®çš„smtpæœåŠ¡å™¨å—ï¼Ÿéƒ½æ˜¯è¯¥æ­»çš„åƒåœ¾é‚®ä»¶å®³çš„ ğŸ˜ƒ )ã€‚æˆ‘æŸ¥äº†ä¸€ä¸‹èµ„æ–™ï¼Œå‘ç°åœ¨c#ä¸­æˆ‘ä»¬ä»ç„¶éœ€è¦é€šè¿‡è°ƒç”¨COM(CDO for Windows 2000)æ¥å®Œæˆç”¨æˆ·è®¤è¯çš„åŠŸèƒ½ã€‚</p><p>ä¸‹é¢æ˜¯æµ‹è¯•ä»£ç , æµ‹è¯•é€šè¿‡ï¼šVS.NET+Win2k Prof.</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token comment">//åœ¨referenceä¸­æ·»åŠ CDO for Windows 2000</span>
<span class="token keyword">using</span> <span class="token namespace">CDO</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SendEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token keyword">try</span>
   <span class="token punctuation">{</span>
    <span class="token class-name">Configuration</span> conf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ConfigurationClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    conf<span class="token punctuation">.</span>Fields<span class="token punctuation">[</span>CdoConfiguration<span class="token punctuation">.</span>cdoSendUsingMethod<span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token operator">=</span>CdoSendUsing<span class="token punctuation">.</span>cdoSendUsingPort<span class="token punctuation">;</span>
    conf<span class="token punctuation">.</span>Fields<span class="token punctuation">[</span>CdoConfiguration<span class="token punctuation">.</span>cdoSMTPServer<span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token operator">=</span><span class="token string">&quot;smtp.netease.com&quot;</span><span class="token punctuation">;</span>
    conf<span class="token punctuation">.</span>Fields<span class="token punctuation">[</span>CdoConfiguration<span class="token punctuation">.</span>cdoSMTPServerPort<span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">;</span>
    conf<span class="token punctuation">.</span>Fields<span class="token punctuation">[</span>CdoConfiguration<span class="token punctuation">.</span>cdoSMTPAccountName<span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token operator">=</span><span class="token string">&quot;hydnoahark&quot;</span><span class="token punctuation">;</span>
    conf<span class="token punctuation">.</span>Fields<span class="token punctuation">[</span>CdoConfiguration<span class="token punctuation">.</span>cdoSendUserReplyEmailAddress<span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token operator">=</span><span class="token string">&quot;\\&quot;hydnoahark\\&quot; &lt;hydnoahark@netease.com&gt;&quot;</span><span class="token punctuation">;</span>
    conf<span class="token punctuation">.</span>Fields<span class="token punctuation">[</span>CdoConfiguration<span class="token punctuation">.</span>cdoSendEmailAddress<span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token operator">=</span><span class="token string">&quot;\\&quot;hydnoahark\\&quot; &lt;hydnoahark@netease.com&gt;&quot;</span><span class="token punctuation">;</span>
    conf<span class="token punctuation">.</span>Fields<span class="token punctuation">[</span>CdoConfiguration<span class="token punctuation">.</span>cdoSMTPAuthenticate<span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token operator">=</span>CdoProtocolsAuthentication<span class="token punctuation">.</span>cdoBasic<span class="token punctuation">;</span>
    conf<span class="token punctuation">.</span>Fields<span class="token punctuation">[</span>CdoConfiguration<span class="token punctuation">.</span>cdoSendUserName<span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token operator">=</span><span class="token string">&quot;hydnoahark&quot;</span><span class="token punctuation">;</span>
    conf<span class="token punctuation">.</span>Fields<span class="token punctuation">[</span>CdoConfiguration<span class="token punctuation">.</span>cdoSendPassword<span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token operator">=</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">;</span>
    
    conf<span class="token punctuation">.</span>Fields<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">MessageClass</span> msg<span class="token operator">=</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">MessageClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    msg<span class="token punctuation">.</span>Configuration<span class="token operator">=</span>conf<span class="token punctuation">;</span>

    msg<span class="token punctuation">.</span>To<span class="token operator">=</span><span class="token string">&quot;hydnoahsark@sina.com&quot;</span><span class="token punctuation">;</span>
    msg<span class="token punctuation">.</span>Subject<span class="token operator">=</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">;</span>
    msg<span class="token punctuation">.</span>TextBody<span class="token operator">=</span><span class="token string">&quot;It&#39;s test&quot;</span><span class="token punctuation">;</span>
    msg<span class="token punctuation">.</span>From<span class="token operator">=</span><span class="token string">&quot;hydnoahark@netease.com&quot;</span><span class="token punctuation">;</span>

    msg<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
   <span class="token punctuation">}</span>
   <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices<span class="token punctuation">.</span>COMException</span> e<span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>OK, å°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œä¸çŸ¥é“å…¶ä»–äººæœ‰æ²¡æ›´å¥½çš„æ–¹æ³•ï¼Œå¯ä»¥çš„è¯ç»™æˆ‘ä¸€ä¸ªå»ºè®® ^_^</p>`,7),c=[o];function e(u,l){return s(),a("div",null,c)}const k=n(p,[["render",e],["__file","netcode29.html.vue"]]);export{k as default};
