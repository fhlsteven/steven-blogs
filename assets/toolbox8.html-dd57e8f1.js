import{_ as a,o as s,c as n,a as t}from"./app-f0851ed3.js";const e={},p=t(`<h1 id="net环境下水晶报表使用总结" tabindex="-1"><a class="header-anchor" href="#net环境下水晶报表使用总结" aria-hidden="true">#</a> .NET环境下水晶报表使用总结</h1><blockquote><p>你是第242位浏览该文章的人 不详 不详 2003-7-31</p></blockquote><p>水晶报表是一个优秀的报表开发工具，本人在开发通用管理系统的时候，所有报表都使用水晶报表，其简单、易用和强大的功能令笔者倍加喜爱，现将水晶报表使用手记呈现给大家。</p><h2 id="一、在使用自带的水晶报表时-请注册-否则只能使用30次" tabindex="-1"><a class="header-anchor" href="#一、在使用自带的水晶报表时-请注册-否则只能使用30次" aria-hidden="true">#</a> 一、在使用自带的水晶报表时，请注册，否则只能使用30次</h2><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>水晶报表注册码
注册号:6707437608
密码:AAP5GKS0000GDE100DS
</code></pre></div><h2 id="二、使用crystalreportviewer进行预览" tabindex="-1"><a class="header-anchor" href="#二、使用crystalreportviewer进行预览" aria-hidden="true">#</a> 二、使用CrystalReportViewer进行预览</h2><p>CrystalReportViewer控件允许在应用程序中查看 Crystal Report。ReportSource 属性用于设置要查看哪个报表。该属性设置之后，报表显示在查看器中。报表源可以是ReportDocument、报表文件的路径，也可以是强类型报表。</p><ol><li>打开“工具箱”，并将一个 CrystalReportViewer 拖到窗体上，我们命名为rptVew。</li><li>通过拖放操作将 Windows 窗体查看器调整到希望的大小并将其移动到所需位置。</li><li>当运行应用程序时，报表将显示在查看器中。</li></ol><h2 id="三、创建新报表" tabindex="-1"><a class="header-anchor" href="#三、创建新报表" aria-hidden="true">#</a> 三、创建新报表</h2><ol><li><p>指向“添加”，单击“添加新项”。</p></li><li><p>在“添加新项”对话框中，从“模板”区域选择 Crystal Report，将报表命名为rptClient，单击“打开”。</p></li><li><p>在 Crystal Report 库中，选择下列选项之一：</p><ul><li>使用报表专家 — 指导您完成报表的创建过程，并将您的选择添加到 Crystal Report Designer。</li><li>作为空白报表 — 打开 Crystal Report Designer。</li><li>来自于现有的报表 — 创建新报表，它与指定的另一报表设计相同。</li></ul><p>注意 Crystal Report 库包含许多专家，可以指导您完成数个特定类型报表的创建工作。您可能希望使用专家来创建最初的报表，以确定哪种报表构造方法适合您的需要。</p></li><li><p>单击“确定”按钮。</p></li></ol><p>如果选择使用“报表专家”，便会出现“报表专家”对话框，并带有数据资源管理器。为每个文件夹选择所需数据，完成“报表专家”选项卡界面上的操作，然后单击“完成”来访问 Crystal Report Designer 和您的报表</p><h2 id="四、是否需要动态设置数据源" tabindex="-1"><a class="header-anchor" href="#四、是否需要动态设置数据源" aria-hidden="true">#</a> 四、是否需要动态设置数据源？</h2><p>Crystal Reports 通过数据库驱动程序与数据库连接。每个驱动程序都被编写为可处理特定数据库类型或数据库访问技术。</p><h3 id="拉和推模型" tabindex="-1"><a class="header-anchor" href="#拉和推模型" aria-hidden="true">#</a> 拉和推模型</h3><p>为了向开发人员提供最灵活的数据访问方法，Crystal Reports 数据库驱动程序被设计为可同时提供数据访问的拉模型和推模型。</p><h3 id="拉模型" tabindex="-1"><a class="header-anchor" href="#拉模型" aria-hidden="true">#</a> 拉模型</h3><p>在拉模型中，驱动程序将连接到数据库并根据需要将数据“拉”进来。使用这种模型时，与数据库的连接和为了获取数据而执行的 SQL 命令都同时由 Crystal Reports 本身处理，不需要开发人员编写代码。如果在运行时无须编写任何特殊代码，则使用拉模型。</p><h3 id="推模型" tabindex="-1"><a class="header-anchor" href="#推模型" aria-hidden="true">#</a> 推模型</h3><p>相反，推模型需要开发人员编写代码以连接到数据库，执行 SQL 命令以创建与报表中的字段匹配的记录集或数据集，并且将该对象传递给报表。该方法使您可以将连接共享置入应用程序中，并在 Crystal Reports 收到数据之前先将数据筛选出来。</p><h2 id="四、从-ado-net-数据集制作报表" tabindex="-1"><a class="header-anchor" href="#四、从-ado-net-数据集制作报表" aria-hidden="true">#</a> 四、从 ADO.NET 数据集制作报表</h2><p>从数据库创建数据集对象</p><ol><li><p>在项目中新建一个架构文件：</p><p>a. 在解决方案资源管理器中，右击项目名，指向“添加”，然后单击“添加新项”。<br> b. 在“添加新项”对话框的“类别”区域，展开文件夹，然后选择“数据”。<br> c. 在“模板”区域选择“数据集”。<br> d. 接受默认名称 Dataset1.xsd。</p><p>这就创建了一个新的架构文件 (Dataset1.xsd)，以后将用它来生成强类型数据集。该架构文件将显示在 ADO.NET 数据集设计器中。</p></li><li><p>指定数据库位置：</p><p>a. 在服务器资源管理器中，右击“数据连接”并选择“添加连接”。<br> b. 在“数据链接属性”对话框中，单击“提供程序”选项卡，然后选择一个提供程序（例如 Microsoft OLE DB Provider for SQL Server）。<br> c. 单击“连接”选项卡，然后指定您的数据库所在位置。在所需位置输入服务器和登录信息。<br> d. 单击“确定”按钮。</p><p>此时，您的数据库及其表和字段就出现在服务器资源管理器的“数据连接”节点下面。</p></li><li><p>在解决方案资源管理器中，双击 Dataset1.xsd （如果它尚不是活动视图）。</p><p>Dataset1.xsd 现在应显示在“数据集”选项卡中。</p></li><li><p>若要为数据集建立架构，请将需要的表从服务器资源管理器中拖动到 Dataset1.xsd 的“数据集”选项卡上。</p></li><li><p>单击“保存 Dataset1.xsd”来保存“Dataset1.xsd”文件。</p></li><li><p>在“生成”菜单上，单击“生成”为项目生成数据集对象。</p></li></ol><p>ADO.NET 数据集对象提供数据的描述，从它可以向 Crystal report 添加表。使用 Crystal Report Designer 中的“数据库专家”从 ADO.NET 数据集对象添加表。</p><p>请在使用“报表专家”创建新报表时调用“数据库专家”。或者，要从一个已经使用 ADO.NET 建立好的报表中访问“数据库专家”，请在 Report Designer 中右击，指向“数据库”，然后单击“添加/删除数据库”。</p><p>将报表连接到 ADO.NET 数据集对象</p><ol><li><p>在“数据库专家”中，展开“项目数据”文件夹。</p></li><li><p>展开“ADO.NET 数据集”文件夹。</p></li><li><p>选择所需数据集对象。</p><p>例如，如果当时使用的是从项目“WindowsApplication1”的架构文件“Dataset1.xsd”中生成的数据集对象，则应该选择“WindowsApplication1.Dataset1”。</p></li><li><p>选择要向报表中添加的表，和使用其他数据源一样。</p></li></ol><h2 id="五、动态改变数据源的代码" tabindex="-1"><a class="header-anchor" href="#五、动态改变数据源的代码" aria-hidden="true">#</a> 五、动态改变数据源的代码</h2><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Dim</span> dsdataSet <span class="token keyword">As</span> <span class="token keyword">New</span> DataSet<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">Dim</span> oRpt <span class="token keyword">As</span> <span class="token keyword">New</span> rptClient<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">&#39;已建立的报表rptClient</span>
</code></pre></div><p>请读者自行填充数据集dsdataSet</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token comment">&#39;使用“报表引擎”对象模型将填充的数据集,传递给报表</span>

oRpt<span class="token punctuation">.</span>SetDataSource<span class="token punctuation">(</span>dsdataSet<span class="token punctuation">.</span>Tables<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">&#39; 将带有数据的报表对象绑定到 Windows 窗体查看器，rptVew（CrystalReportViewer控件）</span>

rptVew<span class="token punctuation">.</span>ReportSource <span class="token operator">=</span> oRpt
</code></pre></div><p>注意 FillDataSet 方法可连接到指定的数据库，提取数据，然后断开数据库连接。如果您希望将数据库中的多个表添加到报表中，请使用 SQL JOIN 语句将这些表联接在一起；然后在 FillDataSet 方法中指定一个结果表</p><h2 id="六、创建主从报表" tabindex="-1"><a class="header-anchor" href="#六、创建主从报表" aria-hidden="true">#</a> 六、创建主从报表</h2><p>在报表中，有许多报表是主从表结构，比如订单与订单商品明细，订单是一个表中的一条记录，而分录是另一个表中的多条记录，两个表通过一个字段关联起来，这种报表可利用其分组功能实现，</p><ol><li>新建一个工程</li><li>往FORM1中添加一个CrystalReportViewer控件</li><li>在服务噐资源管理器中连接到SQL SERVER 2000上的Northwind数据库</li><li>添加一个数据集Dataset1,将服务器资源管理器中的Orders和 Order Details加入到数据集中。</li><li>添加一个水晶报表，使用报表专家，在项目数据中选择“ADO.NET数据集”，插入表Orders和 Order Details，“链接”中是关联字段的链接，在“字段”中选择要显示的主表和明细表的字段，组中选择分组依据为Orders表OrdersID字段，总计，图表，选择（可进行筛选），样式（可设置报表标题），可自行设置。设置完后，点击完成。</li><li>在报表设计器中调整需要显示的字段的位置、宽度等。</li><li>在窗口中添加代码。</li></ol><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Form1_Load<span class="token punctuation">(</span><span class="token keyword">ByVal</span> sender <span class="token keyword">As</span> System<span class="token punctuation">.</span><span class="token keyword">Object</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> e <span class="token keyword">As</span> System<span class="token punctuation">.</span>EventArgs<span class="token punctuation">)</span> <span class="token keyword">Handles</span> <span class="token keyword">MyBase</span><span class="token punctuation">.</span>Load
<span class="token keyword">Dim</span> oRpt <span class="token keyword">As</span> <span class="token keyword">New</span> CrystalReport1<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">Dim</span> dsdataSet <span class="token keyword">As</span> <span class="token keyword">New</span> Dataset1<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">Dim</span> CN <span class="token keyword">As</span> <span class="token keyword">New</span> Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlConnection<span class="token punctuation">(</span><span class="token string">&quot;data source=PMSERVER;initial catalog=Northwind;user id=sa;password=sa&quot;</span><span class="token punctuation">)</span>
CN<span class="token punctuation">.</span>Open<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">Dim</span> daOrders <span class="token keyword">As</span> <span class="token keyword">New</span> Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlDataAdapter<span class="token punctuation">(</span><span class="token string">&quot;select * from orders&quot;</span><span class="token punctuation">,</span> CN<span class="token punctuation">)</span>
daOrders<span class="token punctuation">.</span>Fill<span class="token punctuation">(</span>dsdataSet<span class="token punctuation">,</span> <span class="token string">&quot;orders&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">Dim</span> daDetails <span class="token keyword">As</span> <span class="token keyword">New</span> Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlDataAdapter<span class="token punctuation">(</span><span class="token string">&quot;select * from [Order Details]&quot;</span><span class="token punctuation">,</span> CN<span class="token punctuation">)</span>
daDetails<span class="token punctuation">.</span>Fill<span class="token punctuation">(</span>dsdataSet<span class="token punctuation">,</span> <span class="token string">&quot;Order Details&quot;</span><span class="token punctuation">)</span>

<span class="token comment">&#39;使用“报表引擎”对象模型将填充的数据集,传递给报表</span>
oRpt<span class="token punctuation">.</span>SetDataSource<span class="token punctuation">(</span>dsdataSet<span class="token punctuation">)</span>
CrystalReportViewer1<span class="token punctuation">.</span>ReportSource <span class="token operator">=</span> oRpt

<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>8、运行程序</p><h2 id="七、用程序改变报表中text的文本" tabindex="-1"><a class="header-anchor" href="#七、用程序改变报表中text的文本" aria-hidden="true">#</a> 七、用程序改变报表中text的文本</h2><p>代码如下：</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Dim</span> GetTextObject <span class="token keyword">As</span> TextObject

<span class="token comment">&#39; 按名称获取 ReportObject，将其转换为 TextObject，并返回此对象。</span>
GetTextObject <span class="token operator">=</span> orpt<span class="token punctuation">.</span>ReportDefinition<span class="token punctuation">.</span>ReportObjects<span class="token punctuation">.</span>Item<span class="token punctuation">(</span><span class="token string">&quot;text13&quot;</span><span class="token punctuation">)</span>
GetTextObject<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;XXXX系统&quot;</span>
</code></pre></div><p>总结：水晶报表具有非常强大的功能，还可进行导出WORD、EXCEL、RTF等文件，还可生成复杂、漂亮图表，是进行WEB和WINDOWS报表开发的利器。</p>`,40),o=[p];function l(r,c){return s(),n("div",null,o)}const d=a(e,[["render",l],["__file","toolbox8.html.vue"]]);export{d as default};
