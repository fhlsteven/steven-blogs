import{_ as n,o as s,c as a,a as t}from"./app-f0851ed3.js";const p={},o=t(`<h1 id="读写注册表" tabindex="-1"><a class="header-anchor" href="#读写注册表" aria-hidden="true">#</a> 读写注册表</h1><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token comment">//首先包含如下引用</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Win32</span><span class="token punctuation">;</span>

<span class="token comment">//写注册表</span>
<span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SaveSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">RegistryKey</span> SoftwareKey <span class="token operator">=</span> Registry<span class="token punctuation">.</span>LocalMachine<span class="token punctuation">.</span><span class="token function">OpenSubKey</span><span class="token punctuation">(</span><span class="token string">&quot;Software&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">RegistryKey</span> MovecontKey <span class="token operator">=</span> SoftwareKey<span class="token punctuation">.</span><span class="token function">CreateSubKey</span><span class="token punctuation">(</span><span class="token string">&quot;Movecont&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//建立</span>
    <span class="token class-name">RegistryKey</span> SelfPlaceKey <span class="token operator">=</span> MovecontKey<span class="token punctuation">.</span><span class="token function">CreateSubKey</span><span class="token punctuation">(</span><span class="token string">&quot;SelfPlace&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//建立</span>
    SelfPlaceKey<span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span><span class="token string">&quot;BackColor&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">object</span><span class="token punctuation">)</span>BackColor<span class="token punctuation">.</span><span class="token function">ToKnownColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//写</span>
    SelfPlaceKey<span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span><span class="token string">&quot;Red&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">object</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>BackColor<span class="token punctuation">.</span>R<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//红</span>
    SelfPlaceKey<span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span><span class="token string">&quot;Green&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">object</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>BackColor<span class="token punctuation">.</span>G<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//绿</span>
    SelfPlaceKey<span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span><span class="token string">&quot;Blue&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">object</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>BackColor<span class="token punctuation">.</span>B<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//蓝</span>
    SelfPlaceKey<span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span><span class="token string">&quot;Width&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">object</span><span class="token punctuation">)</span>Width<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//宽</span>
    SelfPlaceKey<span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span><span class="token string">&quot;Height&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">object</span><span class="token punctuation">)</span>Height<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//高</span>
    SelfPlaceKey<span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span><span class="token string">&quot;X&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">object</span><span class="token punctuation">)</span>DesktopLocation<span class="token punctuation">.</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//左上角X坐标</span>
    SelfPlaceKey<span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span><span class="token string">&quot;Y&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">object</span><span class="token punctuation">)</span>DesktopLocation<span class="token punctuation">.</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//左上角Y坐标</span>
    SelfPlaceKey<span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span><span class="token string">&quot;WindowState&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">object</span><span class="token punctuation">)</span>WindowState<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//左上角Y坐标</span>
<span class="token punctuation">}</span>

<span class="token comment">//读注册表</span>
<span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">ReadSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">RegistryKey</span> SoftwareKey <span class="token operator">=</span> Registry<span class="token punctuation">.</span>LocalMachine<span class="token punctuation">.</span><span class="token function">OpenSubKey</span><span class="token punctuation">(</span><span class="token string">&quot;Software&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">RegistryKey</span> MovecontKey <span class="token operator">=</span> SoftwareKey<span class="token punctuation">.</span><span class="token function">OpenSubKey</span><span class="token punctuation">(</span><span class="token string">&quot;Movecont&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//建立</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>MovecontKey <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token class-name">RegistryKey</span> SelfPlaceKey <span class="token operator">=</span> MovecontKey<span class="token punctuation">.</span><span class="token function">OpenSubKey</span><span class="token punctuation">(</span><span class="token string">&quot;SelfPlace&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//建立</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>SelfPlaceKey <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>listBoxMessages<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;成功打开注册表!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name"><span class="token keyword">int</span></span> Red <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>SelfPlaceKey<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token string">&quot;Red&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">int</span></span> Green <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>SelfPlaceKey<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token string">&quot;Green&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">int</span></span> Blue <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>SelfPlaceKey<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token string">&quot;Blue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    BackColor <span class="token operator">=</span> Color<span class="token punctuation">.</span><span class="token function">FromArgb</span><span class="token punctuation">(</span>Red<span class="token punctuation">,</span> Green<span class="token punctuation">,</span> Blue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>listBoxMessages<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;Backcolor Name:&quot;</span> <span class="token operator">+</span> BackColor<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name"><span class="token keyword">int</span></span> X <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>SelfPlaceKey<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token string">&quot;X&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">int</span></span> Y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>SelfPlaceKey<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token string">&quot;Y&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    DesktopLocation <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>listBoxMessages<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;Location:&quot;</span> <span class="token operator">+</span> DesktopLocation<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Width <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>SelfPlaceKey<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token string">&quot;Width&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Height <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>SelfPlaceKey<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token string">&quot;Height&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>listBoxMessages<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;Size:&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span><span class="token punctuation">(</span>Width<span class="token punctuation">,</span> Height<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name"><span class="token keyword">string</span></span> Initstate <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">)</span>SelfPlaceKey<span class="token punctuation">.</span><span class="token function">GetValue</span><span class="token punctuation">(</span><span class="token string">&quot;WindowState&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//****枚举类型数据的Parse</span>
    WindowState <span class="token operator">=</span> <span class="token punctuation">(</span>FormWindowState<span class="token punctuation">)</span>FormWindowState<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>WindowState<span class="token punctuation">.</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Initstate<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>`,2),c=[o];function e(u,l){return s(),a("div",null,c)}const i=n(p,[["render",e],["__file","sysinfo18.html.vue"]]);export{i as default};
