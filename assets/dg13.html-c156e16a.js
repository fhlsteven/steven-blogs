import{_ as n,o as s,c as a,a as t}from"./app-a2b6e588.js";const p={},o=t(`<h1 id="如何把数据写入datagrid中去" tabindex="-1"><a class="header-anchor" href="#如何把数据写入datagrid中去" aria-hidden="true">#</a> 如何把数据写入DataGrid中去？</h1><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>主　　题：  如何把数据写入DataGrid中去？
作　　者：  superman7826 (不说不知道)
等　　级：  ^
信 誉 值：  94
所属论坛：  .NET技术 C#
问题点数：  100
回复次数：  9
发表时间：  2003-8-20 18:23:07
</code></pre></div><p>如何把数据写到DataGrid中，给点代码吧！<br> 同时，在C#下面，如何判断字符串是数值形的呢？谢谢！</p><hr><hr><p>回复人： net_lover(孟子E章) ( 五星(高级)) 信誉：115 2003-8-20 18:27:50 得分:20</p><blockquote><p><code>http://xml.sz.luohuedu.net/xml/Content.asp</code></p></blockquote><p>回复人： hq1305018(跃强) ( 四级(中级)) 信誉：100 2003-8-20 18:38:35 得分:5</p><blockquote><p>1、你首先建立一个DataRow对象，把数据添加到该对象中。DataGrid.Rows.Add方法可以增加新行。<br> 2、</p></blockquote><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token class-name">String</span> aa<span class="token operator">=</span><span class="token string">&quot;12345a&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">try</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span>aa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;格式不正确&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>回复人： snof(雪狼) ( 两星(中级)) 信誉：105 2003-8-20 19:39:50 得分:15</p><blockquote><p>5.12 How can I restrict the keystrokes that will be accepted in a column of my datagrid?<br><br> You can create a custom column style and handle the KeyPress event of its TextBox member. Below is the code showing how this might be done. You can also download a sample project (C#, VB) that shows an implementation of this idea.<br><br></p></blockquote><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataGridDigitsTextBoxColumn</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">DataGridTextBoxColumn</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">DataGridDigitsTextBoxColumn</span><span class="token punctuation">(</span><span class="token class-name">System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span>PropertyDescriptor</span> pd<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> format<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">bool</span></span> b<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span>pd<span class="token punctuation">,</span> format<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>TextBox<span class="token punctuation">.</span>KeyPress <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>KeyPressEventHandler</span><span class="token punctuation">(</span>HandleKeyPress<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">HandleKeyPress</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>KeyPressEventArgs</span> e<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token comment">//ignore if not digit or control key</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">char</span><span class="token punctuation">.</span><span class="token function">IsDigit</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>KeyChar<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">char</span><span class="token punctuation">.</span><span class="token function">IsControl</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>KeyChar<span class="token punctuation">)</span><span class="token punctuation">)</span>
            e<span class="token punctuation">.</span>Handled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

        <span class="token comment">//ignore if more than 3 digits </span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>TextBox<span class="token punctuation">.</span>Text<span class="token punctuation">.</span>Length <span class="token operator">&gt;=</span> <span class="token number">3</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">char</span><span class="token punctuation">.</span><span class="token function">IsControl</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>KeyChar<span class="token punctuation">)</span><span class="token punctuation">)</span>
            e<span class="token punctuation">.</span>Handled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">bool</span></span> disposing<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>disposing<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>TextBox<span class="token punctuation">.</span>KeyPress <span class="token operator">-=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>KeyPressEventHandler</span><span class="token punctuation">(</span>HandleKeyPress<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span>disposing<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>回复人： snof(雪狼) ( 两星(中级)) 信誉：105 2003-8-20 19:41:22 得分:10</p><blockquote><p>或者从这儿下一个例子程序<br> http://www.syncfusion.com/FAQ/WinForms/FAQ_c44c.asp#q773q<br><br><br> 5.16 How can I do cell by cell validation in a datagrid?<br><br> There are problems trying to implement cell by cell validation using the grid&#39;s Validating event architecture. The problem is that the grid is not the object handling the data. Instead, a TextBox or some other control is the control managing the changing of the cell contents. One way to implement the validation at the grid level is to handle the CurrentCellChanged event, and if the previous cell&#39;s value is not proper, then return to that cell. You can download a sample that implements this process. The sample only handles the validation from cell to cell movement. If you want to handle the validation when the user clicks on the forms Close button, then you would have to add a special event handler for this and do one last validation at this point.</p></blockquote><p>回复人： Amilsx(一个人住) ( 五级(中级)) 信誉：100 2003-8-20 22:19:35 得分:0</p><blockquote><p>To : net_lover(孟子E章) ( ) 信誉：115<br><br> 你的网站的美工真该找个专业点的人来给你改改.挺难看的.................<br><br> 呵呵</p></blockquote><p>回复人： alphawin(云和山的彼端) ( 五级(中级)) 信誉：100 2003-8-21 8:46:36 得分:10</p><blockquote><p><code>DataGrid.Rows.Add</code>就可以了</p></blockquote><p>回复人： wf5360308(峰) ( 二级(初级)) 信誉：100 2003-8-21 10:40:54 得分:25</p><blockquote><p>很简单的，看一下代码就会了</p></blockquote><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token class-name">DataRow</span> a<span class="token operator">=</span>dataSet31<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token string">&quot;表名&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">NewRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>textBox1<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>textBox2<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span>comboBox1<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>textBox3<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span>dateTimePicker1<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
a<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">=</span>dateTimePicker2<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
a<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">=</span>comboBox2<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
a<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">=</span>dateTimePicker3<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
a<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">=</span>textBox4<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
a<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">=</span>textBox5<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
a<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">=</span>textBox6<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>

dataSet31<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token string">&quot;表名&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>

sqlDataAdapter1<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>dataSet31<span class="token punctuation">,</span><span class="token string">&quot;表名&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>回复人： gatr() ( 四级(中级)) 信誉：98 2003-8-21 10:49:41 得分:5</p><blockquote><p>直接修改dataset。</p></blockquote><p>回复人： kuangren(今天逃课~) ( 三级(初级)) 信誉：100 2003-8-21 11:04:23 得分:10</p><blockquote><p>用<code>Table.Rows.Add()</code>就可以了～<br> wf5360308(峰) 那里已经说了很清楚了！</p></blockquote><p>该问题已经结贴 ，得分记录： net_lover (20)、 hq1305018 (5)、 snof (15)、 snof (10)、 alphawin (10)、 wf5360308 (25)、 gatr (5)、 kuangren (10)、</p>`,27),e=[o];function c(l,u){return s(),a("div",null,e)}const k=n(p,[["render",c],["__file","dg13.html.vue"]]);export{k as default};
