import{_ as n,o as s,c as a,a as t}from"./app-a2b6e588.js";const p={},e=t(`<h1 id="treeview使用集锦" tabindex="-1"><a class="header-anchor" href="#treeview使用集锦" aria-hidden="true">#</a> TreeView使用集锦</h1><blockquote><p>hgknight（原作） 关键字 TreeView</p></blockquote><p>原来在论坛里发过专题帖子，只是由于帖子丢失原因，有些问题找不到了，同时这次也补充了一些，发到文档区以方便查询吧</p><p>原贴<br> http://expert.csdn.net/Expert/topic/1525/1525202.xml</p><h2 id="_1-下载地址" tabindex="-1"><a class="header-anchor" href="#_1-下载地址" aria-hidden="true">#</a> 1.下载地址</h2><p>http://msdn.microsoft.com/downloads/samples/internet/ASP_DOT_NET_ServerControls/WebControls/default.asp</p><p>下载后是后缀为bat的版本</p><p>(1)bulid.将bulid.bat的路径指向csc.exe所在路径,生成Microsoft.Web.UI.WebControls.dll。<br> (2)在wwwroot下创建空目录webctrl_client\\1_0。<br> (3)将build\\Runtime下的文件拷至webctrl_client\\1_0下。<br> (4)选择工具箱的自定义工具箱，添加Microsoft.Web.UI.WebControls.dll。</p><p>有些麻烦<br> 但如果你能找到后缀是msi的自动安装版本，直接下一步就行（我一直用这个版本，hoho）<br> 安装后，通过“自定义工具箱”-&gt;“.net框架组件”把TreeView添加到工具箱里<br></p><h2 id="_2-运行时无法显示" tabindex="-1"><a class="header-anchor" href="#_2-运行时无法显示" aria-hidden="true">#</a> 2.运行时无法显示</h2><p>一般是TreeView的版本问题，最好下载英文版自动安装版本重新安装，安装前应该先到添加删除程序里卸掉原版本</p><h2 id="_3-显示格式出错-非树状显示" tabindex="-1"><a class="header-anchor" href="#_3-显示格式出错-非树状显示" aria-hidden="true">#</a> 3.显示格式出错（非树状显示）</h2><p>TreeView要求客户端浏览器版本为IE5.5及以上，最好要求客户端升级为IE6.0</p><h2 id="_4-框架里使用treeview" tabindex="-1"><a class="header-anchor" href="#_4-框架里使用treeview" aria-hidden="true">#</a> 4.框架里使用TreeView</h2><p>设置NavigateUrl、Target属性，可更新另外的Frame</p><h2 id="_5-找不到treenode类" tabindex="-1"><a class="header-anchor" href="#_5-找不到treenode类" aria-hidden="true">#</a> 5.找不到TreeNode类</h2><p>使用TreeView，最好添加namespace：using Microsoft.Web.UI.WebControls;</p><h2 id="_6-遍历treeview节点-递归算法" tabindex="-1"><a class="header-anchor" href="#_6-遍历treeview节点-递归算法" aria-hidden="true">#</a> 6.遍历TreeView节点(递归算法)</h2><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Page_Load</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">GetAllNodeText</span><span class="token punctuation">(</span>TreeView1<span class="token punctuation">.</span>Nodes<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GetAllNodeText</span><span class="token punctuation">(</span><span class="token class-name">TreeNodeCollection</span> tnc<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> node <span class="token keyword">in</span> tnc<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>Nodes<span class="token punctuation">.</span>Count<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token function">GetAllNodeText</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>Nodes<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>Text <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_7-得到node结点的父节点" tabindex="-1"><a class="header-anchor" href="#_7-得到node结点的父节点" aria-hidden="true">#</a> 7.得到node结点的父节点</h2><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token class-name">TreeNode</span> pnode<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>Parent <span class="token keyword">is</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
    pnode<span class="token operator">=</span><span class="token punctuation">(</span>TreeNode<span class="token punctuation">)</span>node<span class="token punctuation">.</span>Parent<span class="token punctuation">;</span>
<span class="token keyword">else</span>
    <span class="token comment">//node is root node</span>
</code></pre></div><h2 id="_8-修改treeview样式-示例" tabindex="-1"><a class="header-anchor" href="#_8-修改treeview样式-示例" aria-hidden="true">#</a> 8.修改TreeView样式（示例）</h2><p><code>&lt;iewc:TreeView id=&quot;TreeView1&quot; runat=&quot;server&quot; HoverStyle=&quot;color:blue;background:#00ffCC;&quot; DefaultStyle=&quot;background:red;color:yellow;&quot; SelectedStyle=&quot;color:red;background:#00ff00;&quot;&gt;</code></p><p>用代码：</p><p><code>TreeView1.DefaultStyle[&quot;font-size&quot;] = &quot;20pt&quot;;</code></p><h2 id="_9-展开时不提交-改变选择节点时才提交" tabindex="-1"><a class="header-anchor" href="#_9-展开时不提交-改变选择节点时才提交" aria-hidden="true">#</a> 9.展开时不提交，改变选择节点时才提交</h2><p>将autopostback设置成false;<br> 在body里添加 <code>&lt;body onload=&quot;initTree()&quot;&gt;</code><br> 然后在PageLoad里写：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">string</span></span>  strTreeName  <span class="token operator">=</span>  <span class="token string">&quot;TreeView1&quot;</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">string</span></span>  strRef  <span class="token operator">=</span>  Page<span class="token punctuation">.</span><span class="token function">GetPostBackEventReference</span><span class="token punctuation">(</span>TreeView1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">string</span></span>  strScript  <span class="token operator">=</span>  <span class="token string">&quot;&lt;script  language=\\&quot;JavaScript\\&quot;&gt;  \\n&quot;</span>  <span class="token operator">+</span>  <span class="token string">&quot;&lt;!--  \\n&quot;</span>  <span class="token operator">+</span>  <span class="token string">&quot; function  initTree() {  \\n&quot;</span>  <span class="token operator">+</span><span class="token string">&quot;&quot;</span>  <span class="token operator">+</span>  strTreeName  <span class="token operator">+</span>  <span class="token string">&quot;.onSelectedIndexChange  =  function()  {  \\n&quot;</span>  
        <span class="token operator">+</span> <span class="token string">&quot;if  (event.oldTreeNodeIndex  != event.newTreeNodeIndex)  \\n&quot;</span>  <span class="token operator">+</span>  <span class="token string">&quot;this.queueEvent(&#39;onselectedindexchange&#39;,  event.oldTreeNodeIndex  +  &#39;,&#39;  +  event.newTreeNodeIndex);  \\n&quot;</span> 
        <span class="token operator">+</span> <span class="token string">&quot;window.setTimeout(&#39;&quot;</span>  <span class="token operator">+</span>  <span class="token string">&quot;strRef.Replace(\\&quot;&#39;\\&quot;,\\&quot;\\\\&#39;\\&quot;) &quot;</span>   <span class="token operator">+</span>  <span class="token string">&quot;&#39;,  0,  &#39;JavaScript&#39;);  \\n&quot;</span>  <span class="token operator">+</span>    <span class="token string">&quot;}  \\n&quot;</span>  <span class="token operator">+</span>      <span class="token string">&quot;}  \\n&quot;</span>  <span class="token operator">+</span>  <span class="token string">&quot;//  --&gt;  \\n&quot;</span>  <span class="token operator">+</span>  <span class="token string">&quot;&lt;/script&gt;&quot;</span><span class="token punctuation">;</span> 
Page<span class="token punctuation">.</span><span class="token function">RegisterClientScriptBlock</span><span class="token punctuation">(</span><span class="token string">&quot;InitTree&quot;</span><span class="token punctuation">,</span>strScript<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这样就只有你点击的节点更改的时候才提交！</p><h2 id="_10-treeview结合xml" tabindex="-1"><a class="header-anchor" href="#_10-treeview结合xml" aria-hidden="true">#</a> 10.TreeView结合XML</h2><p>把XML文件设置为如下格式，然后直接设置TreeNodeSrc为该XML文件就行</p><div class="language-xml" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;GB2312&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TREENODES</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TREENODE</span> <span class="token attr-name">TEXT</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>node0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">EXPANDED</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TREENODE</span> <span class="token attr-name">TEXT</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>node1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TREENODE</span> <span class="token attr-name">TEXT</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>node2<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>TREENODE</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TREENODE</span> <span class="token attr-name">TEXT</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>node3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">NavigateURL</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3.aspx<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>TREENODES</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>或者用代码</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code>TreeView1<span class="token punctuation">.</span>TreeNodeSrc<span class="token operator">=</span><span class="token string">&quot;a.xml&quot;</span><span class="token punctuation">;</span>
TreeView1<span class="token punctuation">.</span><span class="token function">DataBind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>客户端控制TreeView<br> http://expert.csdn.net/Expert/topic/1382/1382892.xml</p><p>1.设置所选节点，如选中第二个节点</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token return-type class-name">function</span> <span class="token function">SetSelNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    TreeView1<span class="token punctuation">.</span>selectedNodeIndex<span class="token operator">=</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>2.得到所选节点的Text，ID或NodeData</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token return-type class-name">function</span> <span class="token function">GetAttribute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>TreeView1<span class="token punctuation">.</span><span class="token function">getTreeNode</span><span class="token punctuation">(</span>TreeView1<span class="token punctuation">.</span>selectedNodeIndex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;Text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>替换Text为ID或NodeData，可分别得到所选节点的ID或NodeData</p><p>3.修改节点属性，如修改第一个节点的Text</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token return-type class-name">function</span> <span class="token function">ModifyNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> node<span class="token operator">=</span>TreeView1<span class="token punctuation">.</span><span class="token function">getTreeNode</span><span class="token punctuation">(</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    node<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;Text&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;hgknight&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>4.得到点击节点</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token return-type class-name">function</span> TreeView1<span class="token punctuation">.</span><span class="token function">onclick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>TreeView1<span class="token punctuation">.</span><span class="token function">getTreeNode</span><span class="token punctuation">(</span>TreeView1<span class="token punctuation">.</span>clickedNodeIndex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;Text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>5.添加节点</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token return-type class-name">function</span> <span class="token function">AddNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> node<span class="token operator">=</span>TreeView1<span class="token punctuation">.</span><span class="token function">createTreeNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    node<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;Text&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;hgknight&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    TreeView1<span class="token punctuation">.</span><span class="token keyword">add</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>6.js遍历所有节点</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> AllRootNode<span class="token operator">=</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
AllRootNode<span class="token operator">=</span>TreeView1<span class="token punctuation">.</span><span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">AlertNode</span><span class="token punctuation">(</span>AllRootNode<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token return-type class-name">function</span> <span class="token function">AlertNode</span><span class="token punctuation">(</span>NodeArray<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>NodeArray<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>NodeArray<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> cNode<span class="token punctuation">;</span>
            cNode<span class="token operator">=</span>NodeArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">alert</span><span class="token punctuation">(</span>cNode<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;Text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>cNode<span class="token punctuation">.</span><span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token function">AlertNode</span><span class="token punctuation">(</span>cNode<span class="token punctuation">.</span><span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><hr><hr><p><strong>对该文的评论</strong> 人气：705</p><p>lansquenet (2003-11-21 8:24:29)</p><blockquote><p>to dahuzizyd: 关于闪烁在FAQ里面可以找到,原贴已被删除了</p></blockquote><p>dahuzizyd (2003-11-19 13:27:26)</p><blockquote><p>江雨大哥，在讲讲闪烁的问题吧:)</p></blockquote>`,55),o=[e];function c(u,l){return s(),a("div",null,o)}const r=n(p,[["render",c],["__file","tv5.html.vue"]]);export{r as default};
