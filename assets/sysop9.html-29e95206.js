import{_ as n,o as s,c as a,a as e}from"./app-d9da1b6d.js";const t={},o=e(`<h1 id="how-to-develop-a-screen-saver-in-c" tabindex="-1"><a class="header-anchor" href="#how-to-develop-a-screen-saver-in-c" aria-hidden="true">#</a> How to develop a screen saver in C#</h1><h2 id="issues-covered" tabindex="-1"><a class="header-anchor" href="#issues-covered" aria-hidden="true">#</a> Issues covered</h2><p>This article explains:</p><ul><li>the basics of a screensaver</li><li>loading a screensaver</li><li>filling the whole screen</li><li>handling multiple monitors</li><li>handling events</li><li>some little intricacies</li></ul><p>Additionally, the code provides a basic screensaver framework which you could use easily to create screensavers on your own.</p><h2 id="ç›¸å…³ä¸»é¢˜" tabindex="-1"><a class="header-anchor" href="#ç›¸å…³ä¸»é¢˜" aria-hidden="true">#</a> ç›¸å…³ä¸»é¢˜</h2><p>è¿™ç¯‡æ–‡ç« è§£é‡Šäº†ä¸€ä¸‹å†…å®¹ï¼š</p><ul><li>å±ä¿çš„åŸºç¡€çŸ¥è¯†</li><li>è½½å…¥ä¸€ä¸ªå±ä¿</li><li>å¡«å……æ•´ä¸ªå±å¹•</li><li>æ“ä½œå¤šç›‘è§†å™¨ï¼ˆæ˜¾ç¤ºå™¨ï¼‰</li><li>å¤„ç†äº‹ä»¶</li><li>ä¸€äº›ç¨å¾®å¤æ‚çš„çŸ¥è¯†ç‚¹</li></ul><p>å¦å¤–ï¼Œè¿™ä¸ªä»£ç æä¾›äº†ä¸€ä¸ªåŸºæœ¬çš„å±å¹•ä¿æŠ¤ç¨‹åºçš„æ¡†æ¶ï¼Œä½ å¯ä»¥æ ¹æ®è¿™ä¸ªæ¡†æ¶è½»æ¾åœ°åˆ›å»ºä½ è‡ªå·±çš„å±å¹•ä¿æŠ¤ç¨‹åºã€‚</p><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction" aria-hidden="true">#</a> Introduction</h2><p>A screensaver in WindowsÂ® is simply an executable file with the extension .scr. The only difference between a normal executable and a screensaver is that a screensaver does some specific things, viz:</p><ul><li>parses the command line to find out what WindowsÂ® wants it to do</li><li>loads the screensaver appropriate to that request</li><li>ends the screensaver (usually), when the user uses the mouse or the keyboard</li></ul><h2 id="ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#ç®€ä»‹" aria-hidden="true">#</a> ç®€ä»‹</h2><p>ç®€å•å¾—è¯´ï¼Œä¸€ä¸ªå±å¹•ä¿æŠ¤ç¨‹åºåœ¨Windowsé‡Œå°±æ˜¯ä¸€ä¸ªä»¥.scrä¸ºæ‰©å±•åçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ä¸€ä¸ªæ™®é€šçš„å¯æ‰§è¡Œæ–‡ä»¶å’Œä¸€ä¸ªå±å¹•ä¿æŠ¤ç¨‹åºçš„å”¯ä¸€ä¸åŒåœ¨äºå±ä¿åšäº†ä¸€äº›ç‰¹åˆ«çš„äº‹,å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li>è§£æå‘½ä»¤è¡Œæ¥æ‰¾å‡ºWindowsæƒ³è®©å®ƒä½œä»€ä¹ˆ</li><li>è½½å…¥ç¬¦åˆè¿™ä¸ªè¯·æ±‚ï¼ˆè§£æå‘½ä»¤è¡Œæ‰€å–å¾—çš„è¯·æ±‚ï¼‰çš„å±ä¿</li><li>ï¼ˆä¸€èˆ¬æ¥è¯´ï¼‰å½“ç”¨æˆ·ä½¿ç”¨é¼ æ ‡æˆ–è€…é”®ç›˜çš„æ—¶å€™ï¼Œç»“æŸå±ä¿</li></ul><p>The arguments WindowsÂ® passes to a screensaver are:</p><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>/s - load the screensaver
/c - load the configuration screen
/p - load the preview
</code></pre></div><p>Once we determine the argument passed, we load the screensaver appropriately. When there is some kind of activity, you end the screensaver or do something else.</p><p>Windowsä¼ é€’ç»™å±ä¿çš„å‚æ•°æ˜¯ï¼š</p><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>/s â€“ è½½å…¥å±ä¿
/c â€“ è½½å…¥é…ç½®å±å¹•
/p â€“ è½½å…¥é¢„è§ˆ
</code></pre></div><p>ä¸€æ—¦æˆ‘ä»¬å†³å®šäº†è¦ä¼ é€’çš„å‚æ•°ï¼Œæˆ‘ä»¬å°±è½½å…¥ç›¸åº”çš„å±ä¿ã€‚å½“æœ‰ä¸€äº›æ´»åŠ¨æ—¶ï¼Œå°±ç»“æŸå±ä¿æˆ–è€…åšä¸€äº›åˆ«çš„äº‹ã€‚</p><h2 id="the-code-explained" tabindex="-1"><a class="header-anchor" href="#the-code-explained" aria-hidden="true">#</a> The code explained</h2><h3 id="step-1-making-the-main-method-accept-command-line-arguments" tabindex="-1"><a class="header-anchor" href="#step-1-making-the-main-method-accept-command-line-arguments" aria-hidden="true">#</a> Step 1: Making the Main method accept command-line arguments</h3><p>The first step in developing a screensaver in C# is to modify the Main method so that it could accept command-line arguments. The default Main method is like this:</p><h2 id="ä»£ç è§£é‡Š" tabindex="-1"><a class="header-anchor" href="#ä»£ç è§£é‡Š" aria-hidden="true">#</a> ä»£ç è§£é‡Š</h2><h3 id="æ­¥éª¤1-è®©mainå‡½æ•°æ¥å—å‘½ä»¤è¡Œå‚æ•°" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤1-è®©mainå‡½æ•°æ¥å—å‘½ä»¤è¡Œå‚æ•°" aria-hidden="true">#</a> æ­¥éª¤1ï¼šè®©Mainå‡½æ•°æ¥å—å‘½ä»¤è¡Œå‚æ•°</h3><p>ç”¨C#å¼€å‘ä¸€ä¸ªå±å¹•ä¿æŠ¤ç¨‹åºçš„ç¬¬ä¸€æ­¥å°±æ˜¯æ¥ä¿®æ”¹Mainå‡½æ•°ï¼ˆæ–¹æ³•ï¼‰ï¼Œè®©ä»–èƒ½å¤Ÿæ¥å—å‘½ä»¤è¡Œå‚æ•°ã€‚é»˜è®¤çš„Mainå‡½æ•°æ˜¯è¿™æ ·çš„ï¼š</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  
<span class="token punctuation">}</span>
</code></pre></div><p>As you can see, this Main method accepts no parameters. So, we add a string array parameter like this:</p><p>å¦‚ä½ æ‰€è§ï¼Œè¿™ä¸ªMainå‡½æ•°æ²¡æœ‰å‚æ•°ã€‚æ‰€ä»¥æˆ‘ä»¬åƒè¿™æ ·åŠ å…¥ä¸€ä¸ªstringæ•°ç»„å‚æ•°ï¼š</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  
<span class="token punctuation">}</span>
</code></pre></div><h3 id="step-2-checking-the-arguments" tabindex="-1"><a class="header-anchor" href="#step-2-checking-the-arguments" aria-hidden="true">#</a> Step 2: Checking the arguments</h3><p>Now we need to find out what arguments were passed.</p><h3 id="æ­¥éª¤2-æ£€æŸ¥å‚æ•°" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤2-æ£€æŸ¥å‚æ•°" aria-hidden="true">#</a> æ­¥éª¤2ï¼šæ£€æŸ¥å‚æ•°</h3><p>ç°åœ¨æˆ‘ä»¬å°±éœ€è¦æ‰¾å‡ºä¼ é€’äº†ä»€ä¹ˆå‚æ•°ã€‚</p><p>First, we will check whether WindowsÂ® did pass some arguments. How do we do that? Simple - just check the length of the string array; if it&#39;s 0, there are no arguments. BTW, a typical scenario where no arguments are passed is when user&#39;s just double click on your screensaver.</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦æ£€æŸ¥Windowsæ˜¯å¦ç¡®å®ä¼ é€’äº†ä¸€äº›å‚æ•°ã€‚æˆ‘ä»¬æ€ä¹ˆåŠå‘¢ï¼Ÿå…¶å®å¾ˆç®€å• â€“ åªè¦æ£€æŸ¥ä¸€ä¸‹stringæ•°ç»„çš„é•¿åº¦å°±è¡Œäº†ï¼›å¦‚æœé•¿åº¦æ˜¯0ï¼Œå°±æ²¡æœ‰å‚æ•°ã€‚é¡ºä¾¿è¯´ä¸€å¥ï¼Œä¸€ç§å…¸å‹çš„æƒ…æ™¯å°±æ˜¯ï¼Œå½“ç”¨æˆ·åŒå‡»ä½ çš„å±ä¿ï¼Œæ˜¯æ²¡æœ‰å‚æ•°è¢«ä¼ é€’çš„ã€‚</p><p>Secondly, if there indeed are arguments, we catch them. WindowsÂ® may pass arguments in either the lower case or the upper case. So it&#39;s a good idea to induce generalization of some sort. We do this by changing the arguments to lower case (or upper case) first and then checking them. The complete Main method would look something like:</p><p>å…¶æ¬¡ï¼Œå¦‚æœç¡®å®æœ‰å‚æ•°ï¼Œæˆ‘ä»¬å°±å–å¾—å®ƒä»¬ã€‚Windowså¯èƒ½ä¼šç”¨å°å†™æˆ–è€…å¤§å†™çš„å½¢å¼ä¼ é€’å‚æ•°ã€‚æ‰€ä»¥æœ€å¥½ä½¿å®ƒå˜ä¸ºæŸä¸€ç§å½¢å¼ã€‚æ‰€ä»¥æˆ‘ä»¬å…ˆå°±æŠŠå‚æ•°å˜ä¸ºå°å†™ï¼ˆæˆ–è€…å¤§å†™ï¼‰ï¼Œç„¶åå†æ£€æŸ¥å®ƒä»¬ã€‚å®Œæˆçš„Mainå‡½æ•°åº”è¯¥åƒä¸‹é¢è¿™æ ·ï¼š</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>Length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token comment">// load the config stuff</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;/c&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;/s&quot;</span><span class="token punctuation">)</span> <span class="token comment">// load the screensaver</span>
    <span class="token punctuation">{</span>
      
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToLower</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;/p&quot;</span><span class="token punctuation">)</span> <span class="token comment">// load the preview</span>
    <span class="token punctuation">{</span>
      
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token comment">// there are no argumentsnevertheless, do something!</span>
  <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Quite straight forward, isn&#39;t it? The only code you need to add here is the stuff you want to do for each argument.</p><p>å¾ˆç›´æˆªäº†å½“ï¼Œä¸æ˜¯å—ï¼Ÿä½ åœ¨è¿™é‡Œæ‰€è¦åŠ çš„ä»£ç æ˜¯å¯¹åº”æ¯ä¸ªå‚æ•°åšç›¸åº”çš„å¤„ç†ã€‚</p><h3 id="step-3-invoking-the-screensaver" tabindex="-1"><a class="header-anchor" href="#step-3-invoking-the-screensaver" aria-hidden="true">#</a> Step 3: Invoking the screensaver</h3><h3 id="æ­¥éª¤3-è°ƒç”¨å±å¹•ä¿æŠ¤ç¨‹åº" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤3-è°ƒç”¨å±å¹•ä¿æŠ¤ç¨‹åº" aria-hidden="true">#</a> æ­¥éª¤3ï¼šè°ƒç”¨å±å¹•ä¿æŠ¤ç¨‹åº</h3><p>To run the screensaver, you call the System.Windows.Forms.Application.Run method. You pass a new form object as the argument. The code will look like:</p><p>ä½ å¯ä»¥è°ƒç”¨System.Windows.Forms.Application.Runæ–¹æ³•æ¥è¿è¡Œå±å¹•ä¿æŠ¤ç¨‹åºã€‚ä½ ä¼ é€’ä¸€ä¸ªçª—ä½“å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><p><code>System.Windows.Forms.Application.Run(new frmScreenSaver());</code></p><p>where frmScreenSaver is main screensaver form.</p><p>è¿™é‡ŒfrmScreenSaverä»£è¡¨å±ä¿çš„ä¸»çª—ä½“</p><p>When the screensaver loads, we want it to fit the entire screen. To access screens, we use the Screen class. Using the PrimaryScreen property of this class, we could access the primary screen of the system as well as it&#39;s properties. Among those properties is Bounds, representing the size of the screen. What we do is set the form&#39;s Bounds property to that of this screen, and then the form would be resized to occupy the entire screen. This procedure is usually executed in the form&#39;s Load event, for example:</p><p>å½“å±ä¿ç¨‹åºè¢«è½½å…¥åï¼Œæˆ‘ä»¬æƒ³è®©å®ƒå……æ»¡æ•´ä¸ªå±å¹•ã€‚æˆ‘ä»¬ä½¿ç”¨Screenç±»æ¥è®¿é—®å±å¹•å¯¹è±¡ã€‚ä½¿ç”¨è¿™ä¸ªç±»çš„PrimaryScreenå±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®ç³»ç»Ÿçš„ä¸»å±å¹•å¯¹è±¡å’Œå®ƒçš„å±æ€§ã€‚è¿™äº›å±æ€§ä¸­æœ‰ä¸€ä¸ªæ˜¯Bounds,ç”¨æ¥ä»£è¡¨å±å¹•çš„å°ºå¯¸ã€‚æˆ‘ä»¬æ‰€éœ€è¦åšå¾—æ˜¯æ ¹æ®è¿™ä¸ªå±å¹•æ¥è®¾ç½®çª—ä½“çš„Boundså±æ€§ï¼Œç„¶åè¿™ä¸ªçª—ä½“å°±èƒ½æ”¹å˜å¤§å°æ¥å……æ»¡æ•´ä¸ªå±å¹•ã€‚è¿™ä¸ªè¿‡ç¨‹é€šå¸¸åœ¨çª—ä½“çš„Loadäº‹ä»¶ä¸­æ‰§è¡Œï¼Œæ¯”å¦‚è¯´ï¼š</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">frmScreenSaver_Load</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Bounds <span class="token operator">=</span> Screen<span class="token punctuation">.</span>PrimaryScreen<span class="token punctuation">.</span>Bounds<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We need to address one possibility though - the user may be using more than one screen. If that&#39;s true, and if we load the screensaver only on one screen, the whole point of using this screensaver is lost. Hence, we find out the number of screens available, and load the screensaver in each of them. To do this, we iterate through all the available screens in the Main method, where we repeatedly call the form&#39;s constructor passing the screen&#39;s index. The set of all screens available in the system is listed in the AllScreens property of the Screen class. Thus the code in the Main method invoking the screensaver will have to be modified as:</p><p>å¯æ˜¯æˆ‘ä»¬éœ€è¦è¯´æ˜å¦ä¸€ä¸ªå¯èƒ½ â€“ ç”¨æˆ·å¯èƒ½ä½¿ç”¨ä¸æ­¢ä¸€ä¸ªå±å¹•ã€‚å¦‚æœçœŸçš„æ˜¯é‚£æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å‡å¦‚åªè½½å…¥ä¸€ä¸ªå±å¹•ï¼Œé‚£å°±å¤±å»äº†ä½¿ç”¨è¿™ä¸ªå±ä¿çš„æ€»ç›®æ ‡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°±æ‰¾å‡ºå¯ç”¨å±å¹•çš„æ•°é‡ï¼ŒæŠŠæ¯ä¸€ä¸ªéƒ½è½½å…¥å±ä¿ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬åœ¨Mainå‡½æ•°ä¸­è¿­ä»£æ‰€æœ‰å¯ç”¨å±å¹•ï¼Œè¿™æ ·æˆ‘ä»¬å°±åå¤è°ƒç”¨ä¼ é€’äº†ä»¥å±å¹•ç´¢å¼•ä¸ºå‚æ•°çš„çª—ä½“æ„é€ å™¨ã€‚ç³»ç»Ÿä¸­æ‰€æœ‰å¯ç”¨å±å¹•çš„é›†åˆéƒ½åˆ—åœ¨äº†Screenç±»çš„AllScreenså±æ€§ä¸­ã€‚äºæ˜¯åœ¨Mainå‡½æ•°ä¸­è°ƒç”¨å±å¹•ä¿æŠ¤ç¨‹åºçš„ä»£ç å°±è¦è¢«æ”¹æˆï¼š</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> Screen<span class="token punctuation">.</span>AllScreens<span class="token punctuation">.</span><span class="token function">GetLowerBound</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> Screen<span class="token punctuation">.</span>AllScreens<span class="token punctuation">.</span><span class="token function">GetUpperBound</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Application<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">frmScreenSaver</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Note the change in the main screensaver form&#39;s constructor - it accepts an int parameter, which represents the screen&#39;s index onto which the screensaver is to be run. In response to this, we modify the form&#39;s class by adding an int member variable which will store the screen index. The form&#39;s constructor will then be modified to initialize this variable, like this:</p><p>æ³¨æ„å±ä¿ä¸»çª—ä½“æ„é€ å‡½æ•°ä¸­çš„æ”¹å˜ â€“ å®ƒæ¥å—ä¸€ä¸ªint å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ä»£è¡¨å°†è¦è¢«è¿è¡Œçš„å±ä¿çš„å±å¹•ç´¢å¼•ã€‚ä¸æ­¤ç›¸åº”çš„ï¼Œæˆ‘ä»¬ä¿®æ”¹çª—ä½“ç±»è®©å®ƒå¢åŠ ä¸€ä¸ªæ•´å‹æˆå‘˜å˜é‡ï¼Œç”¨æ¥ä¿å­˜å±å¹•çš„ç´¢å¼•ã€‚çª—ä½“çš„æ„é€ å™¨å°±è¦è¢«ä¿®æ”¹ä»¥åˆå§‹åŒ–è¿™ä¸ªå˜é‡ï¼Œå°†åƒè¿™æ ·ï¼š</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token function">frmScreenSaver</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> scrn<span class="token punctuation">)</span>
<span class="token punctuation">{</span>  
    ScreenNumber <span class="token operator">=</span> scrn<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>where ScreenNumber is the int member variable.</p><p>è¿™é‡Œçš„ScreenNumberå°±æ˜¯é‚£ä¸ªæ•´å‹æˆå‘˜å˜é‡ã€‚</p><p>After this, the Load event handler will have to be modified to resize the form to the bounds of not the primary screen, but that of the screen represented by the index, like this:</p><p>ç„¶åï¼ŒLoadäº‹ä»¶éœ€è¦è¢«æ›´æ”¹ï¼Œç”¨æ¥æ”¹å˜çª—ä½“å¤§å°ä»¥é€‚åº”å½“å‰å±å¹•è€Œä¸æ˜¯ä¸»å±å¹•ï¼Œä¸è¿‡å½“å‰å±å¹•ç”±ç´¢å¼•å€¼ç¡®å®šï¼Œå°±åƒè¿™æ ·ï¼š</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">frmScreenSaver_Load</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>  
    Bounds <span class="token operator">=</span> Screen<span class="token punctuation">.</span>AllScreens<span class="token punctuation">[</span>ScreenNumber<span class="token punctuation">]</span><span class="token punctuation">.</span>Bounds<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Once this is done, we have added multiple screen display functionality to our screensaver.</p><p>ä¸€æ—¦è¿™ä¸ªå®Œæˆäº†ï¼Œæˆ‘ä»¬å°±ç»™æˆ‘ä»¬çš„å±å¹•ä¿æŠ¤ç¨‹åºåŠ å…¥äº†å¤šå±å¹•æ˜¾ç¤ºåŠŸèƒ½ã€‚</p><p>You will want to make the form topmost and hide the cursor. Just call the additional methods in the Load handler like this:</p><p>ä½ å¸Œæœ›çª—ä½“ç½®é¡¶ï¼Œéšè—é¼ æ ‡æŒ‡é’ˆã€‚åªè¦è°ƒç”¨åœ¨Loadäº‹ä»¶å¤„ç†æ–¹æ³•ä¸­çš„é™„åŠ æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">frmScreenSaver_Load</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>  
    Bounds <span class="token operator">=</span> Screen<span class="token punctuation">.</span>AllScreens<span class="token punctuation">[</span>ScreenNumber<span class="token punctuation">]</span><span class="token punctuation">.</span>Bounds<span class="token punctuation">;</span>
    Cursor<span class="token punctuation">.</span><span class="token function">Hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    TopMost <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="step-4-handling-events" tabindex="-1"><a class="header-anchor" href="#step-4-handling-events" aria-hidden="true">#</a> Step 4: Handling events</h3><h3 id="æ­¥éª¤4-å¤„ç†äº‹ä»¶" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤4-å¤„ç†äº‹ä»¶" aria-hidden="true">#</a> æ­¥éª¤4ï¼šå¤„ç†äº‹ä»¶</h3><p>Once you have loaded your screensaver, you will have to handle events. This is because when the user uses the mouse or hits the keyboard, you probably want to do something, like ending the screensaver. To do this, you just add event handlers to the KeyDown, MouseMove and MoveDown events of the screensaver form. In the event handlers, you could use the form&#39;s Close method of the form to end the screensaver.</p><p>ä¸€æ—¦ä½ è½½å…¥ä½ çš„å±ä¿ç¨‹åºï¼Œä½ å°±éœ€è¦å¤„ç†äº‹ä»¶ã€‚è¿™æ˜¯å› ä¸ºå½“ç”¨æˆ·ä½¿ç”¨é¼ æ ‡æˆ–è€…æ•²å‡»é”®ç›˜æ—¶ï¼Œä½ å¾ˆå¯èƒ½æƒ³åšäº›ä»€ä¹ˆï¼Œæ¯”å¦‚è¯´ç»ˆæ­¢å±ä¿ç¨‹åºã€‚ä¸ºäº†å®ç°è¿™ç‚¹ï¼Œä½ åªéœ€è¦ä¸ºå±å¹•ä¿æŠ¤ç¨‹åºçš„çª—ä½“äº‹ä»¶ KeyDown, MouseMove å’Œ MoveDownå¢åŠ äº‹ä»¶å¤„ç†æ–¹æ³•ã€‚åœ¨äº‹ä»¶å¤„ç†æ–¹æ³•é‡Œï¼Œä½ å¯ä»¥ä½¿ç”¨å½“å‰çª—ä½“çš„Closeæ–¹æ³•æ¥ç»“æŸå±å¹•ä¿æŠ¤ç¨‹åºã€‚</p><p>There is one thing though. When an application is executed, the current mouse parameters are passed to it by WindowsÂ® through an event. Thus, the respective event handler is called automatically right after an application&#39;s inception. Hence, if you call the Close method in the mouse event handlers as such, the application simply closes right after it is executed. So what do we do to getaround this problem? Add a Point variable, initialize it when the application executes, and check the mouse position and mouse clicks when events occur. If there is any change, then call Close. The code would look something like:</p><p>è¿˜æœ‰ä¸€ä»¶äº‹ã€‚å½“ä¸€ä¸ªåº”ç”¨ç¨‹åºæ‰§è¡Œäº†ï¼Œå½“å‰é¼ æ ‡å‚æ•°è¢«Windowsé€šè¿‡ä¸€ä¸ªäº‹ä»¶ä¼ é€’ç»™è¿™ä¸ªåº”ç”¨ç¨‹åºã€‚äºæ˜¯ï¼Œåœ¨åº”ç”¨ç¨‹åºåˆšå¼€å§‹è¿è¡Œä»¥åï¼Œç›¸åº”çš„äº‹ä»¶å¤„ç†æ–¹æ³•å°±è¢«è‡ªåŠ¨è°ƒç”¨äº†ã€‚å› æ­¤ï¼Œå¦‚æœä½ å°±è¿™æ ·åœ¨é¼ æ ‡ç§»åŠ¨äº‹ä»¶å¤„ç†æ–¹æ³•é‡Œè°ƒç”¨Closeæ–¹æ³•ï¼Œè¿™ä¸ªå±ä¿ç¨‹åºåœ¨å®ƒä¸€å¯åŠ¨ä¹‹åé©¬ä¸Šå°±ä¼šå…³é—­äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬è¯¥æ€ä¹ˆåšæ¥å¤„ç†è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿå¢åŠ ä¸€ä¸ªPointå˜é‡ï¼Œå½“ç¨‹åºå¼€å§‹æ‰§è¡Œå°±æŠŠå®ƒåˆå§‹åŒ–ï¼Œç„¶ååœ¨äº‹ä»¶å‘ç”Ÿçš„æ—¶å€™æ£€æŸ¥é¼ æ ‡çš„ä½ç½®å’Œé¼ æ ‡ç‚¹å‡»ã€‚å¦‚æœæœ‰ä»»ä½•æ”¹å˜ï¼Œå°±è°ƒç”¨Closeæ–¹æ³•ã€‚ä»£ç åº”è¯¥åƒä¸‹é¢è¿™æ ·ï¼š</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnMouseMove</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>MouseEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>MouseXY<span class="token punctuation">.</span>IsEmpty<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>MouseXY <span class="token operator">!=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>X<span class="token punctuation">,</span> e<span class="token punctuation">.</span>Y<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    MouseXY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>X<span class="token punctuation">,</span> e<span class="token punctuation">.</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>where MouseXY is the Point variable we use to store the initial mouse position temporarily. Initially, MouseXY is null; and thus is assigned the current mouse position through this code. In the next call of this event handler, MouseXY is not empty; so we check whether the position has changed; if yes, close the form.</p><p>è¿™é‡ŒMouseXY æ˜¯ä¸€ä¸ªæˆ‘ä»¬ç”¨æ¥ä¸´æ—¶å‚¨å­˜é¼ æ ‡åˆå§‹ä½ç½®çš„Pointå˜é‡ã€‚åˆšå¼€å§‹ï¼Œ MouseXY æ˜¯ nullå€¼ï¼›ç„¶åé€šè¿‡ä»£ç èµ‹ç»™å®ƒå½“å‰é¼ æ ‡ä½ç½®çš„å€¼ã€‚ä¸‹ä¸€æ¬¡æˆ‘ä»¬è°ƒç”¨è¿™ä¸ªäº‹ä»¶å¤„ç†æ–¹æ³•ï¼ŒMouseXYå°±ä¸æ˜¯ç©ºçš„äº†ï¼›æ‰€ä»¥æˆ‘ä»¬æ£€æŸ¥æ˜¯å¦ä½ç½®å‘ç”Ÿäº†æ”¹å˜ï¼Œå¦‚æœæ˜¯ï¼Œå°±å…³é—­çª—ä½“ã€‚</p><p>As mentioned earlier, you should handle both MouseMove and MouseDown events in a screensaver. But since both have the same arguments, you could use the same event handler for handling both events. Such a code would look like:</p><p>å°±åƒå‰é¢æåˆ°çš„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸€ä¸ªå±å¹•ä¿æŠ¤ç¨‹åºé‡Œå¤„ç†MouseMove å’Œ MouseDown ä¸¤ä¸ªäº‹ä»¶ã€‚ä½†æ˜¯å› ä¸ºè¿™ä¸ªä¸¤ä¸ªäº‹ä»¶éƒ½æœ‰ç›¸åŒçš„å‚æ•°ï¼Œä½ å¯ä»¥ä½¿ç”¨ç›¸åŒçš„äº‹ä»¶å¤„ç†æ–¹æ³•æ¥å¤„ç†è¿™ä¸¤ä¸ªäº‹ä»¶ã€‚è¿™æ ·çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnMouseEvent</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>MouseEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>MouseXY<span class="token punctuation">.</span>IsEmpty<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>MouseXY <span class="token operator">!=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>X<span class="token punctuation">,</span> e<span class="token punctuation">.</span>Y<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>Clicks <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    MouseXY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>X<span class="token punctuation">,</span> e<span class="token punctuation">.</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>where OnMouseEvent is the event handler which is called on mouse move as well as mouse down events.</p><p>è¿™é‡ŒOnMouseEvent æ˜¯ä¸€ä¸ªåœ¨ç§»åŠ¨é¼ æ ‡æˆ–è€…æŒ‰ä¸‹é¼ æ ‡æŒ‰é’®æ—¶è§¦å‘çš„äº‹ä»¶å¤„ç†æ–¹æ³•ã€‚</p><h3 id="step-5-finally" tabindex="-1"><a class="header-anchor" href="#step-5-finally" aria-hidden="true">#</a> Step 5: Finally...</h3><h3 id="æ­¥éª¤5-æœ€å" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤5-æœ€å" aria-hidden="true">#</a> æ­¥éª¤5ï¼šæœ€åâ€¦</h3><p>Isn&#39;t it over yet? Nope, just one more small thing more...after developing your screensaver, rename it with the .scr extension. You are done! ğŸ˜ƒ</p><p>éš¾é“è¿˜æ²¡ç»“æŸå—ï¼Ÿæ²¡æœ‰å•¦ï¼Œåªæ˜¯è¿˜æœ‰ä¸€ä»¶å°äº‹æƒ…â€¦åœ¨å¼€å‘å®Œä½ çš„å±ä¿ç¨‹åºä»¥åï¼ŒæŠŠå®ƒæ›´åä¸º.scrçš„åç¼€åã€‚ä½ å®Œæˆäº†ï¼ğŸ˜ƒ</p><h2 id="using-the-bundled-code" tabindex="-1"><a class="header-anchor" href="#using-the-bundled-code" aria-hidden="true">#</a> Using the bundled code</h2><h3 id="ä½¿ç”¨æ‰“åŒ…çš„ä»£ç -è¯·åˆ°åŸæ–‡çš„é¡µé¢ä¸‹è½½" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ‰“åŒ…çš„ä»£ç -è¯·åˆ°åŸæ–‡çš„é¡µé¢ä¸‹è½½" aria-hidden="true">#</a> ä½¿ç”¨æ‰“åŒ…çš„ä»£ç ï¼ˆè¯·åˆ°åŸæ–‡çš„é¡µé¢ä¸‹è½½ï¼‰</h3><p>The code provided just loads a black form. To change it and implement your own features, follow these simple steps:</p><p>è¿™ä¸ªä»£ç åªæä¾›äº†å…¨é»‘çš„çª—ä½“ã€‚ä½ å¯ä»¥æ ¹æ®ä»¥ä¸‹å‡ ä¸ªç®€å•çš„æ­¥éª¤æ¥ä¿®æ”¹å®ƒå¹¶ä¸”å®ç°ä½ è‡ªå·±çš„å±æ€§ï¼š</p><p>Change the code in the Main method to handle different arguments<br> Add a configuration form if necessary, and add the code to load it in the Main method<br> Modify the main screensaver form so as to display what you want it to<br> Rename the extension from .exe to .scr<br> Go!</p><p>åœ¨Mainå‡½æ•°é‡Œä¿®æ”¹ä»£ç æ¥æ“ä½œä¸åŒçš„å‚æ•°<br> å¦‚æœéœ€è¦å¯ä»¥å¢åŠ ä¸€ä¸ªé…ç½®çª—ä½“ï¼Œç„¶ååœ¨Mainå‡½æ•°é‡Œå¢åŠ ä»£ç æ¥è½½å…¥å®ƒã€‚<br> ä¿®æ”¹å±å¹•ä¿æŠ¤ç¨‹åºçš„ä¸»çª—ä½“ï¼Œä»¥æˆ‘ä»¬å¸Œæœ›çš„æ˜¾ç¤ºæ–¹å¼æ˜¾ç¤ºã€‚<br> æŠŠåç¼€å .exe æ”¹ä¸º .scr<br> å¯åŠ¨ï¼</p><p><strong>Comments by XXin</strong>ï¼š</p><ul><li>[1] åŸæ–‡å‡ºå¤„ï¼šhttp://www.codeproject.com/csharp/scrframework.asp</li><li>[2] æ„Ÿè°¢å¯’æ«å¤©ä¼¤åœ¨ç¿»è¯‘çš„è¿‡ç¨‹ä¸­å¯¹æˆ‘çš„å¸®åŠ©ï¼Œæ„Ÿè°¢ Fantasy Soft å¸®æˆ‘å®¡é˜…åˆè¯‘ç¨¿ï¼Œå¹¶å¸®æˆ‘æ”¹æ­£ä¸€äº›ç¿»è¯‘é”™è¯¯ã€‚</li></ul>`,94),p=[o];function c(i,r){return s(),a("div",null,p)}const u=n(t,[["render",c],["__file","sysop9.html.vue"]]);export{u as default};
