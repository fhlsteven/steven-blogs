import{_ as n,o as s,c as a,a as t}from"./app-f0851ed3.js";const p={},e=t(`<h1 id="给datagrid加上右键菜单" tabindex="-1"><a class="header-anchor" href="#给datagrid加上右键菜单" aria-hidden="true">#</a> 给DataGrid加上右键菜单</h1><blockquote><p>2066（原作） 关键字 vs.net,vb.net,xml,Microsoft Visual Studio .NET,DataGrid,弹出菜单</p></blockquote><p>屠恩海（SunHai）<br> 开发工具：Microsoft Visual Studio .NET 2003<br> 操作系统：Windows XP</p><h2 id="用xml作为datagrid的数据源" tabindex="-1"><a class="header-anchor" href="#用xml作为datagrid的数据源" aria-hidden="true">#</a> 用XML作为DataGrid的数据源</h2><p>代码如下：</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Dim</span> fileName <span class="token keyword">As</span> <span class="token keyword">String</span>
<span class="token keyword">Dim</span> MyXmlDataSet <span class="token keyword">As</span> <span class="token keyword">New</span> DataSet
fileName <span class="token operator">=</span> <span class="token string">&quot;sunhai.xml&quot;</span>
MyXmlDataSet<span class="token punctuation">.</span>ReadXml<span class="token punctuation">(</span>fileName<span class="token punctuation">)</span>
Form1<span class="token punctuation">.</span>DefInstance<span class="token punctuation">.</span>DataGrid1<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> MyXmlDataSet
</code></pre></div><p>启动程序，DataTable默认是闭合的，需要手动点击展开，不胜其烦，用如下代码实现自动展开DataTable:</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> Form1_Load<span class="token punctuation">(</span><span class="token keyword">ByVal</span> sender <span class="token keyword">As</span> <span class="token keyword">Object</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> e <span class="token keyword">As</span> System<span class="token punctuation">.</span>EventArgs<span class="token punctuation">)</span> <span class="token keyword">Handles</span> <span class="token keyword">MyBase</span><span class="token punctuation">.</span>Load

　　DataGrid1<span class="token punctuation">.</span>Expand<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">&#39;要展开的行数，设为-1表示展开所有行</span>
　　DataGrid1<span class="token punctuation">.</span>NavigateTo<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;DataTableName&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><h2 id="获得在datagrid1鼠标右击的座标" tabindex="-1"><a class="header-anchor" href="#获得在datagrid1鼠标右击的座标" aria-hidden="true">#</a> 获得在DataGrid1鼠标右击的座标</h2><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Dim</span> rowNum<span class="token punctuation">,</span> columnNum <span class="token keyword">As</span> <span class="token keyword">Integer</span> <span class="token comment">&#39;分别是行号和列号</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> DataGrid1_MouseDown<span class="token punctuation">(</span><span class="token keyword">ByVal</span> sender <span class="token keyword">As</span> <span class="token keyword">Object</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> e <span class="token keyword">As</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>MouseEventArgs<span class="token punctuation">)</span> <span class="token keyword">Handles</span> DataGrid1<span class="token punctuation">.</span>MouseDown

　　<span class="token keyword">Dim</span> myGrid <span class="token keyword">As</span> DataGrid <span class="token operator">=</span> <span class="token keyword">CType</span><span class="token punctuation">(</span>sender<span class="token punctuation">,</span> DataGrid<span class="token punctuation">)</span>
　　<span class="token keyword">Dim</span> hti <span class="token keyword">As</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>DataGrid<span class="token punctuation">.</span>HitTestInfo
　　hti <span class="token operator">=</span> myGrid<span class="token punctuation">.</span>HitTest<span class="token punctuation">(</span>e<span class="token punctuation">.</span>X<span class="token punctuation">,</span> e<span class="token punctuation">.</span>Y<span class="token punctuation">)</span>

　　<span class="token keyword">If</span> e<span class="token punctuation">.</span>Button <span class="token operator">=</span> MouseButtons<span class="token punctuation">.</span>Right <span class="token keyword">And</span> e<span class="token punctuation">.</span>Clicks <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span> <span class="token comment">&#39;如果是鼠标右击</span>
　　　　 <span class="token keyword">Select</span> <span class="token keyword">Case</span> hti<span class="token punctuation">.</span><span class="token keyword">Type</span> <span class="token comment">&#39;</span>
　　　　　　　<span class="token keyword">Case</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>DataGrid<span class="token punctuation">.</span>HitTestType<span class="token punctuation">.</span>Cell<span class="token punctuation">,</span> 　　　　　　　　System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>DataGrid<span class="token punctuation">.</span>HitTestType<span class="token punctuation">.</span>RowHeader<span class="token punctuation">,</span> 　　　　　　　　System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>DataGrid<span class="token punctuation">.</span>HitTestType<span class="token punctuation">.</span>ColumnHeader

　　　　　　　　 rowNum <span class="token operator">=</span> hti<span class="token punctuation">.</span>Row　　 　　<span class="token comment">&#39;获得鼠标右击所在行</span>
　　　　　　　　　columnNum <span class="token operator">=</span> hti<span class="token punctuation">.</span>Column　<span class="token comment">&#39;获得鼠标右击所在列</span>
　　　　 <span class="token keyword">End</span> <span class="token keyword">Select</span>
　　<span class="token keyword">End</span> <span class="token keyword">If</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><h2 id="添加contextmenu" tabindex="-1"><a class="header-anchor" href="#添加contextmenu" aria-hidden="true">#</a> 添加ContextMenu</h2><p>在设计模式添加ContextMenu1：</p><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>Text 　　　　　Name
删除一行　　　 mnuDeleteRow
插入一行 　　　mnuInsertRow
</code></pre></div><p>把<code>DataGrid1</code>属性中的<code>ContextMenu</code>设为<code>ContextMenu1</code>。</p><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> mnuDeleteRow_Click<span class="token punctuation">(</span><span class="token keyword">ByVal</span> sender <span class="token keyword">As</span> System<span class="token punctuation">.</span><span class="token keyword">Object</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> e <span class="token keyword">As</span> System<span class="token punctuation">.</span>EventArgs<span class="token punctuation">)</span> <span class="token keyword">Handles</span> mnuDeleteRow<span class="token punctuation">.</span>Click
　　MyXmlDataSet<span class="token punctuation">.</span>Tables<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>RemoveAt<span class="token punctuation">(</span>rowNum<span class="token punctuation">)</span>　<span class="token comment">&#39;删除行</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token keyword">Private</span> <span class="token keyword">Sub</span> mnuInsertRow_Click<span class="token punctuation">(</span><span class="token keyword">ByVal</span> sender <span class="token keyword">As</span> System<span class="token punctuation">.</span><span class="token keyword">Object</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> e <span class="token keyword">As</span> System<span class="token punctuation">.</span>EventArgs<span class="token punctuation">)</span> <span class="token keyword">Handles</span> mnuInsertRow<span class="token punctuation">.</span>Click
　　<span class="token keyword">Dim</span> row1 <span class="token keyword">As</span> DataRow <span class="token operator">=</span> MyXmlDataSet<span class="token punctuation">.</span>Tables<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>NewRow
　　MyXmlDataSet<span class="token punctuation">.</span>Tables<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>InsertAt<span class="token punctuation">(</span>row1<span class="token punctuation">,</span> rowNum<span class="token punctuation">)</span>
　　MyXmlDataSet<span class="token punctuation">.</span>AcceptChanges<span class="token punctuation">(</span><span class="token punctuation">)</span>　　<span class="token comment">&#39;不加这句，你会发现所插入行都到“最后”了</span>

<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>怎么在DataTable中插入列呢？请各位指教！<br> 2004年4月27日</p><hr><hr><p><strong>对该文的评论</strong> 人气：63</p><p>zjh135 (2004-4-28 8:57:55)</p><blockquote><p>DATAGRID控件会淘汰掉的，功能不强！！没有PB的表格控件好</p></blockquote><p>largeking (2004-4-28 1:26:02)</p><blockquote><p>不知为什么我的DataGrid下面找不到HitTextInfo这个类啊！！那个高手知道为什么啊！！</p></blockquote>`,23),o=[e];function c(l,k){return s(),a("div",null,o)}const r=n(p,[["render",c],["__file","dg31.html.vue"]]);export{r as default};
