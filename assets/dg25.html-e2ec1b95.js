import{_ as n,o as s,c as a,a as t}from"./app-a2b6e588.js";const p={},o=t(`<h1 id="在网页里可以把datagrid里的数据转到excel里面吗" tabindex="-1"><a class="header-anchor" href="#在网页里可以把datagrid里的数据转到excel里面吗" aria-hidden="true">#</a> 在网页里可以把DataGrid里的数据转到Excel里面吗？</h1><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>主　　题：  在网页里可以把DataGrid里的数据转到Excel里面吗？
作　　者：  weilt (开往春天的地铁)
等　　级：  ^
信 誉 值：  100
所属论坛：  .NET技术 C#
问题点数：  20
回复次数：  3
发表时间：  2003-12-02 16:39:56
</code></pre></div><p>如题：如果可以，又怎么转呢？谢谢先</p><hr><hr><p>回复人： flers(flers) ( 四级(中级)) 信誉：93 2003-12-02 17:07:00 得分:0</p><blockquote></blockquote><div class="language-vb" data-ext="vb"><pre class="language-vb"><code><span class="token comment">&#39;导出数据</span>
<span class="token keyword">Private</span> <span class="token keyword">Sub</span> btn_out_Click<span class="token punctuation">(</span><span class="token keyword">ByVal</span> sender <span class="token keyword">As</span> System<span class="token punctuation">.</span><span class="token keyword">Object</span><span class="token punctuation">,</span> <span class="token keyword">ByVal</span> e <span class="token keyword">As</span> System<span class="token punctuation">.</span>EventArgs<span class="token punctuation">)</span> <span class="token keyword">Handles</span> btn_out<span class="token punctuation">.</span>Click
    <span class="token comment">&#39;导出EXCEL</span>
    <span class="token keyword">If</span> DataGrid1<span class="token punctuation">.</span>Items<span class="token punctuation">.</span>Count <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">Then</span>
        HttpContext<span class="token punctuation">.</span>Current<span class="token punctuation">.</span>Response<span class="token punctuation">.</span>AppendHeader<span class="token punctuation">(</span><span class="token string">&quot;Content-Disposition&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;attachment;filename=OutDate.xls&quot;</span><span class="token punctuation">)</span>
        Response<span class="token punctuation">.</span>ContentType <span class="token operator">=</span> <span class="token string">&quot;application/vnd.ms-excel&quot;</span>
        HttpContext<span class="token punctuation">.</span>Current<span class="token punctuation">.</span>Response<span class="token punctuation">.</span>Charset <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
        HttpContext<span class="token punctuation">.</span>Current<span class="token punctuation">.</span>Response<span class="token punctuation">.</span>ContentEncoding <span class="token operator">=</span> System<span class="token punctuation">.</span>Text<span class="token punctuation">.</span>Encoding<span class="token punctuation">.</span>UTF8
        <span class="token keyword">Me</span><span class="token punctuation">.</span>EnableViewState <span class="token operator">=</span> <span class="token boolean">False</span>
        <span class="token keyword">Dim</span> tw <span class="token keyword">As</span> System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>StringWriter <span class="token operator">=</span> <span class="token keyword">New</span> System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>StringWriter<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">Dim</span> hw <span class="token keyword">As</span> System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>UI<span class="token punctuation">.</span>HtmlTextWriter <span class="token operator">=</span> <span class="token keyword">New</span> System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>UI<span class="token punctuation">.</span>HtmlTextWriter<span class="token punctuation">(</span>tw<span class="token punctuation">)</span>
        DataGrid1<span class="token punctuation">.</span>RenderControl<span class="token punctuation">(</span>hw<span class="token punctuation">)</span>
        HttpContext<span class="token punctuation">.</span>Current<span class="token punctuation">.</span>Response<span class="token punctuation">.</span>Write<span class="token punctuation">(</span>tw<span class="token punctuation">.</span>ToString<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        HttpContext<span class="token punctuation">.</span>Current<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token keyword">End</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Else</span>
        Response<span class="token punctuation">.</span>Write<span class="token punctuation">(</span><span class="token string">&quot;&lt;script&gt;alert(&#39;没有统计出任何数据！&#39;)&lt;/&quot;</span> <span class="token operator">&amp;</span> <span class="token string">&quot;script&gt;&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Me</span><span class="token punctuation">.</span>EnableViewState <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre></div><p>回复人： dahuzizyd(你就是我心中的女神) ( 一星(中级)) 信誉：105 2003-12-02 18:54:00 得分:0</p><blockquote><p>这个是孟老大的：<br><code>http://xml.sz.luohuedu.net/xml/ShowDetail.asp?id=BF0A54F9-C7C7-4200-BD9A-802AC1F5DE50</code></p></blockquote><p>回复人： weilt(开往春天的地铁) ( 一级(初级)) 信誉：100 2003-12-03 09:34:00 得分:0</p><blockquote><p>第一种方法已试过，会把所有网页里面的东西全部转到EXCEL里面，包括那你按纽!</p></blockquote>`,12),e=[o];function c(u,l){return s(),a("div",null,e)}const i=n(p,[["render",c],["__file","dg25.html.vue"]]);export{i as default};
