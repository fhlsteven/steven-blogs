import{_ as e,r as t,o,c as p,b as n,d as s,e as c,a as r}from"./app-a2b6e588.js";const l={},i={id:"把ou中的用户信息当作数据视图使用",tabindex:"-1"},u=n("a",{class:"header-anchor",href:"#把ou中的用户信息当作数据视图使用","aria-hidden":"true"},"#",-1),d={href:"http://www.cnblogs.com/Microtoby/archive/2004/12/07/74095.html",target:"_blank",rel:"noopener noreferrer"},k=r(`<p>Trond Hindenes教给我们一个很方便的方法把保存在AD中的OU用户信息当作数据库视图使用，你可以很方便的使用OU信息，比如建立企业通讯录、开发和其他系统帐号同步程序等。那么让我们仔细看看实现的途径吧：</p><p>首先，你需要在数据库中建立一个链接服务器，打开SQL Server Enterprise Manager Console，展开Security节点，然后是Linked Servers，右键New Linked Server…。在Linked Server文本框中输入一个ADSI，Provider name选择OLE DB Provider for Microsoft Directory Services，OK，关闭对话框。</p><p>然后建立一个新数据库也叫ADSI吧。建立一个View，其内容是：</p><div class="language-sql" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    sAMAccountname <span class="token keyword">AS</span> AccountName<span class="token punctuation">,</span>
    GivenName <span class="token keyword">AS</span> <span class="token punctuation">[</span><span class="token keyword">First</span> Name<span class="token punctuation">]</span><span class="token punctuation">,</span>
    SN <span class="token keyword">AS</span> <span class="token punctuation">[</span><span class="token keyword">Last</span> Name<span class="token punctuation">]</span><span class="token punctuation">,</span>
    mail <span class="token keyword">AS</span> <span class="token punctuation">[</span>E<span class="token operator">-</span>mail Address<span class="token punctuation">]</span><span class="token punctuation">,</span>
    TelephoneNumber <span class="token keyword">AS</span> <span class="token punctuation">[</span>Telephone Number<span class="token punctuation">]</span><span class="token punctuation">,</span>
    l <span class="token keyword">AS</span> Office<span class="token punctuation">,</span>
    PostalAddress <span class="token keyword">AS</span> <span class="token punctuation">[</span>Postal Address<span class="token punctuation">]</span><span class="token punctuation">,</span>
    PostalCode<span class="token punctuation">,</span>
    StreetAddress <span class="token keyword">AS</span> <span class="token punctuation">[</span>Street Address<span class="token punctuation">]</span><span class="token punctuation">,</span>
    wWWHomePage <span class="token keyword">AS</span> <span class="token punctuation">[</span>Web Page<span class="token punctuation">]</span><span class="token punctuation">,</span>
    distinguishedname <span class="token keyword">AS</span> DN  
<span class="token keyword">FROM</span>
    <span class="token keyword">OPENQUERY</span><span class="token punctuation">(</span>
        ADSI<span class="token punctuation">,</span>
        <span class="token string">&#39;SELECT GivenName, SN, company, department, TelephoneNumber, mail, distinguishedname, title, l, manager, mobile, name, PhysicalDeliveryOfficeName, PostalAddress, PostalCode, sAMAccountname, StreetAddress, wWWHomePage FROM &#39;&#39;LDAP://portalcn.com/ OU=Norway ,DC=portalcn,DC=com&#39;&#39; WHERE objectCategory = &#39;&#39;Person&#39;&#39; AND objectClass = &#39;&#39;user&#39;&#39; ORDER BY Name&#39;</span>
    <span class="token punctuation">)</span> Rowset_1
</code></pre></div><p>其中要修改几个位置，<code>LDAP://AD名称/ OU=OU名称, DC=AD名称, DC=com</code>。如果OU是层级结构的，并且希望只取某个子层次中的用户，则可以用OU=上级OU名称, OU=OU名称，以此类推。</p><p>一切就是这么简单，后面的工作就不叙述了，基于数据库视图的编程应该很简单了。</p>`,6);function m(A,S){const a=t("ExternalLinkIcon");return o(),p("div",null,[n("h1",i,[u,s(),n("a",d,[s("把OU中的用户信息当作数据视图使用"),c(a)])]),k])}const w=e(l,[["render",m],["__file","sysctr20.html.vue"]]);export{w as default};
