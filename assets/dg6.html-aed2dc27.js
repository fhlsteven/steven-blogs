import{_ as n,o as a,c as s,a as t}from"./app-f0851ed3.js";const p={},o=t(`<h1 id="datagrid的当前行问题" tabindex="-1"><a class="header-anchor" href="#datagrid的当前行问题" aria-hidden="true">#</a> dataGrid的当前行问题</h1><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>主　　题：  dataGrid的当前行问题
作　　者：  xshmeng (爽爽)  
等　　级：  ^
信 誉 值：  100
所属论坛：  .NET技术 C#
问题点数：  80
回复次数：  11
发表时间：  2003-8-26 14:48:28
</code></pre></div><p>各位老哥，请问一下我把dataGrid连到DataSet的一个DataTable以后，如何取出当前行（当前光标所在的行）的DataRow对象来？</p><hr><hr><p>回复人： wd_318(饭加加) ( 五级(中级)) 信誉：100 2003-8-26 15:00:05 得分:60</p><blockquote></blockquote><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token class-name">DataRow</span> dr<span class="token punctuation">;</span>
<span class="token class-name">BindingManagerBase</span> bm <span class="token operator">=</span> openner<span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>BindingContext<span class="token punctuation">[</span>dataGrid1<span class="token punctuation">.</span>DataSource<span class="token punctuation">,</span> dataGrid1<span class="token punctuation">.</span>DataMember<span class="token punctuation">]</span><span class="token punctuation">;</span>
dr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>DataRowView<span class="token punctuation">)</span>bm<span class="token punctuation">.</span>Current<span class="token punctuation">)</span><span class="token punctuation">.</span>Row<span class="token punctuation">;</span>
MessageBox<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>dr<span class="token punctuation">[</span><span class="token string">&quot;字段名&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>回复人： yaoyaonet(绿洲) ( 四级(中级)) 信誉：100 2003-8-26 15:06:54 得分:4</p><blockquote><p><code>ds.Tables[0].Rows[this.BindingContext[ds,&quot;Table&quot;].Position][字段名].ToString();</code></p></blockquote><p>回复人： greenhill1(小山) ( 三级(初级)) 信誉：100 2003-8-26 15:56:58 得分:4</p><blockquote></blockquote><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button1_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>BindingContext<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thisDataSet<span class="token punctuation">,</span> <span class="token string">&quot;班级&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">SqlConnection</span> thisConnection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span><span class="token string">@&quot;Data Source=SERVER;User ID=sa;Password=;Initial Catalog=dx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thisConnection<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SqlDataAdapter</span> thisAdapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlDataAdapter</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT * FROM 班级&quot;</span><span class="token punctuation">,</span> thisConnection<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SqlCommandBuilder</span> thisBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlCommandBuilder</span><span class="token punctuation">(</span>thisAdapter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DataSet</span> thisDataSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thisAdapter<span class="token punctuation">.</span><span class="token function">Fill</span><span class="token punctuation">(</span>thisDataSet<span class="token punctuation">,</span> <span class="token string">&quot;班级&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DataRow</span> findRow <span class="token operator">=</span> thisDataSet<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token string">&quot;班级&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>CellNu<span class="token punctuation">]</span><span class="token punctuation">;</span>
        findRow<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thisAdapter<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>thisDataSet<span class="token punctuation">,</span> <span class="token string">&quot;班级&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        thisConnection<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">&quot;没有班级可以删除！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> grd班级<span class="token function">_MouseUp</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>MouseEventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">Point</span> pt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>X<span class="token punctuation">,</span> e<span class="token punctuation">.</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">DataGrid<span class="token punctuation">.</span>HitTestInfo</span> hit <span class="token operator">=</span> grd班级<span class="token punctuation">.</span><span class="token function">HitTest</span><span class="token punctuation">(</span>pt<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>hit<span class="token punctuation">.</span>Type <span class="token operator">==</span> DataGrid<span class="token punctuation">.</span>HitTestType<span class="token punctuation">.</span>Cell<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        grd班级<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>hit<span class="token punctuation">.</span>Row<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    CellNu <span class="token operator">=</span> grd班级<span class="token punctuation">.</span>CurrentCell<span class="token punctuation">.</span>RowNumber<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>以上是用鼠标点击某行，然后选中datagrid的某行，然后点击&quot;删除&quot;将你点击的那条记录删除的代码。看看有没有你想要的功能！CellNu=grd班级.CurrentCell.RowNumber这一句获得了你选择的那行的位置。</p></blockquote><p>回复人： greenhill1(小山) ( 三级(初级)) 信誉：100 2003-8-26 16:02:26 得分:4</p><blockquote><p><code>this.BindingContext[this.thisDataSet,&quot;学生&quot;].Position</code>这个是获得当前行的行号。比如datagrid的第一行，这个代码则返回0，第二行，返回1。</p></blockquote><p>回复人： superzuoluo(球星) ( 四级(中级)) 信誉：100 2003-8-26 16:04:27 得分:4</p><blockquote><p>这个简单<br><code>((DataTable)dataGrid1.DataSource).Rows[dataGrid1.CurrentRowIndex]</code></p></blockquote><p>回复人： wjohenw(CSharp) ( 二级(初级)) 信誉：100 2003-8-26 16:29:32 得分:2</p><blockquote><p>呵呵，都这么快</p></blockquote><p>回复人： xshmeng(爽爽) ( 一级(初级)) 信誉：100 2003-8-26 16:32:06 得分:0</p><blockquote><p>不可，我感觉DataTable和DataGrid的索引方式不同，所以不用用Rows[int i]这种方式，因为一旦将表格按别的列排一下序，这种方式就不行了。</p></blockquote><p>回复人： greenhill1(小山) ( 三级(初级)) 信誉：100 2003-8-26 16:37:32 得分:2</p><blockquote><p>可以排序后根据字段信息来查找啊。</p></blockquote><p>回复人： wd_318(饭加加) ( 五级(中级)) 信誉：100 2003-8-26 16:48:06 得分:0</p><blockquote><p>老大，我那段程序是不怕重新排序的呀，<br> 原来我以为这事，在网上找了一星期才找到的方法！</p></blockquote><p>回复人： wd_318(饭加加) ( 五级(中级)) 信誉：100 2003-8-26 16:51:20 得分:0</p><blockquote><p>晕，原来我没改好，还是用多了openner！（我原来是用来操作别的窗口数据的，呵）</p></blockquote><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token class-name">DataRow</span> dr<span class="token punctuation">;</span>
<span class="token class-name">BindingManagerBase</span> bm <span class="token operator">=</span> dataGrid1<span class="token punctuation">.</span>BindingContext<span class="token punctuation">[</span>dataGrid1<span class="token punctuation">.</span>DataSource<span class="token punctuation">,</span> dataGrid1<span class="token punctuation">.</span>DataMember<span class="token punctuation">]</span><span class="token punctuation">;</span>
dr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>DataRowView<span class="token punctuation">)</span>bm<span class="token punctuation">.</span>Current<span class="token punctuation">)</span><span class="token punctuation">.</span>Row<span class="token punctuation">;</span>
MessageBox<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span>dr<span class="token punctuation">[</span><span class="token string">&quot;字段名&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>回复人： xshmeng(爽爽) ( 一级(初级)) 信誉：100 2003-8-26 16:54:52 得分:0</p><blockquote><p>wd_318(饭加加) 老兄，你的办法没有问题，很好，我很高兴。感谢。望多光临。</p></blockquote><p>该问题已经结贴 ，得分记录： wd_318 (60)、 yaoyaonet (4)、 greenhill1 (4)、 greenhill1 (4)、 superzuoluo (4)、 wjohenw (2)、 greenhill1 (2)、</p>`,32),c=[o];function e(u,l){return a(),s("div",null,c)}const k=n(p,[["render",e],["__file","dg6.html.vue"]]);export{k as default};
