import{_ as n,o as s,c as a,a as t}from"./app-a2b6e588.js";const p={},o=t(`<h1 id="åœ¨winformç¨‹åºä¸­åµŒå…¥asp-net" tabindex="-1"><a class="header-anchor" href="#åœ¨winformç¨‹åºä¸­åµŒå…¥asp-net" aria-hidden="true">#</a> åœ¨WinFormç¨‹åºä¸­åµŒå…¥ASP.NET</h1><p>ç°åœ¨çš„æµè¡Œè¶‹åŠ¿æ˜¯æ¡Œé¢ç¨‹åºWebåŒ–ï¼ŒWebç¨‹åºæ¡Œé¢åŒ–ï¼Œå‘µå‘µã€‚æœ€ç»ˆç›®æ ‡å°±æ˜¯ä½ ä¸­æœ‰æˆ‘ï¼Œæˆ‘ä¸­æœ‰ä½ ã€‚ä¾‹å¦‚MSN Explorerå°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å±•ç¤ºï¼Œè®©ç”¨æˆ·åœ¨ä½¿ç”¨çš„æ—¶å€™åˆ†ä¸æ¸…ä»€ä¹ˆæ—¶å€™æ˜¯åœ¨æœ¬åœ°ä»€ä¹ˆæ—¶å€™æ˜¯åœ¨ç½‘ç»œã€‚è€Œè¿™ç±»ç¨‹åºå¾€å¾€éœ€è¦æœ‰ä¸€ä¸ªåå°æœåŠ¡å™¨å¦‚IISçš„æ”¯æŒï¼Œè¿™å¯¹å¤§å¤šæ•°æ¡Œé¢åº”ç”¨æ¥è¯´too heavyäº†ã€‚æœ¬ç€ç®€å•å°±æ˜¯ç¾çš„è®¾è®¡æ€æƒ³ï¼Œè¿™é‡Œç»™å‡ºä¸€ä¸ªè½»é‡çº§çš„è§£å†³æ–¹æ³•ï¼ŒæŠŠASP.NETåµŒå…¥åˆ°æ™®é€šWinFormæ¡Œé¢ç¨‹åºä¸­å»ã€‚</p><p>å› ä¸ºå®‰å…¨ä»¥åŠå…¶å®ƒä¸€äº›æ–¹é¢çš„åŸå› ï¼Œåœ¨ä½¿ç”¨ASP.NETå¼•æ“ä¹‹å‰ï¼Œå¿…é¡»å»ºç«‹ä¸€ä¸ªæ–°çš„AppDomainã€‚ç®€å•çš„æ–¹æ³•æ˜¯ç›´æ¥ä½¿ç”¨ApplicationHost.CreateApplicationHostå‡½æ•°ä¸ºæŒ‡å®šçš„è™šæ‹Ÿç›®å½•å’Œç‰©ç†è·¯å¾„å»ºç«‹ASP.NETå¼•æ“å®¿ä¸»çš„å®ä¾‹ï¼Œå¦‚</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token comment">// should create a subdirectory ./bin and copy the assembly to it</span>
<span class="token keyword">static</span> <span class="token keyword">public</span> <span class="token return-type class-name">WebHost</span> <span class="token function">Create</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> path<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>name<span class="token punctuation">.</span><span class="token function">StartsWith</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span>AltDirectorySeparatorChar<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        name <span class="token operator">=</span> Path<span class="token punctuation">.</span>AltDirectorySeparatorChar <span class="token operator">+</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">WebHost</span> host <span class="token operator">=</span> <span class="token punctuation">(</span>WebHost<span class="token punctuation">)</span>ApplicationHost<span class="token punctuation">.</span><span class="token function">CreateApplicationHost</span><span class="token punctuation">(</span>
        <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">WebHost</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span>

    host<span class="token punctuation">.</span><span class="token function">setVirtualDirectory</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    host<span class="token punctuation">.</span><span class="token function">setBaseDirectory</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> host<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä½†è¿™æ ·å»ºç«‹çš„ç¨‹åºæœ‰ä¸ªBTçš„è¦æ±‚ï¼Œä»–ä¼šåœ¨æŒ‡å®šç›®å½•çš„binå­ç›®å½•ä¸­å»å°è¯•è½½å…¥å®¿ä¸»ç±»å‹(WebHost)çš„assemblyï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¿…é¡»æŠŠç¨‹åºåœ¨binå­ç›®å½•ä¸‹å¤åˆ¶ä¸€ä»½ï¼Œéå¸¸ä¸çˆ½ã€‚è§£å†³æ–¹æ³•æ˜¯è‡ªå·±æ‰‹å·¥å®Œæˆæ•´ä¸ªå»ºç«‹è¿‡ç¨‹ï¼Œå¦‚ä¸‹ï¼š</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">static</span> <span class="token keyword">public</span> <span class="token return-type class-name">WebHost</span> <span class="token function">Create</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> virtualDir<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> physicalDir<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>virtualDir<span class="token punctuation">.</span><span class="token function">StartsWith</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span>AltDirectorySeparatorChar<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    virtualDir <span class="token operator">=</span> Path<span class="token punctuation">.</span>AltDirectorySeparatorChar <span class="token operator">+</span> virtualDir<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>physicalDir<span class="token punctuation">.</span><span class="token function">EndsWith</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span>DirectorySeparatorChar<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    physicalDir <span class="token operator">+=</span> Path<span class="token punctuation">.</span>DirectorySeparatorChar<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token class-name">AppDomainSetup</span> setup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AppDomainSetup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  setup<span class="token punctuation">.</span>ApplicationName <span class="token operator">=</span> <span class="token string">&quot;APP_&quot;</span> <span class="token operator">+</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  setup<span class="token punctuation">.</span>ConfigurationFile <span class="token operator">=</span> <span class="token string">&quot;web.config&quot;</span><span class="token punctuation">;</span>
  <span class="token class-name">AppDomain</span> domain <span class="token operator">=</span> AppDomain<span class="token punctuation">.</span><span class="token function">CreateDomain</span><span class="token punctuation">(</span><span class="token string">&quot;ASPHOST_&quot;</span> <span class="token operator">+</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> setup<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  domain<span class="token punctuation">.</span><span class="token function">SetData</span><span class="token punctuation">(</span><span class="token string">&quot;.appDomain&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  domain<span class="token punctuation">.</span><span class="token function">SetData</span><span class="token punctuation">(</span><span class="token string">&quot;.appPath&quot;</span><span class="token punctuation">,</span> physicalDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
  domain<span class="token punctuation">.</span><span class="token function">SetData</span><span class="token punctuation">(</span><span class="token string">&quot;.appVPath&quot;</span><span class="token punctuation">,</span> virtualDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
  domain<span class="token punctuation">.</span><span class="token function">SetData</span><span class="token punctuation">(</span><span class="token string">&quot;.domainId&quot;</span><span class="token punctuation">,</span> domain<span class="token punctuation">.</span>FriendlyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  domain<span class="token punctuation">.</span><span class="token function">SetData</span><span class="token punctuation">(</span><span class="token string">&quot;.hostingVirtualPath&quot;</span><span class="token punctuation">,</span> virtualDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
  domain<span class="token punctuation">.</span><span class="token function">SetData</span><span class="token punctuation">(</span><span class="token string">&quot;.hostingInstallDir&quot;</span><span class="token punctuation">,</span> HttpRuntime<span class="token punctuation">.</span>AspInstallDirectory<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">WebHost</span> host <span class="token operator">=</span> <span class="token punctuation">(</span>WebHost<span class="token punctuation">)</span>domain<span class="token punctuation">.</span><span class="token function">CreateInstanceAndUnwrap</span><span class="token punctuation">(</span>
    <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">WebHost</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Module<span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>FullName<span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">WebHost</span><span class="token punctuation">)</span><span class="token punctuation">.</span>FullName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  host<span class="token punctuation">.</span><span class="token function">setApplicationDomain</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">;</span>
  host<span class="token punctuation">.</span><span class="token function">setVirtualDirectory</span><span class="token punctuation">(</span>virtualDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
  host<span class="token punctuation">.</span><span class="token function">setBaseDirectory</span><span class="token punctuation">(</span>physicalDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> host<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™å„¿çš„ä¸€å †domain.SetDataæ˜¯ä¼ é€’å‚æ•°ç»™ASP.NETå¼•æ“ã€‚ç„¶ååœ¨é‚£ä¸ªappdomainä¸­å»ºç«‹æ–°çš„å®¿ä¸»ç±»å‹çš„å®ä¾‹ã€‚è¿™æ ·å°±é¿å…å¤šä»½ä»£ç çš„å°´å°¬ã€‚è€Œä½¿ç”¨ASP.NETå°±æ¯”è¾ƒç®€å•äº†ï¼Œåœ¨å®¿ä¸»ç±»ä¸­ä½¿ç”¨HttpRuntime.ProcessRequestå‡½æ•°å¤„ç†ç‰¹å®šè¯·æ±‚ã€‚ç®€å•ä¸€ç‚¹çš„è¯ï¼Œå¯ä»¥ç›´æ¥ç”¨SimpleWorkerRequeståŒ…è£…è¯·æ±‚ï¼Œç”Ÿæˆé¡µé¢åˆ°ä¸€ä¸ªæŒ‡å®šçš„TextWriterä¸­ï¼Œå¦‚</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DoRequest</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> page<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> query<span class="token punctuation">,</span> <span class="token class-name">TextWriter</span> writer<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  HttpRuntime<span class="token punctuation">.</span><span class="token function">ProcessRequest</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">SimpleWorkerRequest</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> query<span class="token punctuation">,</span> writer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">RequestPage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> page<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> query<span class="token punctuation">,</span> <span class="token class-name">Stream</span> stream<span class="token punctuation">)</span>
<span class="token punctuation">{</span>      
  <span class="token function">DoRequest</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> query<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StreamWriter</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">RequestPage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> page<span class="token punctuation">,</span> <span class="token class-name">Stream</span> stream<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token function">RequestPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">RequestPage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> page<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> query<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">using</span><span class="token punctuation">(</span><span class="token class-name">StringWriter</span> writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      
  <span class="token punctuation">{</span>
    <span class="token function">DoRequest</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> query<span class="token punctuation">,</span> writer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> writer<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">RequestPage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> page<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">RequestPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™ä¸ªç¼ºçœçš„è¯·æ±‚åŒ…è£…ä½¿ç”¨æ˜¯ç®€å•ï¼Œä½†å¯¹ä¸­æ–‡çš„å…¼å®¹æ€§ä¸å¤ªå¥½ï¼Œè¿‡ä¸¤å¤©æœ‰ç©ºå†è‡ªå·±å†™ä¸ªå¼ºä¸€ç‚¹çš„å§ï¼Œå‘µå‘µ</p><p>æœ€ç»ˆç±»çš„ä½¿ç”¨å°±æ¯”è¾ƒç®€å•äº†ï¼Œåœ¨WinFormç¨‹åºä¸­å»ºç«‹ä¸€ä¸ªsingletonæ¨¡å¼çš„å±æ€§</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">static</span> <span class="token keyword">private</span> <span class="token class-name">WebHost<span class="token punctuation">.</span>WebHost</span> _host <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token return-type class-name">WebHost<span class="token punctuation">.</span>WebHost</span> Host
<span class="token punctuation">{</span>
  <span class="token keyword">get</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>_host <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      _host <span class="token operator">=</span> WebHost<span class="token punctuation">.</span>WebHost<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> _host<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç„¶åè¯·æ±‚æŒ‡å®šçš„asp.neté¡µé¢ï¼Œå¦‚</p><p><code>HTML = Host.RequestPage(_page);</code></p><p>å³å¯å®Œæˆä»åŠ¨æ€çš„asp.netè„šæœ¬åˆ°é™æ€htmlçš„è½¬æ¢ã€‚åµŒå…¥WinFormç¨‹åºä¸­ï¼Œè¿˜å¯ä»¥é€šè¿‡Hostç±»å‹å®Œæˆä¸¤è€…ä¹‹é—´çš„åŒå‘é€šè®¯ï¼Œå®ç°äº’ç›¸æ§åˆ¶ã€‚ä¸‹æ¬¡æœ‰ç©ºç»§ç»­ï¼Œå‘µå‘µ</p><p>å‚è€ƒèµ„æ–™ï¼š</p><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>1.Using the ASP.Net Runtime for extending desktop applications with dynamic HTML Scripts
  ::URL::http://www.west-wind.com/presentations/aspnetruntime/aspnetruntime.asp 

2.Executing ASMX files without a web server 
  ::URL::http://radio.weblogs.com/0105476/stories/2002/10/24/executingAsmxFilesWithoutAWebServer.html 

3.ASP. NET Client-side Hosting with Cassini
  ::URL::http://msdn.microsoft.com/msdnmag/issues/03/01/CuttingEdge/ 

4.Using ASP.NET Runtime in Desktop Applications 
  ::URL::http://www.codeguru.com/cs_internet/UsingAspRuntime.html 
</code></pre></div><hr><p>æ”¾ä¸‹</p><p>flier_lu å‘è¡¨äº &gt;2004-2-9 20:32:17â† ä¿å­˜è¯¥æ—¥å¿—åˆ°æœ¬åœ°</p><hr><hr><p>ä½œè€…ï¼šKriss</p><blockquote><p>å¤§ä¾ æœ‰ç©ºè¿˜æ˜¯å†™ä¸ªåŠŸèƒ½å®Œå–„ç‚¹çš„WEBå®¿ä¸»å§ï¼šï¼‰<br> cassinié‡Œçš„é‚£ä¸ªæ˜¯é’ˆå¯¹httpå’Œsocketçš„ï¼Œæˆ‘ä¼¼ä¹ç”¨ä¸åˆ°å•Š<br> æˆ‘æ˜¯åœ¨ä¸€ä¸ªç±»ä¼¼äºæ–°é—»ç³»ç»Ÿé‡Œç”¨åˆ°ï¼Œå‡†å¤‡æ ¹æ®ASPXæ–‡ä»¶äº§ç”ŸHTMLæ–‡ä»¶ï¼Œæ‰€ä»¥åªè¦ç”¨è¿™ä¸ªå®¿ä¸»æŠŠè§£æç»“æœå­˜èµ·æ¥å°±è¡Œäº†<br> ç°åœ¨çš„é—®é¢˜è¿˜æ˜¯å­ç›®å½•çš„é—®é¢˜<br> å®åœ¨ä¸è¡Œå°±åªå¥½æŠŠæ–‡ä»¶ç§»åˆ°æ ¹ç›®å½•è§£æäº†ï¼šï¼ˆ<br><br><br> flier_lu åœ¨ Kriss çš„æ–‡ç« ä¸­å›å¤é“ï¼š<br> å‘µå‘µï¼Œåˆ—å…¥è®¡åˆ’å§ï¼ŒæŠ€æœ¯ä¸Šæ˜¯é—®é¢˜ä¸å¤§çš„ã€‚ä¸è¿‡æœ€è¿‘æ‰‹å¤´å·¥ä½œæ¯”è¾ƒå¿™ï¼Œä¸€å †æŠ€æœ¯é¢„ç ”å·¥ä½œå’ŒBLogçš„åŠŸè¯¾è¦åšï¼Œåªèƒ½è¯´äº‰å–äº† ğŸ˜›</p></blockquote><p>ä½œè€…ï¼šKriss</p><blockquote><p>ä½†è¿™æ ·è§£å†³ä¼¼ä¹ä»æœ‰ä¸€ä¸ªé—®é¢˜ï¼ŒCreate(vPath,pPath) åˆ›å»ºçš„æ˜¯ä¸€ä¸ªWebåº”ç”¨ç¨‹åºå®¿ä¸»ï¼Œè‚¯å®šä¼šåœ¨å…¶ç›®å½•å¯»æ‰¾dllä»¥åŠweb.configç­‰æ–‡ä»¶ã€‚å¦‚æœæˆ‘æŒ‡å®šç›®å½•ä¸º d:hooyeehelpï¼Œé‚£helpå› ä¸ºä¸æ˜¯ç‹¬ç«‹çš„webåº”ç”¨ç¨‹åºï¼Œåº”è¯¥ä¼šå‡ºé”™ï¼Œè¯´æ‰¾ä¸åˆ°dllå’Œweb.config<br><br> æˆ‘ä»asp.netç½‘ç«™ä¸‹è½½è¿‡å¾®è½¯è‡ªå·±çš„é‚£ä¸ªWEBå®¿ä¸»çš„ä¾‹å­çœ‹è¿‡ï¼Œå®ƒé‚£é‡Œåˆ›å»ºå¥½å®¿ä¸»åï¼Œå¥½åƒæ˜¯å¯ä»¥è®¿é—®ç›´æ¥å­ç›®å½•çš„æ–‡ä»¶çš„<br><br><br> flier_lu åœ¨ Kriss çš„æ–‡ç« ä¸­å›å¤é“ï¼š<br> ä½ æ˜¯æŒ‡ ASP.NET ä¸Šå®ç°çš„ cassini é‚£ä¸ª ASP.NET å®¿ä¸» Web æœåŠ¡å™¨çš„ä¾‹å­å—ï¼Ÿäººå®¶å¯ä»¥å®ç°äº†ä¸€ä¸ªå®Œæ•´çš„ SimpleWorkerRequest çš„å­ç±»ï¼Œè€Œæˆ‘ä¾‹å­ä¸­å·æ‡’ç›´æ¥ç”¨SimpleWorkerRequest å®Œæˆï¼ŒåŠŸèƒ½ä¸Šå½“ç„¶ä¼šæœ‰å¾ˆå¤§å·®è·ï¼Œå‘µå‘µï¼Œå·®äº†è¿‘åƒè¡Œä»£ç å‘¢ ğŸ˜›</p></blockquote><p>ä½œè€…ï¼šKriss</p><blockquote><p>æˆ‘ä½¿ç”¨äº†è¿™ä¸ªæ–¹æ³•ï¼Œåˆ©ç”¨WebHostä»aspxäº§ç”Ÿé™æ€htmlï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœæˆ‘è¯·æ±‚çš„æ–‡ä»¶ä¸æ˜¯é»˜è®¤è·¯å¾„ï¼Œè€Œæ˜¯æŸä¸ªå­ç›®å½•ä¸‹é¢çš„ï¼Œä¼šå‡ºç°æ— æ³•æ‰¾åˆ°aspxæ–‡ä»¶çš„ä¿¡æ¯ï¼š</p></blockquote><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token class-name">WebHost</span> host <span class="token operator">=</span> WebHost<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token string">&quot;/hooyee&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;c:\\hooyee\\web&quot;</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">string</span></span> html<span class="token punctuation">;</span>
html <span class="token operator">=</span> host<span class="token punctuation">.</span><span class="token function">RequestPage</span><span class="token punctuation">(</span><span class="token string">&quot;Default.aspx&quot;</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>è¿™æ ·æ˜¯æ²¡æœ‰é—®é¢˜çš„<br><code>html = host.RequestPage(&quot;Help/Default.aspx&quot;;</code><br> è¿™æ ·äº§ç”Ÿçš„HTMLæ–‡æœ¬é‡Œæ˜¯é”™è¯¯ä¿¡æ¯ï¼š404é”™è¯¯ï¼Œæ— æ³•æ‰¾åˆ°æŒ‡å®šèµ„æº<br> æˆ‘æŸ¥äº†ä¸€äº›æ–‡ç« ä½†è¿˜æ˜¯æ‰¾ä¸åˆ°è§£å†³æ–¹æ³•ã€‚ç‰¹æ¥è¯·æ•™<br><br> å¦å¤–ï¼Œä¸­æ–‡é—®é¢˜æˆ‘ä¹Ÿç¢°åˆ°äº†ï¼Œå¦‚æœä»RequestPageä¸­è·å– Stream çš„è¯ï¼Œä¸­æ–‡æ˜¯ä¹±ç ã€‚ä½†å¦‚æœåˆ©ç”¨ä¸Šé¢çš„æ–¹æ³•ï¼Œå…ˆè¿”å›åˆ° string ,å†æŠŠè¿™ä¸ªstringä¿å­˜åˆ°æ–‡ä»¶é‡Œï¼Œå°±æ²¡æœ‰é—®é¢˜äº†ã€‚æœ‰æ²¡æœ‰åˆ«çš„è§£å†³æ–¹æ¡ˆï¼Ÿ<br><br><br> flier_lu åœ¨ Kriss çš„æ–‡ç« ä¸­å›å¤é“ï¼š<br> è¿™ä¸ª404é”™è¯¯çš„åŸå› æ˜¯ä½ æŒ‡å®šè™šæ‹Ÿè·¯å¾„çš„åœ°æ–¹é”™è¯¯ã€‚host.RequestPageçš„å‚æ•°åº”è¯¥åªæ˜¯é¡µé¢çš„åå­—ï¼Œå¦‚æœéœ€è¦æ‰“å¼€å­ç›®å½•ä¸‹é¡µé¢ï¼Œåˆ™åº”è¯¥åœ¨WebHost.Createä¸‹é¢æŒ‡å®šï¼Œå¦‚å°†<br><br><code>WebHost host = WebHost.Create(&quot;/hooyee&quot;,&quot;c:\\hooyee\\web&quot;);</code><br><br> æ”¹ä¸º<br><br><code>WebHost host = WebHost.Create(&quot;/hooyee&quot;,&quot;c:\\hooyee\\web\\Help&quot;);</code><br><br> å°±å¯ä»¥æ‰“å¼€ Help å­ç›®å½•ä¸‹çš„é¡µé¢äº†<br><br> è‡³äºé‚£ä¸ªä¸­æ–‡é—®é¢˜ï¼Œæˆ‘ç°åœ¨ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¥½çš„è§£å†³åŠæ³•ï¼Œå¸Œæœ›ç­‰æœ‰ç©ºæŠŠASP.NETçš„æœºåˆ¶å®Œæ•´åˆ†æä¸€éåï¼Œèƒ½æ‰¾åˆ°è§£å†³æ–¹æ³•ã€‚ğŸ˜ƒ</p></blockquote><p>ä½œè€…ï¼šlionsky_net@hotmail.com</p><blockquote><p>å“¦ï¼Œä¸€æ—¶é©¬è™ï¼Œæ²¡æœ‰æ³¨æ„åˆ°ï¼Œå‘µå‘µ</p></blockquote><p>ä½œè€…ï¼šlionskynet_@hotmail.com</p><blockquote><p>å¥½æ–‡ç« ï¼Œä¸è¿‡ä¸ºä»€ä¹ˆæˆ‘çš„SDKæ‰¾ä¸åˆ°WebHostï¼Ÿ<br><br><br> flier_lu åœ¨ lionskynet_@hotmail.com çš„æ–‡ç« ä¸­å›å¤é“ï¼š<br> è¿™ä¸ªWebHostæ˜¯æˆ‘è‡ªå·±å†™çš„ä¸€ä¸ªç®€å•çš„åŒ…è£…ç±»å•Šï¼Œå‘µå‘µã€‚ä¸»è¦æ˜¯å¯¹hostçš„å»ºç«‹å’Œé¡µé¢è¯·æ±‚åšäº†ç®€å•çš„å°è£…ã€‚<br><br> ä»¥ä¸‹ä¸ºå¼•ç”¨ï¼š<br></p></blockquote><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>IO</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Text</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Web</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>Hosting</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>Remoting</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">Navigator<span class="token punctuation">.</span>WebHost</span>
<span class="token punctuation">{</span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
<span class="token doc-comment comment">/// Summary description for WebHost.</span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebHost</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MarshalByRefObject</span></span>
<span class="token punctuation">{</span>    
  <span class="token preprocessor property">#<span class="token directive keyword">if</span> false</span>
    <span class="token comment">// should create a subdirectory ./bin and copy the assembly to it</span>
    <span class="token keyword">static</span> <span class="token keyword">public</span> <span class="token return-type class-name">WebHost</span> <span class="token function">Create</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> path<span class="token punctuation">)</span>
    <span class="token punctuation">{</span> 
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>name<span class="token punctuation">.</span><span class="token function">StartsWith</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span>AltDirectorySeparatorChar<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        name <span class="token operator">=</span> Path<span class="token punctuation">.</span>AltDirectorySeparatorChar <span class="token operator">+</span> name<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
 
      <span class="token class-name">WebHost</span> host <span class="token operator">=</span> <span class="token punctuation">(</span>WebHost<span class="token punctuation">)</span>ApplicationHost<span class="token punctuation">.</span><span class="token function">CreateApplicationHost</span><span class="token punctuation">(</span>
        <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">WebHost</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span>

      host<span class="token punctuation">.</span><span class="token function">setVirtualDirectory</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
      host<span class="token punctuation">.</span><span class="token function">setBaseDirectory</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">return</span> host<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token preprocessor property">#<span class="token directive keyword">else</span></span>
    <span class="token keyword">static</span> <span class="token keyword">public</span> <span class="token return-type class-name">WebHost</span> <span class="token function">Create</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> virtualDir<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> physicalDir<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>virtualDir<span class="token punctuation">.</span><span class="token function">StartsWith</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span>AltDirectorySeparatorChar<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        virtualDir <span class="token operator">=</span> Path<span class="token punctuation">.</span>AltDirectorySeparatorChar <span class="token operator">+</span> virtualDir<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>physicalDir<span class="token punctuation">.</span><span class="token function">EndsWith</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">string</span></span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span>DirectorySeparatorChar<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        physicalDir <span class="token operator">+=</span> Path<span class="token punctuation">.</span>DirectorySeparatorChar<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token class-name">AppDomainSetup</span> setup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AppDomainSetup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      setup<span class="token punctuation">.</span>ApplicationName <span class="token operator">=</span> <span class="token string">&quot;APP_&quot;</span> <span class="token operator">+</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      setup<span class="token punctuation">.</span>ConfigurationFile <span class="token operator">=</span> <span class="token string">&quot;web.config&quot;</span><span class="token punctuation">;</span>

      <span class="token class-name">AppDomain</span> domain <span class="token operator">=</span> AppDomain<span class="token punctuation">.</span><span class="token function">CreateDomain</span><span class="token punctuation">(</span><span class="token string">&quot;ASPHOST_&quot;</span> <span class="token operator">+</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> setup<span class="token punctuation">)</span><span class="token punctuation">;</span>
      
      domain<span class="token punctuation">.</span><span class="token function">SetData</span><span class="token punctuation">(</span><span class="token string">&quot;.appDomain&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">;</span>
      domain<span class="token punctuation">.</span><span class="token function">SetData</span><span class="token punctuation">(</span><span class="token string">&quot;.appPath&quot;</span><span class="token punctuation">,</span> physicalDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
      domain<span class="token punctuation">.</span><span class="token function">SetData</span><span class="token punctuation">(</span><span class="token string">&quot;.appVPath&quot;</span><span class="token punctuation">,</span> virtualDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
      domain<span class="token punctuation">.</span><span class="token function">SetData</span><span class="token punctuation">(</span><span class="token string">&quot;.domainId&quot;</span><span class="token punctuation">,</span> domain<span class="token punctuation">.</span>FriendlyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
      domain<span class="token punctuation">.</span><span class="token function">SetData</span><span class="token punctuation">(</span><span class="token string">&quot;.hostingVirtualPath&quot;</span><span class="token punctuation">,</span> virtualDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
      domain<span class="token punctuation">.</span><span class="token function">SetData</span><span class="token punctuation">(</span><span class="token string">&quot;.hostingInstallDir&quot;</span><span class="token punctuation">,</span> HttpRuntime<span class="token punctuation">.</span>AspInstallDirectory<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token class-name">WebHost</span> host <span class="token operator">=</span> <span class="token punctuation">(</span>WebHost<span class="token punctuation">)</span>domain<span class="token punctuation">.</span><span class="token function">CreateInstanceAndUnwrap</span><span class="token punctuation">(</span>
        <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">WebHost</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Module<span class="token punctuation">.</span>Assembly<span class="token punctuation">.</span>FullName<span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">WebHost</span><span class="token punctuation">)</span><span class="token punctuation">.</span>FullName<span class="token punctuation">)</span><span class="token punctuation">;</span>

      host<span class="token punctuation">.</span><span class="token function">setApplicationDomain</span><span class="token punctuation">(</span>domain<span class="token punctuation">)</span><span class="token punctuation">;</span>
      host<span class="token punctuation">.</span><span class="token function">setVirtualDirectory</span><span class="token punctuation">(</span>virtualDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
      host<span class="token punctuation">.</span><span class="token function">setBaseDirectory</span><span class="token punctuation">(</span>physicalDir<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">return</span> host<span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
  <span class="token preprocessor property">#<span class="token directive keyword">endif</span></span>

    <span class="token keyword">static</span> <span class="token keyword">public</span> <span class="token return-type class-name">WebHost</span> <span class="token function">Create</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">Create</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> Environment<span class="token punctuation">.</span>CurrentDirectory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">public</span> <span class="token return-type class-name">WebHost</span> <span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">Create</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">,</span> Environment<span class="token punctuation">.</span>CurrentDirectory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  
    <span class="token keyword">private</span> <span class="token class-name">AppDomain</span> _appDomain <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">string</span></span> _virtualDir<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">string</span></span> _baseDir<span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">setApplicationDomain</span><span class="token punctuation">(</span><span class="token class-name">AppDomain</span> domain<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      _appDomain <span class="token operator">=</span> domain<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">setVirtualDirectory</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> dir<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      _virtualDir <span class="token operator">=</span> dir<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">setBaseDirectory</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> dir<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      _baseDir <span class="token operator">=</span> dir<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name">AppDomain</span> ApplicationDomain
    <span class="token punctuation">{</span>
      <span class="token keyword">get</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">return</span> _appDomain<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> VirtualDirectory
    <span class="token punctuation">{</span>
      <span class="token keyword">get</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">return</span> _virtualDir<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> BaseDirectory
    <span class="token punctuation">{</span>
      <span class="token keyword">get</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">return</span> _baseDir<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">DoRequest</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> page<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> query<span class="token punctuation">,</span> <span class="token class-name">TextWriter</span> writer<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      HttpRuntime<span class="token punctuation">.</span><span class="token function">ProcessRequest</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">SimpleWorkerRequest</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> query<span class="token punctuation">,</span> writer<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">RequestPage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> page<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> query<span class="token punctuation">,</span> <span class="token class-name">Stream</span> stream<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>      
      <span class="token function">DoRequest</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> query<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StreamWriter</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">RequestPage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> page<span class="token punctuation">,</span> <span class="token class-name">Stream</span> stream<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token function">RequestPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">RequestPage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> page<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> query<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">using</span><span class="token punctuation">(</span><span class="token class-name">StringWriter</span> writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      
      <span class="token punctuation">{</span>
        <span class="token function">DoRequest</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> query<span class="token punctuation">,</span> writer<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> writer<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">RequestPage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> page<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">RequestPage</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>`,34),e=[o];function c(u,l){return s(),a("div",null,e)}const i=n(p,[["render",c],["__file","netinter6.html.vue"]]);export{i as default};
