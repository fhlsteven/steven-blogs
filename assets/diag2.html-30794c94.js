import{_ as n,o as s,c as a,a as t}from"./app-a2b6e588.js";const p="/steven-blogs/assets/diag2_1-bf8e335a.png",o="/steven-blogs/assets/diag2_2-5f51afaa.png",e="/steven-blogs/assets/diag2_3-7113323a.png",c="/steven-blogs/assets/diag2_4-2726b9c4.png",l="/steven-blogs/assets/diag2_5-7fac6edc.png",u="/steven-blogs/assets/diag2_6-371b947b.png",i="/steven-blogs/assets/diag2_7-50019d61.png",k={},r=t(`<h1 id="全面掌握c-中的对话框" tabindex="-1"><a class="header-anchor" href="#全面掌握c-中的对话框" aria-hidden="true">#</a> 全面掌握C＃中的对话框</h1><p>在编程中经常使用到的对话框大致有六个，他们分别是：&quot;选择文件对话框&quot;、&quot;保存文件对话框&quot;、&quot;颜色对话框&quot;、&quot;打印预览对话框&quot;、&quot;打印机选择对话框&quot;和&quot;字体选择对话框&quot;。那么在C＃是否也有相应的对话框？答案是存在的。那么在C＃中如何使用？本文就来探讨一下这个问题。</p><h2 id="一-本文介绍的程序设计和运行的软件环境" tabindex="-1"><a class="header-anchor" href="#一-本文介绍的程序设计和运行的软件环境" aria-hidden="true">#</a> 一． 本文介绍的程序设计和运行的软件环境</h2><p>（1）.微软公司视窗2000服务器版<br> （2）..Net FrameWork SDK Beta 2</p><h2 id="二-选择文件对话框" tabindex="-1"><a class="header-anchor" href="#二-选择文件对话框" aria-hidden="true">#</a> 二． 选择文件对话框</h2><p>在命名空间System.Windows.Froms中封装了一个类（Class）&quot;OpenFileDialog&quot;，在C＃中的选择文件对话框就是继承这个类。下列代码是创建一个此类的对象：</p><p><code>OpenFileDialog openFileDialog1 = new OpenFileDialog();</code></p><p>（1）.选择文件对话框一些常用的属性：</p><p>选择文件对话框的常用属性如下表：</p><table><thead><tr><th>属性名称</th><th>作用</th></tr></thead><tbody><tr><td>InitialDirectory</td><td>设置在对话框中显示的初始化目录</td></tr><tr><td>Filter</td><td>设定对话框中过滤文件字符串</td></tr><tr><td>FilterIndex</td><td>设定显示的过滤字符串的索引</td></tr><tr><td>RestoreDirectory</td><td>布尔型，设定是否重新回到关闭此对话框时候的当前目录</td></tr><tr><td>FileName</td><td>设定在对话框中选择的文件名称</td></tr><tr><td>ShowHelp</td><td>设定在对话框中是否显示&quot;帮助&quot;按钮</td></tr><tr><td>Title</td><td>设定对话框的标题</td></tr></tbody></table><p>（2）.创建一个功能相对完整的选择文件对话框的对象：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token comment">//定义一个&quot;打开文件对话框&quot;</span>
<span class="token class-name">OpenFileDialog</span> openFileDialog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OpenFileDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//定义此对话框的初始化目录</span>
openFileDialog1<span class="token punctuation">.</span>InitialDirectory <span class="token operator">=</span> <span class="token string">&quot;c:\\\\&quot;</span> <span class="token punctuation">;</span>
<span class="token comment">//定义此对话框文件过滤类型</span>
openFileDialog1<span class="token punctuation">.</span>Filter<span class="token operator">=</span> <span class="token string">&quot;txt files(*.txt)|*.txt|All files (*.*)|*.*&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//此对话框缺省过滤类型为第二个</span>
openFileDialog1<span class="token punctuation">.</span>FilterIndex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
openFileDialog1<span class="token punctuation">.</span>RestoreDirectory <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>openFileDialog1<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> DialogResult<span class="token punctuation">.</span>OK<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    fName <span class="token operator">=</span> openFileDialog1<span class="token punctuation">.</span>FileName<span class="token punctuation">;</span>
    <span class="token function">showInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StreamReader</span><span class="token punctuation">(</span>fName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>  
</code></pre></div><p>此代码编译后的运行的界面如下：</p><p><img src="`+p+`" alt="diag2_1"><br> 图01：C＃创建一个选择文件对话框对象</p><h2 id="三-选择字体对话框" tabindex="-1"><a class="header-anchor" href="#三-选择字体对话框" aria-hidden="true">#</a> 三． 选择字体对话框</h2><p>在命名空间System.Windows.Froms中封装了一个类（Class）&quot;FontDialog&quot;，在C＃中的通过继承此类得到字体对话框的。下列代码是创建一个此类的对象：</p><p><code>FontDialog fontDialog1 = new FontDialog () ;</code></p><p>（1）.字体对话框的一些常用的属性：</p><table><thead><tr><th>属性名称</th><th>作用</th></tr></thead><tbody><tr><td>ShowColor</td><td>是否在对话框中显示&quot;颜色&quot;选项</td></tr><tr><td>AllowScriptChange</td><td>是否允许使用者更改&quot;字符集&quot;选择</td></tr><tr><td>Font</td><td>选择后的字体</td></tr></tbody></table><p>（2）.创建一个功能相对完整的字体对话框的对象：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token class-name">FontDialog</span> fontDialog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FontDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fontDialog1<span class="token punctuation">.</span>ShowColor <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
fontDialog1<span class="token punctuation">.</span>AllowScriptChange <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>fontDialog1<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> DialogResult<span class="token punctuation">.</span>Cancel<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    fnt <span class="token operator">=</span> fontDialog1<span class="token punctuation">.</span>Font<span class="token punctuation">;</span>
    <span class="token function">showInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>  
</code></pre></div><p>编译后的运行界面如下：</p><p><img src="`+o+`" alt="diag2_2"><br> 图02：C＃创建一个字体对话框对象</p><h2 id="四-颜色选择对话框" tabindex="-1"><a class="header-anchor" href="#四-颜色选择对话框" aria-hidden="true">#</a> 四．颜色选择对话框</h2><p>在C＃中创建一个颜色对话框是通过继承命名空间System.Windows.Froms中类（Class）&quot;ColorDialog&quot;来实现的。下列代码是创建一个此类的对象：</p><p><code>ColorDialog ColorDialog1 = new ColorDialog();</code></p><p>（1）. 颜色选择对话框一些常用的属性：</p><p>颜色选择对话框的常用属性如下表：</p><table><thead><tr><th>属性名称</th><th>作用</th></tr></thead><tbody><tr><td>AllowFullOpen</td><td>设定用户是否可以使用自定义颜色</td></tr><tr><td>ShowHelp</td><td>设定在对话框中是否显示&quot;帮助&quot;按钮</td></tr><tr><td>Color</td><td>颜色对话框选择的颜色</td></tr></tbody></table><p>（2）.创建一个功能相对完整的颜色选择对话框的对象：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token class-name">ColorDialog</span> ColorDialog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ColorDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ColorDialog1<span class="token punctuation">.</span>AllowFullOpen <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
ColorDialog1<span class="token punctuation">.</span>FullOpen <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token comment">//设定此颜色对话框存在&quot;帮助&quot;按钮，缺省是没有的</span>
ColorDialog1<span class="token punctuation">.</span>ShowHelp <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token comment">// 设定此颜色对话框的初始颜色，所以如果在对话框中选择&quot;取消&quot;，则此对话框会重新此颜色</span>
ColorDialog1<span class="token punctuation">.</span>Color <span class="token operator">=</span> Color<span class="token punctuation">.</span>DarkBlue<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> ColorDialog1<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> DialogResult<span class="token punctuation">.</span>Cancel<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    clr <span class="token operator">=</span> ColorDialog1<span class="token punctuation">.</span>Color<span class="token punctuation">;</span>
    <span class="token function">showInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>  
</code></pre></div><p>此代码编译后的运行的界面如下：</p><p><img src="`+e+`" alt="diag2_3"><br> 图03：C＃创建一个颜色对话框对象</p><h2 id="五-保存文件对话框" tabindex="-1"><a class="header-anchor" href="#五-保存文件对话框" aria-hidden="true">#</a> 五．保存文件对话框</h2><p>在C＃中创建一个保存文件对话框是通过继承命名空间System.Windows.Froms中类（Class）&quot;SaveFileDialog&quot;来实现的。下列代码是创建一个此类的对象：</p><p><code>SaveFileDialog saveFileDialog1 = new SaveFileDialog();</code></p><p>（1）. 保存文件对话框一些常用的属性：</p><p>保存文件对话框的常用属性如下表：</p><table><thead><tr><th>属性名称</th><th>作用</th></tr></thead><tbody><tr><td>InitialDirectory</td><td>设置在对话框中显示的初始化目录</td></tr><tr><td>Filter</td><td>设定对话框中过滤文件字符串</td></tr><tr><td>FilterIndex</td><td>设定显示的过滤字符串的索引</td></tr><tr><td>RestoreDirectory</td><td>布尔型，设定是否重新回到关闭此对话框时候的当前目录</td></tr><tr><td>FileName</td><td>设定在对话框中选择的文件名称</td></tr><tr><td>ShowHelp</td><td>设定在对话框中是否显示&quot;帮助&quot;按钮</td></tr><tr><td>Title</td><td>设定对话框的标题</td></tr></tbody></table><p>（2）.创建一个功能相对完整的保存文件对话框的对象：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token class-name">Stream</span> myStream<span class="token punctuation">;</span>
<span class="token class-name">SaveFileDialog</span> saveFileDialog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SaveFileDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
saveFileDialog1<span class="token punctuation">.</span>Filter <span class="token operator">=</span> <span class="token string">&quot; txt files(*.txt)|*.txt|All files(*.*)|*.*&quot;</span><span class="token punctuation">;</span>
saveFileDialog1<span class="token punctuation">.</span>FilterIndex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
saveFileDialog1<span class="token punctuation">.</span>RestoreDirectory <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>saveFileDialog1<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> DialogResult<span class="token punctuation">.</span>OK<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>myStream <span class="token operator">=</span> saveFileDialog1<span class="token punctuation">.</span><span class="token function">OpenFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//设定&quot;sr&quot;对象的指针指向读取文件流的开始位置</span>
        sr<span class="token punctuation">.</span>BaseStream<span class="token punctuation">.</span><span class="token function">Seek</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> SeekOrigin<span class="token punctuation">.</span>Begin<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">int</span></span> i<span class="token punctuation">;</span>
        <span class="token comment">//判断&quot;sr&quot;中的指针是否指向文件流的结尾位置</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">=</span> sr<span class="token punctuation">.</span>BaseStream<span class="token punctuation">.</span><span class="token function">ReadByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//不断的往文件中写入字节</span>
            myStream<span class="token punctuation">.</span><span class="token function">WriteByte</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        myStream<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sr<span class="token punctuation">.</span>BaseStream<span class="token punctuation">.</span><span class="token function">Seek</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> SeekOrigin<span class="token punctuation">.</span>Begin<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>此代码编译后的运行的界面如下：</p><p><img src="`+c+`" alt="diag2_4"><br> 图04：C＃创建一个保存文件对话框对象</p><h2 id="六-设置打印机对话框" tabindex="-1"><a class="header-anchor" href="#六-设置打印机对话框" aria-hidden="true">#</a> 六．设置打印机对话框</h2><p>在C＃中创建一个设置打印机对话框是通过继承命名空间System.Windows.Froms中类（Class）&quot;PrintDialog&quot;来实现的。下列代码是创建一个此类的对象：</p><p><code>PrintDialog PrintDialog1 = new PrintDialog();</code></p><p>（1）. 设置打印机对话框一些常用的属性：</p><p>设置打印机对话框的常用属性如下表：</p><table><thead><tr><th>属性名称</th><th>作用</th></tr></thead><tbody><tr><td>AllowSelection</td><td>设定是否显示&quot;从…到…页&quot;这个打印选项</td></tr><tr><td>AllowPrintToFile</td><td>设定在对话框中&quot;打印到文件&quot;选项是否激活</td></tr><tr><td>Document</td><td>设定要打印的文档</td></tr><tr><td>PrintToFile</td><td>设定是否选中&quot;打印到文件&quot;选项</td></tr><tr><td>ShowNetwork</td><td>设定在对话框是否显示&quot;网络&quot;这个按钮</td></tr><tr><td>ShowHelp</td><td>设定在对话框中是否显示&quot;帮助&quot;按钮</td></tr></tbody></table><p>（2）.创建一个功能相对完整的设置打印机对话框的对象：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token comment">//创建一个设置打印机对话框对象</span>
<span class="token class-name">PrintDialog</span> PrintDialog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//首先要新建一个打印文档，</span>
pd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
PrintDialog1<span class="token punctuation">.</span>ShowNetwork <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

PrintDialog1<span class="token punctuation">.</span>PrintToFile <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
PrintDialog1<span class="token punctuation">.</span>Document <span class="token operator">=</span> pd<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>PrintDialog1<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> DialogResult<span class="token punctuation">.</span>Cancel<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">try</span>
    <span class="token punctuation">{</span>
        pd<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span>ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>此代码编译后的运行的界面如下：</p><p><img src="`+l+`" alt="diag2_5"><br> 图05：C＃创建一个设置打印机对话框对象</p><h2 id="七-打印预览对话框" tabindex="-1"><a class="header-anchor" href="#七-打印预览对话框" aria-hidden="true">#</a> 七：打印预览对话框</h2><p>在C＃中创建一个打印预览对话框是通过继承命名空间System.Windows.Froms中类（Class）&quot;PrintPreviewDialog&quot;来实现的。下列代码是创建一个此类的对象：</p><p><code>PrintPreviewDialog printPreviewDialog1 = new PrintPreviewDialog();</code></p><p>（1）. 打印预览对话框一些常用的属性：</p><p>设置打印机对话框的常用属性如下表：</p><table><thead><tr><th>属性名称</th><th>作用</th></tr></thead><tbody><tr><td>FormBorderStyle</td><td>设定边距类型</td></tr><tr><td>Document</td><td>设定要打印的文档</td></tr></tbody></table><p>（2）.创建一个可以打印一个空文档的打印预览对话框：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token comment">//创建一个打印文档</span>
pd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//创建一个打印预览对话框对象</span>
<span class="token class-name">PrintPreviewDialog</span> printPreviewDialog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintPreviewDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
printPreviewDialog1<span class="token punctuation">.</span>Document <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pd<span class="token punctuation">;</span>
printPreviewDialog1<span class="token punctuation">.</span>FormBorderStyle <span class="token operator">=</span> FormBorderStyle<span class="token punctuation">.</span>Fixed3D<span class="token punctuation">;</span>
printPreviewDialog1<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>此代码编译后的运行的界面如下：</p><p><img src="`+u+'" alt="diag2_6"><br> 图06：C＃创建一个打印空文档的打印预览对话框对象</p><h2 id="八-用c-例子编写一个综合六个对话框的例子-dialog-cs" tabindex="-1"><a class="header-anchor" href="#八-用c-例子编写一个综合六个对话框的例子-dialog-cs" aria-hidden="true">#</a> 八．用C＃例子编写一个综合六个对话框的例子（dialog.cs）</h2><p>下图是dialog.cs编译后运行的界面：</p><p><img src="'+i+`" alt="diag2_7"><br> 图07：用C＃编写的组合六个对话框程序的运行界面</p><p>dialog.cs的源代码如下：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>IO</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Text</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Drawing</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Printing</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>ComponentModel</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Form1</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Form</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Button</span> btnOpenFileDialog<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Button</span> btnSaveFileDialog<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Button</span> btnColorDialog<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Button</span> btnFontDialog<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Button</span> btnPrintDialog<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Label</span> lblOutputData<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Label</span> lblCaption<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Font</span> fnt<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Color</span> clr<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">string</span></span> fName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">StreamReader</span> sr<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">PrintDocument</span> pd<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Button</span> btnPrintPreview<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span>Container</span> components <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">Form1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//初始化窗体中的各个组件</span>
        <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//清除程序中使用过的资源</span>
    <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">bool</span></span> disposing<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>disposing<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>components <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                components<span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span>disposing<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        btnColorDialog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnFontDialog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lblCaption <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Label</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnOpenFileDialog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnSaveFileDialog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnPrintPreview <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnPrintDialog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lblOutputData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Label</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">SuspendLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        btnColorDialog<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnColorDialog<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;btnColorDialog&quot;</span><span class="token punctuation">;</span>
        btnColorDialog<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span><span class="token punctuation">(</span><span class="token number">140</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnColorDialog<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        btnColorDialog<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;颜色对话框&quot;</span><span class="token punctuation">;</span>
        btnColorDialog<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>EventHandler</span><span class="token punctuation">(</span>btnColorDialog_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>

        btnFontDialog<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnFontDialog<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;btnFontDialog&quot;</span><span class="token punctuation">;</span>
        btnFontDialog<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span><span class="token punctuation">(</span><span class="token number">140</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnFontDialog<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        btnFontDialog<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;字体对话框&quot;</span><span class="token punctuation">;</span>
        btnFontDialog<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>EventHandler</span><span class="token punctuation">(</span>btnFontDialog_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>

        lblCaption<span class="token punctuation">.</span>Font <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Font</span><span class="token punctuation">(</span><span class="token string">&quot;宋体&quot;</span><span class="token punctuation">,</span> <span class="token number">10.5F</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>FontStyle<span class="token punctuation">.</span>Regular<span class="token punctuation">,</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>GraphicsUnit<span class="token punctuation">.</span>Point<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>Byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">134</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lblCaption<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span><span class="token number">184</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lblCaption<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;lblCaption&quot;</span><span class="token punctuation">;</span>
        lblCaption<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span><span class="token punctuation">(</span><span class="token number">246</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lblCaption<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        lblCaption<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;选择对话框后的输出结果：&quot;</span><span class="token punctuation">;</span>

        btnOpenFileDialog<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnOpenFileDialog<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;btnOpenFileDialog&quot;</span><span class="token punctuation">;</span>
        btnOpenFileDialog<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span><span class="token punctuation">(</span><span class="token number">140</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnOpenFileDialog<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        btnOpenFileDialog<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;打开文件对话框&quot;</span><span class="token punctuation">;</span>
        btnOpenFileDialog<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>EventHandler</span><span class="token punctuation">(</span>btnOpenFileDialog_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>

        btnSaveFileDialog<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">213</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnSaveFileDialog<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;btnSaveFileDialog&quot;</span><span class="token punctuation">;</span>
        btnSaveFileDialog<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span><span class="token punctuation">(</span><span class="token number">140</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnSaveFileDialog<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        btnSaveFileDialog<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;保存文件对话框&quot;</span><span class="token punctuation">;</span>
        btnSaveFileDialog<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>EventHandler</span><span class="token punctuation">(</span>btnSaveFileDialog_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>

        btnPrintPreview<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnPrintPreview<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;btnPrintPreview&quot;</span><span class="token punctuation">;</span>
        btnPrintPreview<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span><span class="token punctuation">(</span><span class="token number">140</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnPrintPreview<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
        btnPrintPreview<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;打印预览对话框&quot;</span><span class="token punctuation">;</span>
        btnPrintPreview<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>EventHandler</span><span class="token punctuation">(</span>btnPrintPreview_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>

        btnPrintDialog<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">176</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnPrintDialog<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;btnPrintDialog&quot;</span><span class="token punctuation">;</span>
        btnPrintDialog<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span><span class="token punctuation">(</span><span class="token number">140</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnPrintDialog<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
        btnPrintDialog<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;打印对话框&quot;</span><span class="token punctuation">;</span>
        btnPrintDialog<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>EventHandler</span><span class="token punctuation">(</span>btnPrintDialog_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>

        lblOutputData<span class="token punctuation">.</span>BorderStyle <span class="token operator">=</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>BorderStyle<span class="token punctuation">.</span>Fixed3D<span class="token punctuation">;</span>
        lblOutputData<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span><span class="token number">176</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lblOutputData<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;lblOutputData&quot;</span><span class="token punctuation">;</span>
        lblOutputData<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span><span class="token punctuation">(</span><span class="token number">280</span><span class="token punctuation">,</span> <span class="token number">213</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        lblOutputData<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>AutoScaleBaseSize <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ClientSize <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span><span class="token punctuation">(</span><span class="token number">456</span><span class="token punctuation">,</span> <span class="token number">264</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>lblCaption<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>btnPrintPreview<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>lblOutputData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>btnSaveFileDialog<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>btnOpenFileDialog<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>btnColorDialog<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>btnFontDialog<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>btnPrintDialog<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>MaximizeBox <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>MinimizeBox <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;Form1&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;全面掌握C＃中的对话框组件！&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ResumeLayout</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Application<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Form1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnOpenFileDialog_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//定义一个&quot;打开文件对话框&quot;</span>
        <span class="token class-name">OpenFileDialog</span> openFileDialog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OpenFileDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//定义此对话框的初始化目录</span>
        openFileDialog1<span class="token punctuation">.</span>InitialDirectory <span class="token operator">=</span> <span class="token string">&quot;c:\\\\&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">//定义此对话框文件过滤类型</span>
        openFileDialog1<span class="token punctuation">.</span>Filter <span class="token operator">=</span> <span class="token string">&quot;txt files(*.txt)|*.txt|All files (*.*)|*.*&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">//此对话框缺省过滤类型为第二个</span>
        openFileDialog1<span class="token punctuation">.</span>FilterIndex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        openFileDialog1<span class="token punctuation">.</span>RestoreDirectory <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>openFileDialog1<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> DialogResult<span class="token punctuation">.</span>OK<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            fName <span class="token operator">=</span> openFileDialog1<span class="token punctuation">.</span>FileName<span class="token punctuation">;</span>
            <span class="token function">showInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StreamReader</span><span class="token punctuation">(</span>fName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//另存文件对话框</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnSaveFileDialog_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">Stream</span> myStream<span class="token punctuation">;</span>
        <span class="token class-name">SaveFileDialog</span> saveFileDialog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SaveFileDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        saveFileDialog1<span class="token punctuation">.</span>Filter <span class="token operator">=</span> <span class="token string">&quot; txt files(*.txt)|*.txt|All files(*.*)|*.*&quot;</span><span class="token punctuation">;</span>
        saveFileDialog1<span class="token punctuation">.</span>FilterIndex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        saveFileDialog1<span class="token punctuation">.</span>RestoreDirectory <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>saveFileDialog1<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> DialogResult<span class="token punctuation">.</span>OK<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>myStream <span class="token operator">=</span> saveFileDialog1<span class="token punctuation">.</span><span class="token function">OpenFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token comment">//设定&quot;sr&quot;对象的指针指向读取文件流的开始位置</span>
                sr<span class="token punctuation">.</span>BaseStream<span class="token punctuation">.</span><span class="token function">Seek</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> SeekOrigin<span class="token punctuation">.</span>Begin<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">int</span></span> i<span class="token punctuation">;</span>
                <span class="token comment">//判断&quot;sr&quot;中的指针是否指向文件流的结尾位置</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">=</span> sr<span class="token punctuation">.</span>BaseStream<span class="token punctuation">.</span><span class="token function">ReadByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token comment">//不断的往文件中写入字节</span>
                    myStream<span class="token punctuation">.</span><span class="token function">WriteByte</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                myStream<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                sr<span class="token punctuation">.</span>BaseStream<span class="token punctuation">.</span><span class="token function">Seek</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> SeekOrigin<span class="token punctuation">.</span>Begin<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//颜色选择对话框</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnColorDialog_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">ColorDialog</span> ColorDialog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ColorDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ColorDialog1<span class="token punctuation">.</span>AllowFullOpen <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        ColorDialog1<span class="token punctuation">.</span>FullOpen <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token comment">//设定此颜色对话框存在&quot;帮助&quot;按钮，缺省是没有的</span>
        ColorDialog1<span class="token punctuation">.</span>ShowHelp <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token comment">// 设定此颜色对话框的初始颜色，所以如果在对话框中选择&quot;取消&quot;，则此对话框会重新此颜色</span>
        ColorDialog1<span class="token punctuation">.</span>Color <span class="token operator">=</span> Color<span class="token punctuation">.</span>DarkBlue<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ColorDialog1<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> DialogResult<span class="token punctuation">.</span>Cancel<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            clr <span class="token operator">=</span> ColorDialog1<span class="token punctuation">.</span>Color<span class="token punctuation">;</span>
            <span class="token function">showInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//打开字体对话框</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnFontDialog_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">FontDialog</span> fontDialog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FontDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fontDialog1<span class="token punctuation">.</span>ShowColor <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        fontDialog1<span class="token punctuation">.</span>AllowScriptChange <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        fontDialog1<span class="token punctuation">.</span>ShowColor <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>fontDialog1<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> DialogResult<span class="token punctuation">.</span>Cancel<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            fnt <span class="token operator">=</span> fontDialog1<span class="token punctuation">.</span>Font<span class="token punctuation">;</span>
            <span class="token function">showInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//打印机对话框</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnPrintDialog_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">PrintDialog</span> PrintDialog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        PrintDialog1<span class="token punctuation">.</span>PrintToFile <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        PrintDialog1<span class="token punctuation">.</span>Document <span class="token operator">=</span> pd<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>PrintDialog1<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> DialogResult<span class="token punctuation">.</span>Cancel<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{</span>
                pd<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span>ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//打印预览对话框</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnPrintPreview_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//创建一个新的文档</span>
        pd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//创建一个打印预览对话框</span>
        <span class="token class-name">PrintPreviewDialog</span> printPreviewDialog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">PrintPreviewDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        printPreviewDialog1<span class="token punctuation">.</span>Document <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pd<span class="token punctuation">;</span>
        printPreviewDialog1<span class="token punctuation">.</span>FormBorderStyle <span class="token operator">=</span> FormBorderStyle<span class="token punctuation">.</span>Fixed3D<span class="token punctuation">;</span>
        printPreviewDialog1<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//显示各个对话框选择后的信息</span>
    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">showInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        lblOutputData<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;选择文件： &quot;</span> <span class="token operator">+</span> fName<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\\n\\r\\n\\r&quot;</span><span class="token punctuation">;</span>
        lblOutputData<span class="token punctuation">.</span>Text <span class="token operator">=</span> lblOutputData<span class="token punctuation">.</span>Text <span class="token operator">+</span> <span class="token string">&quot;选择颜色： &quot;</span> <span class="token operator">+</span> clr<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\\n\\r\\n\\r&quot;</span><span class="token punctuation">;</span>
        lblOutputData<span class="token punctuation">.</span>Text <span class="token operator">=</span> lblOutputData<span class="token punctuation">.</span>Text <span class="token operator">+</span> <span class="token string">&quot;选择字体：&quot;</span> <span class="token operator">+</span> fnt <span class="token operator">+</span> <span class="token string">&quot;\\n\\r\\n\\r&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="九-总结" tabindex="-1"><a class="header-anchor" href="#九-总结" aria-hidden="true">#</a> 九．总结</h2><p>对话框是编程过程中经常使用到的组件，希望上面的介绍对您在程序设计中使用这些对话框有所帮助。</p><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>Powered by DvNews.net
来源：网络
阅读：452 次
日期：2003-6-16
</code></pre></div>`,71),d=[r];function m(g,w){return s(),a("div",null,d)}const D=n(k,[["render",m],["__file","diag2.html.vue"]]);export{D as default};
