import{_ as n,o as a,c as s,a as p}from"./app-477de5b2.js";const t={},o=p(`<h1 id="winform中如何播放声音与flash动画" tabindex="-1"><a class="header-anchor" href="#winform中如何播放声音与flash动画" aria-hidden="true">#</a> WinForm中如何播放声音与Flash动画</h1><p>前面几天有一位MM在论坛中问我，怎么在VC#设计中如何播放声音和Flash动画。当时我正急着找工作，没有机会去想想怎么做，只能遗憾对那个MM说，我帮不了你：（，现在飞刀找工作事情已经过一段落，注定我是一个没有人要的孩子，不过我也有机会可以来看看这个问题怎么解决了。</p><p>在网上查了一些资料，发现介绍的比较麻烦，我想VS.Net设计出来不可能这么复杂的，于是自个试验了一下，结果发现是超级简单。简单的不可想像：）</p><p>本文就当是基础教程吧：））</p><h2 id="一、在vc-播放声音" tabindex="-1"><a class="header-anchor" href="#一、在vc-播放声音" aria-hidden="true">#</a> 一、在VC#播放声音</h2><p>与以前的开发工具的一样，需要调用控件，但是.Net类库中似乎是没有提供这方面的控件，所以我们只有另想办法。CFL刚刚出来提供的东东是不多，但是传统的COM却是不少啊：））</p><p>建立一个VC#的Windows Form工程</p><p>选择菜单中的“工具”--“自定义工具箱”</p><p>图一</p><p>打开的自定义工具箱的窗口，在“COM 组件”中选择Window Media Player这个选项。点击“确定”</p><p>图二</p><p>图三</p><p>图四</p><p>于是在“工具箱”中便出现了“MediaPlayer”这一项，然后再将其拖至Form上，调整大小,我是将充满全部的Form。</p><p>如图4所示,在“引用”中自动加入了对此dll的引用，AxMediaPlayer则便是我们使用的Namespace与class。</p><p>在属性栏中设置好此控件的一些属性（属性是一目了然），为了方便，这里我把AutoStart设置成为true，只要FileName被设置，则文件将会自动播放。</p><p>播放代码为：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">menuItem2_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">OpenFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//打开文件</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OpenFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">OpenFileDialog</span> ofDialog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OpenFileDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ofDialog<span class="token punctuation">.</span>AddExtension <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    ofDialog<span class="token punctuation">.</span>CheckFileExists <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    ofDialog<span class="token punctuation">.</span>CheckPathExists <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    ofDialog<span class="token punctuation">.</span>Filter <span class="token operator">=</span> <span class="token string">&quot;VCD文件(*.dat)|*.dat|Audio文件(*.avi)|*.avi|WAV文件 (*.wav)|*.wav|MP3文件 (*.mp3)|*.mp3|所有文件 (*.*)|*.*&quot;</span><span class="token punctuation">;</span>
    ofDialog<span class="token punctuation">.</span>DefaultExt <span class="token operator">=</span> <span class="token string">&quot;*.mp3&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ofDialog<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> DialogResult<span class="token punctuation">.</span>OK<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>axMediaPlayer1<span class="token punctuation">.</span>FileName <span class="token operator">=</span> ofDialog<span class="token punctuation">.</span>FileName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>很简单：）我的写了一个小程序：）执行如图5</p><p>图5</p><p>本例中，我使用的微软的播放器，也许不需要用这么大个，大家可以试试Winamp的控件：），我就不多说了：）如果你只需要播放声音而不需要显示，你就把AxMediaPlayer的Visible属性设置为false就可以了：）</p><h2 id="二、播放flash动画" tabindex="-1"><a class="header-anchor" href="#二、播放flash动画" aria-hidden="true">#</a> 二、播放Flash动画</h2><p>播放Flash动画的原理与声音差不多，也就是直接引用Flash的dll，不过这个dll不能直接在“COM”窗口中找到,需要我们手动的添加，我们点击图2中的“浏览”键，然后选择“E:WINDOWSsystem32MacromedFlashswflash.ocx&quot;控件，点击“确定”</p><p>图6</p><p>这时我们可以在工具箱中就可以看到“FlashFactory”，“ShockwaveFlash”两个新控件，其中我们需要使用的是&quot;ShockwaveFlash&quot;,将其拖到新建的Form上，然后再设置一些属性即可，这些在属性栏中都可以清楚的看到。</p><p>图7</p><p>我写了一个小程序，播放“第一次亲密接触”的Flash，执行如图8：</p><p>图8</p><p>简单的操作代码，即打开swf文件，并播放它：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">menuItem2_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">OpenFileDialog</span> ofDialog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OpenFileDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ofDialog<span class="token punctuation">.</span>AddExtension <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    ofDialog<span class="token punctuation">.</span>CheckFileExists <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    ofDialog<span class="token punctuation">.</span>CheckPathExists <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    ofDialog<span class="token punctuation">.</span>Filter <span class="token operator">=</span> <span class="token string">&quot;swf 文件 (*.swf)|*.swf|所有文件 (*.*)|*.*&quot;</span><span class="token punctuation">;</span>
    ofDialog<span class="token punctuation">.</span>DefaultExt <span class="token operator">=</span> <span class="token string">&quot;mp3&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ofDialog<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> DialogResult<span class="token punctuation">.</span>OK<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>axShockwaveFlash1<span class="token punctuation">.</span>Movie <span class="token operator">=</span> ofDialog<span class="token punctuation">.</span>FileName<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>axShockwaveFlash1<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>`,30),e=[o];function c(l,u){return a(),s("div",null,e)}const k=n(t,[["render",c],["__file","mm6.html.vue"]]);export{k as default};
