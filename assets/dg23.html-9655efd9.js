import{_ as n,o as s,c as a,a as t}from"./app-a2b6e588.js";const p={},o=t(`<h1 id="如何将datagrid中的修改的数据-放到数据库中呢" tabindex="-1"><a class="header-anchor" href="#如何将datagrid中的修改的数据-放到数据库中呢" aria-hidden="true">#</a> 如何将DataGrid中的修改的数据，放到数据库中呢？</h1><div class="language-txt" data-ext="txt"><pre class="language-txt"><code>主　　题：  如何将DataGrid中的修改的数据，放到数据库中呢？
作　　者：  zhangjinshui200 (望眼江湖)
等　　级：  ^
信 誉 值：  100
所属论坛：  .NET技术 C#
问题点数：  50
回复次数：  12
发表时间：  2003-11-26 16:41:33
</code></pre></div><p>实现过程：<br> 从一个函数中，获得数据集，将数据集绑定到DataGrid上面。<br> 现在，从DataGrid中修改的数据，想把这个数据重新写回到数据库中，<br> 必知道如何做了？<br> 能够给几句完整的代码吗？<br> 非常谢谢！</p><hr><hr><p>回复人： zhangjinshui200(望眼江湖) ( 一级(初级)) 信誉：100 2003-11-26 16:42:33 得分:0</p><blockquote><p>实现过程：<br> 从一个函数中，获得数据集，将数据集绑定到DataGrid上面。<br> 现在，从DataGrid中修改的数据，想把这个数据重新写回到数据库中，<br> 不知道如何做了？<br> 能够给几句完整的代码吗？<br> 非常谢谢！</p></blockquote><p>回复人： polarlm(polarlm) ( 三级(初级)) 信誉：100 2003-11-26 16:46:38 得分:5</p><blockquote><p><code>oleDbDataAdapter1.Update(dsAuthors1,&quot;authors&quot;);</code></p></blockquote><p>回复人： hare007(qghao) ( 一级(初级)) 信誉：100 2003-11-26 16:51:19 得分:5</p><blockquote><p>up</p></blockquote><p>回复人： keyplayer(冰) ( 一级(初级)) 信誉：92 2003-11-26 17:09:48 得分:10</p><blockquote><p><code>sqlDbDataAdapter1.Update(dsAuthors1,&quot;authors&quot;);</code></p></blockquote><p>回复人： smiletosky(仰笑九天) ( 五级(中级)) 信誉：101 2003-11-26 17:11:40 得分:5</p><blockquote><p>用dataset更新</p></blockquote><p>回复人： zhangjinshui200(望眼江湖) ( 一级(初级)) 信誉：100 2003-11-26 17:15:53 得分:0</p><blockquote><p>用了上面的做法，为什么提示如下信息呢？<br> Update requires a valid InsertCommand when passed DataRow collection with new rows.</p></blockquote><p>回复人： heroniexiaowei(白痴) ( 一级(初级)) 信誉：100 2003-11-26 17:17:06 得分:10</p><blockquote></blockquote><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">string</span></span> query<span class="token operator">=</span><span class="token string">&quot;Update dsAuthors1 set authors=&quot;</span>&quot;&quot;<span class="token punctuation">;</span>
<span class="token class-name">OdbcCommand</span> thisBuilder1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OdbcCommand</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> connv<span class="token punctuation">)</span><span class="token punctuation">;</span>
thisBuilder1<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>回复人： dahuzizyd(你就是我心中的女神) ( 一星(中级)) 信誉：105 2003-11-26 19:16:40 得分:0</p><blockquote><p>是因为你的DataAdapter没有和selectCommand相对应的InsertCommand，可以使用Commandbuilder（OleDB和SQL的都有），也可是自己写Insert语句然后赋给DataAdapter<br><br> 下面的是帮助里的，使用SQLCommandBuilder：<br> SqlDataAdapter 不会自动生成实现 DataSet 的更改与关联的 SQL Server 实例之间的协调所需的 Transact-SQL 语句。但是，如果设置了 SqlDataAdapter 的 SelectCommand 属性，则可以创建一个 SqlCommandBuilder 对象来自动生成用于单表更新的 Transact-SQL 语句。然后，SqlCommandBuilder 将生成其他任何未设置的 Transact-SQL 语句。<br><br> 一旦设置 DataAdapter 属性，SqlCommandBuilder 就将其自身注册为 RowUpdating 事件的侦听器。一次只能将一个 SqlDataAdapter 与一个 SqlCommandBuilder 对象（或相反）互相关联。<br><br> 为了生成 INSERT、UPDATE 或 DELETE 语句，SqlCommandBuilder 会自动使用 SelectCommand 属性来检索所需的元数据集。如果在检索元数据后（例如在第一次更新后）更改 SelectCommand，则应调用 RefreshSchema 方法来更新元数据。<br><br> SelectCommand 还必须至少返回一个主键列或唯一的列。如果什么都没有返回，就会产生 InvalidOperation 异常，不生成命令。<br><br> SqlCommandBuilder 还使用由 SelectCommand 引用的 Connection、CommandTimeout 和 Transaction 属性。如果修改了任何这些属性或者替换了 SelectCommand 本身，用户则应调用 RefreshSchema。否则，InsertCommand、UpdateCommand 和 DeleteCommand 属性将保留它们以前的值。<br><br> 如果调用 Dispose，则会解除 SqlCommandBuilder 与 SqlDataAdapter 的关联，并且不再使用所生成的命令。</p></blockquote><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">DataSet</span> <span class="token function">SelectSqlSrvRows</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> myConnection<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> mySelectQuery<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> myTableName<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">SqlConnection</span> myConn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span>myConnection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">SqlDataAdapter</span> myDataAdapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlDataAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    myDataAdapter<span class="token punctuation">.</span>SelectCommand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlCommand</span><span class="token punctuation">(</span>mySelectQuery<span class="token punctuation">,</span> myConn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">SqlCommandBuilder</span> cb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlCommandBuilder</span><span class="token punctuation">(</span>myDataAdapter<span class="token punctuation">)</span><span class="token punctuation">;</span>

    myConn<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">DataSet</span> ds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    myDataAdapter<span class="token punctuation">.</span><span class="token function">Fill</span><span class="token punctuation">(</span>ds<span class="token punctuation">,</span> myTableName<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//code to modify data in DataSet here</span>

    <span class="token comment">//Without the SqlCommandBuilder this line would fail</span>
    myDataAdapter<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>ds<span class="token punctuation">,</span> myTableName<span class="token punctuation">)</span><span class="token punctuation">;</span>

    myConn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> ds<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>使用自己写SQL语句的办法：</p></blockquote><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token class-name">SqlDataAdapter</span> catDA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlDataAdapter</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT CategoryID, CategoryName FROM Categories&quot;</span><span class="token punctuation">,</span> nwindConn<span class="token punctuation">)</span><span class="token punctuation">;</span>

catDA<span class="token punctuation">.</span>UpdateCommand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlCommand</span><span class="token punctuation">(</span><span class="token string">&quot;UPDATE Categories SET CategoryName = @CategoryName &quot;</span> <span class="token operator">+</span>
                                     <span class="token string">&quot;WHERE CategoryID = @CategoryID&quot;</span> <span class="token punctuation">,</span> nwindConn<span class="token punctuation">)</span><span class="token punctuation">;</span>

catDA<span class="token punctuation">.</span>UpdateCommand<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;@CategoryName&quot;</span><span class="token punctuation">,</span> SqlDbType<span class="token punctuation">.</span>NVarChar<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">&quot;CategoryName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">SqlParameter</span> workParm <span class="token operator">=</span> catDA<span class="token punctuation">.</span>UpdateCommand<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;@CategoryID&quot;</span><span class="token punctuation">,</span> SqlDbType<span class="token punctuation">.</span>Int<span class="token punctuation">)</span><span class="token punctuation">;</span>
workParm<span class="token punctuation">.</span>SourceColumn <span class="token operator">=</span> <span class="token string">&quot;CategoryID&quot;</span><span class="token punctuation">;</span>
workParm<span class="token punctuation">.</span>SourceVersion <span class="token operator">=</span> DataRowVersion<span class="token punctuation">.</span>Original<span class="token punctuation">;</span>

<span class="token class-name">DataSet</span> catDS <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
catDA<span class="token punctuation">.</span><span class="token function">Fill</span><span class="token punctuation">(</span>catDS<span class="token punctuation">,</span> <span class="token string">&quot;Categories&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">DataRow</span> cRow <span class="token operator">=</span> catDS<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token string">&quot;Categories&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
cRow<span class="token punctuation">[</span><span class="token string">&quot;CategoryName&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;New Category&quot;</span><span class="token punctuation">;</span>

catDA<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>catDS<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>回复人： mynewbigame(学习者) ( 一级(初级)) 信誉：100 2003-11-26 19:41:47 得分:15</p><blockquote><p>c# &amp; .net技术平台实战演练上的例子，我稍作修改：<br> form1.cs</p></blockquote><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Drawing</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>ComponentModel</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">csnetdata</span>
<span class="token punctuation">{</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token doc-comment comment">/// Form1 的摘要说明。</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Form1</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Form</span></span>
    <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>TabControl</span> tabControl1<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>TabPage</span> tabPage1<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>TabPage</span> tabPage2<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>ListBox</span> lstconsole<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>DataGrid</span> dataGrid1<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>TextBox</span> textBox1<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Button</span> btnquit<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Button</span> btnsave<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Button</span> btnstart<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Button</span> btnclear<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlCommand</span> sqlSelectCommand1<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlCommand</span> sqlInsertCommand1<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlCommand</span> sqlUpdateCommand1<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlCommand</span> sqlDeleteCommand1<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlConnection</span> sqlConnection1<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlDataAdapter</span> sqlDataAdapter1<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">csnetdata<span class="token punctuation">.</span>DataSet1</span> dataSet11<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>DataGridTableStyle</span> dataGridTableStyle1<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>DataGridTextBoxColumn</span> dataGridTextBoxColumn1<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>DataGridTextBoxColumn</span> dataGridTextBoxColumn2<span class="token punctuation">;</span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token doc-comment comment">/// 必需的设计器变量。</span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token keyword">private</span> <span class="token class-name">System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span>Container</span> components <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token function">Form1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//</span>
            <span class="token comment">// Windows 窗体设计器支持所必需的</span>
            <span class="token comment">//</span>
            <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//</span>
            <span class="token comment">// TODO: 在 InitializeComponent 调用后添加任何构造函数代码</span>
            <span class="token comment">//</span>
        <span class="token punctuation">}</span>

        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token doc-comment comment">/// 清理所有正在使用的资源。</span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Dispose</span><span class="token punctuation">(</span> <span class="token class-name"><span class="token keyword">bool</span></span> disposing <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span> disposing <span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>components <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> 
                <span class="token punctuation">{</span>
                    components<span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span> disposing <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token preprocessor property">#<span class="token directive keyword">region</span> Windows Form Designer generated code</span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token doc-comment comment">/// 设计器支持所需的方法 - 不要使用代码编辑器修改</span>
        <span class="token doc-comment comment">/// 此方法的内容。</span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabControl1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>TabControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>TabPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>DataGrid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnquit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnsave <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnstart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>TabPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>lstconsole <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>ListBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnclear <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>textBox1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>TextBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlSelectCommand1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlInsertCommand1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlUpdateCommand1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlDeleteCommand1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlConnection1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlDataAdapter1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlDataAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataSet11 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">csnetdata<span class="token punctuation">.</span>DataSet1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTableStyle1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>DataGridTableStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTextBoxColumn1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>DataGridTextBoxColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTextBoxColumn2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>DataGridTextBoxColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabControl1<span class="token punctuation">.</span><span class="token function">SuspendLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage1<span class="token punctuation">.</span><span class="token function">SuspendLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span>ISupportInitialize<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">BeginInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage2<span class="token punctuation">.</span><span class="token function">SuspendLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span>ISupportInitialize<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataSet11<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">BeginInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">SuspendLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// tabControl1</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabControl1<span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">AddRange</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Control<span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span>
                                                                                        <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage1<span class="token punctuation">,</span>
                                                                                        <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage2<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabControl1<span class="token punctuation">.</span>Dock <span class="token operator">=</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>DockStyle<span class="token punctuation">.</span>Fill<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabControl1<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;tabControl1&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabControl1<span class="token punctuation">.</span>SelectedIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabControl1<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">640</span><span class="token punctuation">,</span> <span class="token number">461</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabControl1<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// tabPage1</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage1<span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">AddRange</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Control<span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span>
                                                                                    <span class="token keyword">this</span><span class="token punctuation">.</span>textBox1<span class="token punctuation">,</span>
                                                                                    <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">,</span>
                                                                                    <span class="token keyword">this</span><span class="token punctuation">.</span>btnquit<span class="token punctuation">,</span>
                                                                                    <span class="token keyword">this</span><span class="token punctuation">.</span>btnsave<span class="token punctuation">,</span>
                                                                                    <span class="token keyword">this</span><span class="token punctuation">.</span>btnstart<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage1<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage1<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;tabPage1&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage1<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">632</span><span class="token punctuation">,</span> <span class="token number">436</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage1<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage1<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;Data Maintain&quot;</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// dataGrid1</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>AlternatingBackColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>GhostWhite<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>Anchor <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>AnchorStyles<span class="token punctuation">.</span>Top <span class="token operator">|</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>AnchorStyles<span class="token punctuation">.</span>Bottom<span class="token punctuation">)</span> 
                <span class="token operator">|</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>AnchorStyles<span class="token punctuation">.</span>Left<span class="token punctuation">)</span> 
                <span class="token operator">|</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>AnchorStyles<span class="token punctuation">.</span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>BackColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>GhostWhite<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>BackgroundColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>Lavender<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>BorderStyle <span class="token operator">=</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>BorderStyle<span class="token punctuation">.</span>None<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>CaptionBackColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>RoyalBlue<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>CaptionForeColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>White<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>DataMember <span class="token operator">=</span> <span class="token string">&quot;forum_subject&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dataSet11<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>FlatMode <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>Font <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Font</span><span class="token punctuation">(</span><span class="token string">&quot;Tahoma&quot;</span><span class="token punctuation">,</span> <span class="token number">8F</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>ForeColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>MidnightBlue<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>GridLineColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>RoyalBlue<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>HeaderBackColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>MidnightBlue<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>HeaderFont <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Font</span><span class="token punctuation">(</span><span class="token string">&quot;Tahoma&quot;</span><span class="token punctuation">,</span> <span class="token number">8F</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>FontStyle<span class="token punctuation">.</span>Bold<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>HeaderForeColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>Lavender<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>LinkColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>Teal<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;dataGrid1&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>ParentRowsBackColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>Lavender<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>ParentRowsForeColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>MidnightBlue<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>SelectionBackColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>Teal<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>SelectionForeColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>PaleGreen<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">616</span><span class="token punctuation">,</span> <span class="token number">352</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">.</span>TableStyles<span class="token punctuation">.</span><span class="token function">AddRange</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>DataGridTableStyle<span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span>
                                                                                                    <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTableStyle1<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// btnquit</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnquit<span class="token punctuation">.</span>FlatStyle <span class="token operator">=</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>FlatStyle<span class="token punctuation">.</span>Popup<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnquit<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">232</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnquit<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;btnquit&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnquit<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">104</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnquit<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnquit<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;Quit&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnquit<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>EventHandler</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>button4_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// btnsave</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnsave<span class="token punctuation">.</span>FlatStyle <span class="token operator">=</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>FlatStyle<span class="token punctuation">.</span>Popup<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnsave<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnsave<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;btnsave&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnsave<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">104</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnsave<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnsave<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;Save&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnsave<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>EventHandler</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>btnsave_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>回复人： mynewbigame(学习者) ( 一级(初级)) 信誉：100 2003-11-26 19:42:28 得分:0</p><blockquote><p>继续：</p></blockquote><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code>            <span class="token comment">// </span>
            <span class="token comment">// btnstart</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnstart<span class="token punctuation">.</span>FlatStyle <span class="token operator">=</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>FlatStyle<span class="token punctuation">.</span>Popup<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnstart<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnstart<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;btnstart&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnstart<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">104</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnstart<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnstart<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;Start&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnstart<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>EventHandler</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>button2_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// tabPage2</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage2<span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">AddRange</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Control<span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span>
                                                                                    <span class="token keyword">this</span><span class="token punctuation">.</span>lstconsole<span class="token punctuation">,</span>
                                                                                    <span class="token keyword">this</span><span class="token punctuation">.</span>btnclear<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage2<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage2<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;tabPage2&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage2<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">632</span><span class="token punctuation">,</span> <span class="token number">436</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage2<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage2<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;Console Display&quot;</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// lstconsole</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>lstconsole<span class="token punctuation">.</span>Anchor <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>AnchorStyles<span class="token punctuation">.</span>Top <span class="token operator">|</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>AnchorStyles<span class="token punctuation">.</span>Bottom<span class="token punctuation">)</span> 
                <span class="token operator">|</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>AnchorStyles<span class="token punctuation">.</span>Left<span class="token punctuation">)</span> 
                <span class="token operator">|</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>AnchorStyles<span class="token punctuation">.</span>Right<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>lstconsole<span class="token punctuation">.</span>BackColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>Black<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>lstconsole<span class="token punctuation">.</span>ForeColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Color<span class="token punctuation">.</span>LawnGreen<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>lstconsole<span class="token punctuation">.</span>ItemHeight <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>lstconsole<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>lstconsole<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;lstconsole&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>lstconsole<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">616</span><span class="token punctuation">,</span> <span class="token number">376</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>lstconsole<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// btnclear</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnclear<span class="token punctuation">.</span>FlatStyle <span class="token operator">=</span> System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>FlatStyle<span class="token punctuation">.</span>Flat<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnclear<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnclear<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;btnclear&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnclear<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">176</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnclear<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnclear<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;Clear&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>btnclear<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>EventHandler</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>button1_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// textBox1</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>textBox1<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Point</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>textBox1<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;textBox1&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>textBox1<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">616</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>textBox1<span class="token punctuation">.</span>TabIndex <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>textBox1<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;server=LocalHost;uid=sa;pwd=;database=book_4&quot;</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// sqlSelectCommand1</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlSelectCommand1<span class="token punctuation">.</span>CommandText <span class="token operator">=</span> <span class="token string">&quot;SELECT forum_subject_id, forum_subject_name FROM forum_subject&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlSelectCommand1<span class="token punctuation">.</span>Connection <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sqlConnection1<span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// sqlInsertCommand1</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlInsertCommand1<span class="token punctuation">.</span>CommandText <span class="token operator">=</span> <span class="token string">&quot;INSERT INTO forum_subject(forum_subject_id, forum_subject_name) VALUES (@forum_su&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;bject_id, @forum_subject_name); SELECT forum_subject_id, forum_subject_name FROM&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot; forum_subject WHERE (forum_subject_id = @forum_subject_id)&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlInsertCommand1<span class="token punctuation">.</span>Connection <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sqlConnection1<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlInsertCommand1<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlParameter</span><span class="token punctuation">(</span><span class="token string">&quot;@forum_subject_id&quot;</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlDbType<span class="token punctuation">.</span>VarChar<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">&quot;forum_subject_id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlInsertCommand1<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlParameter</span><span class="token punctuation">(</span><span class="token string">&quot;@forum_subject_name&quot;</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlDbType<span class="token punctuation">.</span>VarChar<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">&quot;forum_subject_name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// sqlUpdateCommand1</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlUpdateCommand1<span class="token punctuation">.</span>CommandText <span class="token operator">=</span> <span class="token string">@&quot;UPDATE forum_subject SET forum_subject_id = @forum_subject_id, forum_subject_name = @forum_subject_name WHERE (forum_subject_id = @Original_forum_subject_id) AND (forum_subject_name = @Original_forum_subject_name); SELECT forum_subject_id, forum_subject_name FROM forum_subject WHERE (forum_subject_id = @forum_subject_id)&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlUpdateCommand1<span class="token punctuation">.</span>Connection <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sqlConnection1<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlUpdateCommand1<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlParameter</span><span class="token punctuation">(</span><span class="token string">&quot;@forum_subject_id&quot;</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlDbType<span class="token punctuation">.</span>VarChar<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">&quot;forum_subject_id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlUpdateCommand1<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlParameter</span><span class="token punctuation">(</span><span class="token string">&quot;@forum_subject_name&quot;</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlDbType<span class="token punctuation">.</span>VarChar<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">&quot;forum_subject_name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlUpdateCommand1<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlParameter</span><span class="token punctuation">(</span><span class="token string">&quot;@Original_forum_subject_id&quot;</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlDbType<span class="token punctuation">.</span>VarChar<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>ParameterDirection<span class="token punctuation">.</span>Input<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>Byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>Byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;forum_subject_id&quot;</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>DataRowVersion<span class="token punctuation">.</span>Original<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlUpdateCommand1<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlParameter</span><span class="token punctuation">(</span><span class="token string">&quot;@Original_forum_subject_name&quot;</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlDbType<span class="token punctuation">.</span>VarChar<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>ParameterDirection<span class="token punctuation">.</span>Input<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>Byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>Byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;forum_subject_name&quot;</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>DataRowVersion<span class="token punctuation">.</span>Original<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// sqlDeleteCommand1</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlDeleteCommand1<span class="token punctuation">.</span>CommandText <span class="token operator">=</span> <span class="token string">&quot;DELETE FROM forum_subject WHERE (forum_subject_id = @Original_forum_subject_id) A&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;ND (forum_subject_name = @Original_forum_subject_name)&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlDeleteCommand1<span class="token punctuation">.</span>Connection <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sqlConnection1<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlDeleteCommand1<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlParameter</span><span class="token punctuation">(</span><span class="token string">&quot;@Original_forum_subject_id&quot;</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlDbType<span class="token punctuation">.</span>VarChar<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>ParameterDirection<span class="token punctuation">.</span>Input<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>Byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>Byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;forum_subject_id&quot;</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>DataRowVersion<span class="token punctuation">.</span>Original<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlDeleteCommand1<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">.</span>SqlParameter</span><span class="token punctuation">(</span><span class="token string">&quot;@Original_forum_subject_name&quot;</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlDbType<span class="token punctuation">.</span>VarChar<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>ParameterDirection<span class="token punctuation">.</span>Input<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>Byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>Byte<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;forum_subject_name&quot;</span><span class="token punctuation">,</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>DataRowVersion<span class="token punctuation">.</span>Original<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// sqlConnection1</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlConnection1<span class="token punctuation">.</span>ConnectionString <span class="token operator">=</span> <span class="token string">&quot;data source=XXK;initial catalog=book_4;persist security info=False;user id=sa;wor&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;kstation id=XXK;packet size=4096&quot;</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// sqlDataAdapter1</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlDataAdapter1<span class="token punctuation">.</span>DeleteCommand <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sqlDeleteCommand1<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlDataAdapter1<span class="token punctuation">.</span>InsertCommand <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sqlInsertCommand1<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlDataAdapter1<span class="token punctuation">.</span>SelectCommand <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sqlSelectCommand1<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlDataAdapter1<span class="token punctuation">.</span>TableMappings<span class="token punctuation">.</span><span class="token function">AddRange</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>Common<span class="token punctuation">.</span>DataTableMapping<span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span>
                                    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>Common<span class="token punctuation">.</span>DataTableMapping</span><span class="token punctuation">(</span><span class="token string">&quot;Table&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;forum_subject&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>Common<span class="token punctuation">.</span>DataColumnMapping<span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span>
                                            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>Common<span class="token punctuation">.</span>DataColumnMapping</span><span class="token punctuation">(</span><span class="token string">&quot;forum_subject_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;forum_subject_id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>Common<span class="token punctuation">.</span>DataColumnMapping</span><span class="token punctuation">(</span><span class="token string">&quot;forum_subject_name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;forum_subject_name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sqlDataAdapter1<span class="token punctuation">.</span>UpdateCommand <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sqlUpdateCommand1<span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// dataSet11</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataSet11<span class="token punctuation">.</span>DataSetName <span class="token operator">=</span> <span class="token string">&quot;DataSet1&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataSet11<span class="token punctuation">.</span>Locale <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Globalization<span class="token punctuation">.</span>CultureInfo</span><span class="token punctuation">(</span><span class="token string">&quot;zh-CN&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataSet11<span class="token punctuation">.</span>Namespace <span class="token operator">=</span> <span class="token string">&quot;http://www.tempuri.org/DataSet1.xsd&quot;</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// dataGridTableStyle1</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTableStyle1<span class="token punctuation">.</span>DataGrid <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTableStyle1<span class="token punctuation">.</span>GridColumnStyles<span class="token punctuation">.</span><span class="token function">AddRange</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>DataGridColumnStyle<span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span>
                                                                                                                    <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTextBoxColumn1<span class="token punctuation">,</span>
                                                                                                                    <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTextBoxColumn2<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTableStyle1<span class="token punctuation">.</span>HeaderForeColor <span class="token operator">=</span> System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>SystemColors<span class="token punctuation">.</span>ControlText<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTableStyle1<span class="token punctuation">.</span>MappingName <span class="token operator">=</span> <span class="token string">&quot;forum_subject&quot;</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
</code></pre></div><p>回复人： mynewbigame(学习者) ( 一级(初级)) 信誉：100 2003-11-26 19:42:39 得分:0</p><blockquote><p>再继续：</p></blockquote><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code>            <span class="token comment">// dataGridTextBoxColumn1</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTextBoxColumn1<span class="token punctuation">.</span>Format <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTextBoxColumn1<span class="token punctuation">.</span>FormatInfo <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTextBoxColumn1<span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">&quot;帖子编号&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTextBoxColumn1<span class="token punctuation">.</span>MappingName <span class="token operator">=</span> <span class="token string">&quot;forum_subject_id&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTextBoxColumn1<span class="token punctuation">.</span>Width <span class="token operator">=</span> <span class="token number">88</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// dataGridTextBoxColumn2</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTextBoxColumn2<span class="token punctuation">.</span>Format <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTextBoxColumn2<span class="token punctuation">.</span>FormatInfo <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTextBoxColumn2<span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">&quot;帖子主题&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTextBoxColumn2<span class="token punctuation">.</span>MappingName <span class="token operator">=</span> <span class="token string">&quot;forum_subject_name&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>dataGridTextBoxColumn2<span class="token punctuation">.</span>Width <span class="token operator">=</span> <span class="token number">198</span><span class="token punctuation">;</span>
            <span class="token comment">// </span>
            <span class="token comment">// Form1</span>
            <span class="token comment">// </span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>AutoScaleBaseSize <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>ClientSize <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Drawing<span class="token punctuation">.</span>Size</span><span class="token punctuation">(</span><span class="token number">640</span><span class="token punctuation">,</span> <span class="token number">461</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">AddRange</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">.</span>Control<span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span>
                                                                            <span class="token keyword">this</span><span class="token punctuation">.</span>tabControl1<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">&quot;Form1&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;Form1&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabControl1<span class="token punctuation">.</span><span class="token function">ResumeLayout</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage1<span class="token punctuation">.</span><span class="token function">ResumeLayout</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span>ISupportInitialize<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataGrid1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">EndInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>tabPage2<span class="token punctuation">.</span><span class="token function">ResumeLayout</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>ComponentModel<span class="token punctuation">.</span>ISupportInitialize<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataSet11<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">EndInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ResumeLayout</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token preprocessor property">#<span class="token directive keyword">endregion</span></span>

        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token doc-comment comment">/// 应用程序的主入口点。</span>
        <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
        <span class="token punctuation">[</span>STAThread<span class="token punctuation">]</span>
        <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
        <span class="token punctuation">{</span>
            Application<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Form1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//public use function</span>
        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ErrorHandler</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> ErrorDescription<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            MessageBox<span class="token punctuation">.</span>Show <span class="token punctuation">(</span>ErrorDescription<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ConsoleWrite</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> strInput<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            lstconsole<span class="token punctuation">.</span>Items<span class="token punctuation">.</span>Add  <span class="token punctuation">(</span>strInput<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">getchanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{</span>
                <span class="token class-name"><span class="token keyword">int</span></span> ncount<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token class-name">DataSet</span> modifiedds<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataSet11<span class="token punctuation">.</span><span class="token function">GetChanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>modifiedds<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{</span>
                    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name">DataRow</span> r <span class="token keyword">in</span> modifiedds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token string">&quot;forum_subject&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">)</span>
                    <span class="token punctuation">{</span>
                        <span class="token keyword">if</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>RowState<span class="token operator">==</span>DataRowState<span class="token punctuation">.</span>Deleted<span class="token punctuation">)</span>
                        <span class="token punctuation">{</span>
                            <span class="token function">ConsoleWrite</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token string">&quot;forum_subject_id&quot;</span><span class="token punctuation">,</span>DataRowVersion<span class="token punctuation">.</span>Original<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;:&quot;</span><span class="token operator">+</span>r<span class="token punctuation">.</span>RowState<span class="token punctuation">.</span>ToString <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token operator">++</span>ncount<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>r<span class="token punctuation">.</span>RowState<span class="token operator">==</span>DataRowState<span class="token punctuation">.</span>Modified<span class="token punctuation">)</span>
                        <span class="token punctuation">{</span>
                            <span class="token function">ConsoleWrite</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token string">&quot;forum_subject_id&quot;</span><span class="token punctuation">,</span>DataRowVersion<span class="token punctuation">.</span>Original<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;:&quot;</span><span class="token operator">+</span>r<span class="token punctuation">.</span>RowState<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;:&quot;</span><span class="token operator">+</span>r<span class="token punctuation">[</span><span class="token string">&quot;forum_subject_id&quot;</span><span class="token punctuation">,</span>DataRowVersion<span class="token punctuation">.</span>Current<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot; &quot;</span><span class="token operator">+</span>r<span class="token punctuation">[</span><span class="token string">&quot;forum_subject_name&quot;</span><span class="token punctuation">,</span>DataRowVersion<span class="token punctuation">.</span>Current<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token operator">++</span>ncount<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>r<span class="token punctuation">.</span>RowState<span class="token operator">==</span>DataRowState<span class="token punctuation">.</span>Added<span class="token punctuation">)</span>
                        <span class="token punctuation">{</span>
                            <span class="token function">ConsoleWrite</span><span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token string">&quot;forum_subject_id&quot;</span><span class="token punctuation">,</span>DataRowVersion<span class="token punctuation">.</span>Current<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;:&quot;</span><span class="token operator">+</span>r<span class="token punctuation">.</span>RowState<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;:&quot;</span><span class="token operator">+</span>r<span class="token punctuation">[</span><span class="token string">&quot;forum_subject_name&quot;</span><span class="token punctuation">,</span>DataRowVersion<span class="token punctuation">.</span>Current<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token operator">++</span>ncount<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">return</span> ncount<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">System<span class="token punctuation">.</span>Exception</span> E<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token function">ErrorHandler</span><span class="token punctuation">(</span>E<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button4_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button1_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            lstconsole<span class="token punctuation">.</span>Items<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button2_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>sqlConnection1<span class="token punctuation">.</span>ConnectionString<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>textBox1<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
                <span class="token function">ConsoleWrite</span><span class="token punctuation">(</span><span class="token string">&quot;create a new connection:[&quot;</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>textBox1<span class="token punctuation">.</span>Text<span class="token operator">+</span><span class="token string">&quot;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>sqlDataAdapter1<span class="token punctuation">.</span><span class="token function">Fill</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataSet11<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">ConsoleWrite</span><span class="token punctuation">(</span><span class="token string">&quot;fill the dataset&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                btnstart<span class="token punctuation">.</span>Enabled<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">System<span class="token punctuation">.</span>Exception</span> E<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token function">ErrorHandler</span><span class="token punctuation">(</span>E<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnsave_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">System<span class="token punctuation">.</span>EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">//code No.1</span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataSet11<span class="token punctuation">.</span><span class="token function">HasChanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token comment">// this.sqlDataAdapter1.Update(this.dataSet11);</span>
                    <span class="token class-name">DataSet</span> changedata<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataSet11<span class="token punctuation">.</span><span class="token function">GetChanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>sqlDataAdapter1<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>changedata<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">ConsoleWrite</span><span class="token punctuation">(</span><span class="token string">&quot;SUM[&quot;</span><span class="token operator">+</span><span class="token function">getchanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;] rows have been changed!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">&quot;data modify success!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">ConsoleWrite</span><span class="token punctuation">(</span><span class="token string">&quot;data modify success!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{</span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">&quot;no data need to modify!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">ConsoleWrite</span><span class="token punctuation">(</span><span class="token string">&quot;no data need to modify!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">System<span class="token punctuation">.</span>Exception</span> E<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token function">ErrorHandler</span><span class="token punctuation">(</span>E<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>回复人： zhangjinshui200(望眼江湖) ( 一级(初级)) 信誉：100 2003-11-27 11:45:57 得分:0</p><blockquote><p>是不是我不能够理解，<br> 我想把DataGrid中得值，直接写回到数据库中，<br> 而上面例子，都是告诉如何通过数据集，来更新数据库的呢？</p></blockquote><p>该问题已经结贴 ，得分记录： polarlm (5)、 hare007 (5)、 keyplayer (10)、 smiletosky (5)、 heroniexiaowei (10)、 mynewbigame (15)、</p>`,37),c=[o];function e(u,l){return s(),a("div",null,c)}const i=n(p,[["render",e],["__file","dg23.html.vue"]]);export{i as default};
