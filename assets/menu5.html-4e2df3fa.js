import{_ as s,o as a,c as t,a as p}from"./app-f0851ed3.js";const o="/steven-blogs/assets/menu5_1-9a30ba5e.png",e="/steven-blogs/assets/menu5_2-3f8337bc.png",n="/steven-blogs/assets/menu5_3-10df94a7.png",c={},u=p('<h1 id="visual-c-的菜单编程" tabindex="-1"><a class="header-anchor" href="#visual-c-的菜单编程" aria-hidden="true">#</a> Visual C＃的菜单编程</h1><blockquote><p>（王天　2001年11月13日 10:55）</p></blockquote><p>菜单是软件界面设计的一个重要组成方面。它描述着一个软件的大致功能和风格。所以在程序设计中处理好、设计好菜单，对于一个软件开发是否成功有着比较重要的意义。</p><p>Visual C#是.Net框架中的一个重要组成部分，也是微软公司推出的下一代主流程序开发语言。它在设计、开发程序界面的时候和以前的某些程序开发语言有所不同。这一点也表现在其的菜单编程方面。本文就是来探讨一下如何用Visual C#进行菜单编程。</p><p>面向菜单编程中遇到的主要的问题大致可以分为二种：添加菜单项、删除菜单项。当然在处理以上二类问题时候，还会遇到诸如：如何添加菜单项所对应的事件，如何为菜单项添加快捷键等一些小的问题。下面就这些问题来具体进行论述。</p><h2 id="一-程序设计和运行环境" tabindex="-1"><a class="header-anchor" href="#一-程序设计和运行环境" aria-hidden="true">#</a> 一. 程序设计和运行环境</h2><p>（1）微软视窗2000服务器版本<br> （2）.Net FrameWork SDK Beta 2</p><h2 id="二-程序的主要功能" tabindex="-1"><a class="header-anchor" href="#二-程序的主要功能" aria-hidden="true">#</a> 二. 程序的主要功能</h2><p>在本程序中，已经定义了二个主菜单项。程序的主要功能是通过&quot;添加菜单&quot;按钮在第二个主菜单项下（即&quot;运行菜单项目&quot;下）加入一个子菜单。通过&quot;删除菜单&quot;按钮删除第二个主菜单项中的最后一个子菜单。下图01是&quot;添加菜单&quot;按钮按动三次后的界面，图02是在&quot;添加按钮&quot;按动三次后，在按动&quot;删除菜单&quot;按钮后的程序运行界面：</p><p><img src="'+o+'" alt="menu5_1"><br> 图01：&quot;添加菜单&quot;按钮按动三次后的界面</p><p><img src="'+e+`" alt="menu5_2"><br> 图02：在&quot;添加按钮&quot;按动三次后，在按动&quot;删除菜单&quot;按钮后的界面</p><h2 id="三-菜单设计中遇到的主要问题及解决办法" tabindex="-1"><a class="header-anchor" href="#三-菜单设计中遇到的主要问题及解决办法" aria-hidden="true">#</a> 三. 菜单设计中遇到的主要问题及解决办法</h2><h3 id="_1-如何动态加入一个菜单项目" tabindex="-1"><a class="header-anchor" href="#_1-如何动态加入一个菜单项目" aria-hidden="true">#</a> （1）如何动态加入一个菜单项目</h3><p>在.Net FrameWork SDK中有一个叫做System.Windows.Forms.dll文件，其中定义了一个名为System.Windows.Froms的名称空间，此名称空间中封装了很多和界面设计相关的类、对象。Visual C#在进行菜单编程的时候就需要用到在此名称空间中定义的二个对象：MainMenu、MenuItem。用过Delphi的程序员都知道在在Delphi中，也有MainMenu这个对象，MainMenu在程序设计中表现为菜单项的容器，而MenuItem就是要往这个容器中添加的内容。所以在一个窗体中这种容器往往只需要一个，即需要一个MainMenu，但却往往要多个MenuItem，即需要多个菜单项。通过以下二个例子来具体说明如何进行菜单加入操作：</p><p>例01：只是在窗体中加入一个主菜单项目：</p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">RuntimeMenus</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Form</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">MainMenu</span> myMenu<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">MenuItem</span> mnuFile<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">RuntimeMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//初始化 Main Menus</span>
        myMenu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MainMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mnuFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MenuItem</span><span class="token punctuation">(</span><span class="token string">&quot;文件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MenuItem</span><span class="token punctuation">(</span><span class="token string">&quot;文件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//往 Main Menu里面加入菜单</span>
        myMenu<span class="token punctuation">.</span>MenuItems<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>mnuFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Menu <span class="token operator">=</span> myMenu<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Application<span class="token punctuation">.</span>Run <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">RuntimeMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>成功程序编译后运行界面如下：</p><p><img src="`+n+`" alt="menu5_3"></p><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">RuntimeMenus</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Form</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">MainMenu</span> myMenu<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">MenuItem</span> mnuFile<span class="token punctuation">,</span> mnuExit<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">RuntimeMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//初始化 Main Menus</span>
        myMenu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MainMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mnuFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MenuItem</span><span class="token punctuation">(</span><span class="token string">&quot;文件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//设定子菜单的响应事件和快捷键</span>
        mnuExit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MenuItem</span><span class="token punctuation">(</span><span class="token string">&quot;退出&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EventHandler</span><span class="token punctuation">(</span>btnClose_Click<span class="token punctuation">)</span><span class="token punctuation">,</span> Shortcut<span class="token punctuation">.</span>CtrlX<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//往 Main Menu里面加入菜单</span>
        myMenu<span class="token punctuation">.</span>MenuItems<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>mnuFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mnuFile<span class="token punctuation">.</span>MenuItems<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>mnuExit<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Menu <span class="token operator">=</span> myMenu<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnClose_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Application<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Application<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">RuntimeMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>成功编译此例子后，运行就可以得到如下界面：</p><p><img src="`+n+`" alt="menu_4"><br> 图04：加入子菜单并设定快捷键和响应事件</p><p>通过以上二个小例子，我们就可以基本掌握如何正确添加主菜单和子菜单，并为之设定快捷键和响应事件。</p><h3 id="_2-如何动态删除菜单" tabindex="-1"><a class="header-anchor" href="#_2-如何动态删除菜单" aria-hidden="true">#</a> （2）如何动态删除菜单</h3><p>删除菜单比起添加一个菜单要来的相对容易了许多。在删除的时候，主要用到的是MenuItem对象的RemoveAt方法，此方法说带的参数是一个整型，是一个子菜单在主菜单中由上到下的相对位置，譬如以下语言：</p><p><code>mnuRtime.MenuItems.RemoveAt(2);</code></p><p>意思是在mnuRtime主菜单中删除由上到下的第三个子菜单。（由上至下第一个对应的指是&quot;0&quot;）。</p><h2 id="四-程序源代码-menu-cs" tabindex="-1"><a class="header-anchor" href="#四-程序源代码-menu-cs" aria-hidden="true">#</a> 四. 程序源代码（menu.cs）</h2><div class="language-csharp" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Drawing</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>ComponentModel</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">RuntimeMenus</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Form</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">MainMenu</span> myMenu<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">MenuItem</span> mnuFile<span class="token punctuation">,</span> mnuExit<span class="token punctuation">,</span> mnuRtime<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Button</span> btnAdd<span class="token punctuation">,</span> btnRemove<span class="token punctuation">,</span> btnClose<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token class-name"><span class="token keyword">int</span></span> i<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">RuntimeMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">InitializeComponents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">InitializeComponents</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//初始化 Main Menus</span>
        myMenu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MainMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mnuFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MenuItem</span><span class="token punctuation">(</span><span class="token string">&quot;文件&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mnuRtime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MenuItem</span><span class="token punctuation">(</span><span class="token string">&quot;运行菜单项目&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//往 Main Menu里面加入菜单</span>
        myMenu<span class="token punctuation">.</span>MenuItems<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>mnuFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
        myMenu<span class="token punctuation">.</span>MenuItems<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>mnuRtime<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//初始化 Exit 菜单项，设定了事件和快捷键</span>
        mnuExit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MenuItem</span><span class="token punctuation">(</span><span class="token string">&quot;退出&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EventHandler</span><span class="token punctuation">(</span>btnClose_Click<span class="token punctuation">)</span><span class="token punctuation">,</span> Shortcut<span class="token punctuation">.</span>CtrlX<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//把菜单项加入到文件File菜单中</span>
        mnuFile<span class="token punctuation">.</span>MenuItems<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>mnuExit<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//初始化添加按钮</span>
        btnAdd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnAdd<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span><span class="token number">275</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnAdd<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;添加菜单&quot;</span><span class="token punctuation">;</span>
        btnAdd<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EventHandler</span><span class="token punctuation">(</span>btnAdd_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnAdd<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//初始化删除按钮</span>
        btnRemove <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnRemove<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span><span class="token number">275</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnRemove<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;删除菜单&quot;</span><span class="token punctuation">;</span>
        btnRemove<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EventHandler</span><span class="token punctuation">(</span>btnRemove_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnRemove<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//初始化关闭按钮</span>
        btnClose <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnClose<span class="token punctuation">.</span>Location <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Point</span><span class="token punctuation">(</span><span class="token number">275</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnClose<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;退出&quot;</span><span class="token punctuation">;</span>
        btnClose<span class="token punctuation">.</span>Click <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EventHandler</span><span class="token punctuation">(</span>btnClose_Click<span class="token punctuation">)</span><span class="token punctuation">;</span>
        btnClose<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//在窗体中加入按钮</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>btnAdd<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>btnRemove<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Controls<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>btnClose<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//设置窗体的属性</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>MaximizeBox <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>MinimizeBox <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">&quot;动态处理菜单程序窗口！&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// 设定本窗体的MainMenu</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Menu <span class="token operator">=</span> myMenu<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Size</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>CancelButton <span class="token operator">=</span> btnClose<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>StartPosition <span class="token operator">=</span> FormStartPosition<span class="token punctuation">.</span>CenterScreen<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//以下是动态加入菜单项</span>
    <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnAdd_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        mnuRtime<span class="token punctuation">.</span>MenuItems<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;运行菜单 &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">EventHandler</span><span class="token punctuation">(</span>mnuRtime_Click<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//以下是动态删除菜单项</span>
    <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnRemove_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        mnuRtime<span class="token punctuation">.</span>MenuItems<span class="token punctuation">.</span><span class="token function">RemoveAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        i <span class="token operator">=</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">mnuRtime_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">String</span> s <span class="token operator">=</span> sender<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">&quot;你选择的是 &quot;</span> <span class="token operator">+</span> s<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;菜单选择窗口！&quot;</span><span class="token punctuation">,</span> MessageBoxButtons<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxIcon<span class="token punctuation">.</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//退出应用程序</span>
    <span class="token keyword">protected</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnClose_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Application<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Application<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">RuntimeMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>按照以下语句编译完menu.cs：</p><p><code>csc /t:winexe /r:system.dll /r:system.windows.forms.dll /r:system.drawing.dll menu.cs</code></p><p>就可以得到menu.exe ，执行此文件就可以得到图01和图02所示的运行界面了。</p><h2 id="五-总结" tabindex="-1"><a class="header-anchor" href="#五-总结" aria-hidden="true">#</a> 五. 总结</h2><p>本文主要是介绍了在用Visual C#进行有关菜单编程中，可能遇到有些问题。在解决这些问题的时候主要用到的是名称空间System.Windows.Forms中定义的二个对象MainMenu、MenuItem和这二个对象中定义的一些方法。当然这些方法还有一些其他的用法，有兴趣的读者可以参考有关书籍和浏览MSDN网站。</p>`,33),l=[u];function k(i,r){return a(),t("div",null,l)}const d=s(c,[["render",k],["__file","menu5.html.vue"]]);export{d as default};
